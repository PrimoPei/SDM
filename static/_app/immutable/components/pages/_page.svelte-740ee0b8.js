import{S as Tt,i as Ot,s as Nt,d as $,N as Qe,G as Fi,v as Rt,b as Qn,H as Ki,I as Wi,J as qi,k as Z,t as J,O as jr,P as Xe,Q as Ee,o as Yt,n as H,x as et,c as st,p as F,q as O,y as nt,l as E,f as at,r as d,w as T,g as rt,K as C,R as $t,F as mt,T as Se,U as it,V as ot,A as wt,B as bt,C as kt,D as Ct,h as zt,j as Ht,z as ye,L as yt,M as vt,W as $i,X as Lt,Y as tr,Z as Ec,_ as Sc,$ as ur,a0 as Yi,a1 as xc,a2 as go,e as ce,a3 as Ic,a4 as Pc}from"../../chunks/index-c4c4ad7b.js";import{w as Xt}from"../../chunks/singletons-e4b86b1e.js";import{p as Ac}from"../../chunks/stores-5cb01853.js";var Lc=Object.defineProperty,Tc=(e,t)=>{for(var n in t)Lc(e,n,{get:t[n],enumerable:!0})},bs="@liveblocks/core",qe="1.12.0",Oc="esm",Tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Nc="https://liveblocks.io/docs/errors/cross-linked",Rc="https://liveblocks.io/docs/errors/dupes",_o=" ";function yo(e){throw new Error(e)}function ks(e,t,n){const r=Symbol.for(e),i=n?`${t||"dev"} (${n})`:t||"dev";if(!Tn[r])Tn[r]=i;else if(Tn[r]!==i){const o=[`Multiple copies of Liveblocks are being loaded in your project. This will cause issues! See ${Rc+_o}`,"","Conflicts:",`- ${e} ${Tn[r]} (already loaded)`,`- ${e} ${i} (trying to load this now)`].join(`
`);yo(o)}t&&qe&&t!==qe&&yo([`Cross-linked versions of Liveblocks found, which will cause issues! See ${Nc+_o}`,"","Conflicts:",`- ${bs} is at ${qe}`,`- ${e} is at ${t}`,"","Always upgrade all Liveblocks packages to the same version number."].join(`
`))}function ae(e,t){throw new Error(t)}function Mc(e,t){if(!e){const n=new Error(t);throw n.name="Assertion failure",n}}function lt(e,t="Expected value to be non-nullable"){return Mc(e!=null,t),e}function Dc(){let e;const t=new Promise(n=>{e=n});if(!e)throw new Error("Should never happen");return[t,e]}function St(){const e=new Set,t=new Set;let n=null;function r(){n=[]}function i(){if(n!==null){for(const f of n)l(f);n=null}}function o(f){return t.add(f),()=>t.delete(f)}function s(f){return e.add(f),()=>e.delete(f)}async function a(f){let _;return new Promise(p=>{_=o(g=>{(f===void 0||f(g))&&p(g)})}).finally(()=>_==null?void 0:_())}function c(f){n!==null?n.push(f):l(f)}function l(f){e.forEach(_=>_(f)),e.clear(),t.forEach(_=>_(f))}function u(){e.clear(),t.clear()}function h(){return e.size+t.size}return{notify:c,subscribe:o,subscribeOnce:s,clear:u,count:h,waitUntil:a,pause:r,unpause:i,observable:{subscribe:o,subscribeOnce:s,waitUntil:a}}}var Uc={};Tc(Uc,{error:()=>Zi,errorWithTitle:()=>Xi,warn:()=>ne,warnWithTitle:()=>xs});var Cs="background:#0e0d12;border-radius:9999px;color:#fff;padding:3px 7px;font-family:sans-serif;font-weight:600;",jc="font-weight:600";function Es(e){return typeof window>"u"?console[e]:(t,...n)=>console[e]("%cLiveblocks",Cs,t,...n)}var ne=Es("warn"),Zi=Es("error");function Ss(e){return typeof window>"u"?console[e]:(t,n,...r)=>console[e](`%cLiveblocks%c ${t}`,Cs,jc,n,...r)}var xs=Ss("warn"),Xi=Ss("error");function Bc(e,t){if(e===t)return[0,0];const n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);let o=0;for(;o<i&&n[o]===r[o];o++);const s=n.length-o,a=r.length-o;return[s,a]}function Vc(e,t){const n=e.split(".");if(t<1||t>n.length+1)throw new Error("Invalid number of levels");const r=[];t>n.length&&r.push("*");for(let i=n.length-t+1;i<n.length;i++){const o=n.slice(0,i);o.length>0&&r.push(o.join(".")+".*")}return r.push(e),r}var zc=class{constructor(e){this.curr=e}get current(){return this.curr}allowPatching(e){const t=this;let n=!0;const r={...this.curr,patch(i){if(n){t.curr=Object.assign({},t.curr,i);for(const o of Object.entries(i)){const[s,a]=o;s!=="patch"&&(this[s]=a)}}else throw new Error("Can no longer patch stale context")}};e(r),n=!1}},Hc=1,Fc=class{get initialState(){const e=this.states.values()[Symbol.iterator]().next();if(e.done)throw new Error("No states defined yet");return e.value}get currentState(){if(this.currentStateOrNull===null)throw this.runningState===0?new Error("Not started yet"):new Error("Already stopped");return this.currentStateOrNull}start(){if(this.runningState!==0)throw new Error("State machine has already started");return this.runningState=1,this.currentStateOrNull=this.initialState,this.enter(null),this}stop(){if(this.runningState!==1)throw new Error("Cannot stop a state machine that hasn't started yet");this.exit(null),this.runningState=2,this.currentStateOrNull=null}constructor(e){this.id=Hc++,this.runningState=0,this.currentStateOrNull=null,this.states=new Set,this.enterFns=new Map,this.cleanupStack=[],this.knownEventTypes=new Set,this.allowedTransitions=new Map,this.currentContext=new zc(e),this.eventHub={didReceiveEvent:St(),willTransition:St(),didIgnoreEvent:St(),willExitState:St(),didEnterState:St()},this.events={didReceiveEvent:this.eventHub.didReceiveEvent.observable,willTransition:this.eventHub.willTransition.observable,didIgnoreEvent:this.eventHub.didIgnoreEvent.observable,willExitState:this.eventHub.willExitState.observable,didEnterState:this.eventHub.didEnterState.observable}}get context(){return this.currentContext.current}addState(e){if(this.runningState!==0)throw new Error("Already started");return this.states.add(e),this}onEnter(e,t){if(this.runningState!==0)throw new Error("Already started");if(this.enterFns.has(e))throw new Error(`enter/exit function for ${e} already exists`);return this.enterFns.set(e,t),this}onEnterAsync(e,t,n,r){return this.onEnter(e,()=>{const i=new AbortController,o=i.signal;let s=!1;return t(this.currentContext.current,o).then(a=>{o.aborted||(s=!0,this.transition({type:"ASYNC_OK",data:a},n))},a=>{o.aborted||(s=!0,this.transition({type:"ASYNC_ERROR",reason:a},r))}),()=>{s||i.abort()}})}getStatesMatching(e){const t=[];if(e==="*")for(const n of this.states)t.push(n);else if(e.endsWith(".*")){const n=e.slice(0,-1);for(const r of this.states)r.startsWith(n)&&t.push(r)}else{const n=e;this.states.has(n)&&t.push(n)}if(t.length===0)throw new Error(`No states match ${JSON.stringify(e)}`);return t}addTransitions(e,t){if(this.runningState!==0)throw new Error("Already started");for(const n of this.getStatesMatching(e)){let r=this.allowedTransitions.get(n);r===void 0&&(r=new Map,this.allowedTransitions.set(n,r));for(const[i,o]of Object.entries(t)){if(r.has(i))throw new Error(`Trying to set transition "${i}" on "${n}" (via "${e}"), but a transition already exists there.`);const s=o;if(this.knownEventTypes.add(i),s!==void 0){const a=typeof s=="function"?s:()=>s;r.set(i,a)}}}return this}addTimedTransition(e,t,n){return this.onEnter(e,()=>{const r=typeof t=="function"?t(this.currentContext.current):t,i=setTimeout(()=>{this.transition({type:"TIMER"},n)},r);return()=>{clearTimeout(i)}})}getTargetFn(e){var t;return(t=this.allowedTransitions.get(this.currentState))==null?void 0:t.get(e)}exit(e){this.eventHub.willExitState.notify(this.currentState),this.currentContext.allowPatching(t=>{var n;e=e!=null?e:this.cleanupStack.length;for(let r=0;r<e;r++)(n=this.cleanupStack.pop())==null||n(t)})}enter(e){const t=Vc(this.currentState,e!=null?e:this.currentState.split(".").length+1);this.currentContext.allowPatching(n=>{for(const r of t){const i=this.enterFns.get(r),o=i==null?void 0:i(n);typeof o=="function"?this.cleanupStack.push(o):this.cleanupStack.push(null)}}),this.eventHub.didEnterState.notify(this.currentState)}send(e){if(!this.knownEventTypes.has(e.type))throw new Error(`Invalid event ${JSON.stringify(e.type)}`);if(this.runningState===2)return;const t=this.getTargetFn(e.type);if(t!==void 0)return this.transition(e,t);this.eventHub.didIgnoreEvent.notify(e)}transition(e,t){this.eventHub.didReceiveEvent.notify(e);const n=this.currentState,i=(typeof t=="function"?t:()=>t)(e,this.currentContext.current);let o,s;if(i===null){this.eventHub.didIgnoreEvent.notify(e);return}if(typeof i=="string"?o=i:(o=i.target,s=Array.isArray(i.effect)?i.effect:[i.effect]),!this.states.has(o))throw new Error(`Invalid next state name: ${JSON.stringify(o)}`);this.eventHub.willTransition.notify({from:n,to:o});const[a,c]=Bc(this.currentState,o);if(a>0&&this.exit(a),this.currentStateOrNull=o,s!==void 0){const l=s;this.currentContext.allowPatching(u=>{for(const h of l)typeof h=="function"?h(u,e):u.patch(h)})}c>0&&this.enter(c)}};function Is(e){return e!==null&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"}function Ps(e){return Object.entries(e)}function Gi(e){try{return JSON.parse(e)}catch{return}}function hn(e){return JSON.parse(JSON.stringify(e))}function Kc(e){try{const t=e.replace(/-/g,"+").replace(/_/g,"/");return decodeURIComponent(atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))}catch{return atob(e)}}function Br(e){return e.filter(t=>t!=null)}function fr(e){const t={...e};return Object.keys(e).forEach(n=>{const r=n;t[r]===void 0&&delete t[r]}),t}async function vo(e,t,n){let r;const i=new Promise((o,s)=>{r=setTimeout(()=>{s(new Error(n))},t)});return Promise.race([e,i]).finally(()=>clearTimeout(r))}function wo(e){return e===4999||e>=4e3&&e<4100}function Wc(e){return e>=4100&&e<4200}function bo(e){return e===1013||e>=4200&&e<4300}function qc(e){return e==="initial"||e==="disconnected"}function As(e){switch(e){case"connecting":return"connecting";case"connected":return"open";case"reconnecting":return"unavailable";case"disconnected":return"failed";case"initial":return"closed";default:return"closed"}}function Ls(e){const t=e.currentState;switch(t){case"@ok.connected":case"@ok.awaiting-pong":return"connected";case"@idle.initial":return"initial";case"@auth.busy":case"@auth.backoff":case"@connecting.busy":case"@connecting.backoff":case"@idle.zombie":return e.context.successCount>0?"reconnecting":"connecting";case"@idle.failed":return"disconnected";default:return ae(t,"Unknown state")}}var Ts=[250,500,1e3,2e3,4e3,8e3,1e4],On=Ts[0]-1,$c=[2e3,3e4,6e4,3e5],Yc=3e4,Zc=2e3,Xc=1e4,Gc=1e4,Re=class extends Error{constructor(e){super(e)}},Jc=class extends Error{constructor(e,t){super(e),this.code=t}};function Os(e,t){var n;return(n=t.find(r=>r>e))!=null?n:t[t.length-1]}function ze(e){e.patch({backoffDelay:Os(e.backoffDelay,Ts)})}function ko(e){e.patch({backoffDelay:Os(e.backoffDelay,$c)})}function Co(e){e.patch({successCount:0})}function Ke(e,t){const n=e===2?Zi:e===1?ne:()=>{};return()=>{n(t)}}function Eo(e){const t="Connection to Liveblocks websocket server";return n=>{e instanceof Error?ne(`${t} could not be established. ${String(e)}`):ne(Ns(e)?`${t} closed prematurely (code: ${e.code}). Retrying in ${n.backoffDelay}ms.`:`${t} could not be established.`)}}function Er(e){const t=[`code: ${e.code}`];return e.reason&&t.push(`reason: ${e.reason}`),n=>{ne(`Connection to Liveblocks websocket server closed (${t.join(", ")}). Retrying in ${n.backoffDelay}ms.`)}}var Qc=Ke(1,"Connection to WebSocket closed permanently. Won't retry.");function Ns(e){return!(e instanceof Error)&&e.type==="close"}function tl(e){const t=new Date().getTime();function n(...i){ne(`${((new Date().getTime()-t)/1e3).toFixed(2)} [FSM #${e.id}]`,...i)}const r=[e.events.didReceiveEvent.subscribe(i=>n(`Event ${i.type}`)),e.events.willTransition.subscribe(({from:i,to:o})=>n("Transitioning",i,"\u2192",o)),e.events.didIgnoreEvent.subscribe(i=>n("Ignored event",i.type,i,"(current state won't handle it)"))];return()=>{for(const i of r)i()}}function el(e){const t=St(),n=St(),r=St();let i=null;const o=e.events.didEnterState.subscribe(()=>{const s=Ls(e);s!==i&&t.notify(s),i==="connected"&&s!=="connected"?r.notify():i!=="connected"&&s==="connected"&&n.notify(),i=s});return{statusDidChange:t.observable,didConnect:n.observable,didDisconnect:r.observable,unsubscribe:o}}var Nn=e=>t=>t.patch(e);function nl(e,t){const n=St();n.pause();const r=St();function i(w,m){return()=>{const b=new Jc(w,m);r.notify(b)}}const o={successCount:0,authValue:null,socket:null,backoffDelay:On},s=new Fc(o).addState("@idle.initial").addState("@idle.failed").addState("@idle.zombie").addState("@auth.busy").addState("@auth.backoff").addState("@connecting.busy").addState("@connecting.backoff").addState("@ok.connected").addState("@ok.awaiting-pong");s.addTransitions("*",{RECONNECT:{target:"@auth.backoff",effect:[ze,Co]},DISCONNECT:"@idle.initial"}),s.onEnter("@idle.*",Co).addTransitions("@idle.*",{CONNECT:(w,m)=>m.authValue!==null?"@connecting.busy":"@auth.busy"}),s.addTransitions("@auth.backoff",{NAVIGATOR_ONLINE:{target:"@auth.busy",effect:Nn({backoffDelay:On})}}).addTimedTransition("@auth.backoff",w=>w.backoffDelay,"@auth.busy").onEnterAsync("@auth.busy",()=>vo(e.authenticate(),Xc,"Timed out during auth"),w=>({target:"@connecting.busy",effect:Nn({authValue:w.data})}),w=>w.reason instanceof Re?{target:"@idle.failed",effect:[Ke(2,w.reason.message),i(w.reason.message,-1)]}:{target:"@auth.backoff",effect:[ze,Ke(2,`Authentication failed: ${w.reason instanceof Error?w.reason.message:String(w.reason)}`)]});const a=w=>s.send({type:"EXPLICIT_SOCKET_ERROR",event:w}),c=w=>s.send({type:"EXPLICIT_SOCKET_CLOSE",event:w}),l=w=>w.data==="pong"?s.send({type:"PONG"}):n.notify(w);function u(w){w&&(w.removeEventListener("error",a),w.removeEventListener("close",c),w.removeEventListener("message",l),w.close())}s.addTransitions("@connecting.backoff",{NAVIGATOR_ONLINE:{target:"@connecting.busy",effect:Nn({backoffDelay:On})}}).addTimedTransition("@connecting.backoff",w=>w.backoffDelay,"@connecting.busy").onEnterAsync("@connecting.busy",async(w,m)=>{let b=null,P=null;const N=new Promise((A,L)=>{if(w.authValue===null)throw new Error("No auth authValue");const j=e.createSocket(w.authValue);P=j;function U(v){b=v,j.removeEventListener("message",l),L(v)}const[W,R]=Dc();t.waitForActorId||R();function G(v){const I=Gi(v.data);(I==null?void 0:I.type)===104&&R()}j.addEventListener("message",l),t.waitForActorId&&j.addEventListener("message",G),j.addEventListener("error",U),j.addEventListener("close",U),j.addEventListener("open",()=>{j.addEventListener("error",a),j.addEventListener("close",c);const v=()=>{j.removeEventListener("error",U),j.removeEventListener("close",U),j.removeEventListener("message",G)};W.then(()=>{A([j,v])})})});return vo(N,Gc,"Timed out during websocket connection").then(([A,L])=>{if(L(),m.aborted)throw new Error("Aborted");if(b)throw b;return A}).catch(A=>{throw u(P),A})},w=>({target:"@ok.connected",effect:Nn({socket:w.data,backoffDelay:On})}),w=>{const m=w.reason;if(m instanceof Re)return{target:"@idle.failed",effect:[Ke(2,m.message),i(m.message,-1)]};if(Ns(m)){if(m.code===4109)return"@auth.busy";if(bo(m.code))return{target:"@connecting.backoff",effect:[ko,Eo(m)]};if(wo(m.code))return{target:"@idle.failed",effect:[Ke(2,m.reason),i(m.reason,m.code)]}}return{target:"@auth.backoff",effect:[ze,Eo(m)]}});const h={target:"@ok.awaiting-pong",effect:w=>{var m;(m=w.socket)==null||m.send("ping")}},f=()=>{const w=typeof document<"u"?document:void 0;return(w==null?void 0:w.visibilityState)==="hidden"&&e.canZombie()?"@idle.zombie":h};if(s.addTimedTransition("@ok.connected",Yc,f).addTransitions("@ok.connected",{NAVIGATOR_OFFLINE:f,WINDOW_GOT_FOCUS:h}),s.addTransitions("@idle.zombie",{WINDOW_GOT_FOCUS:"@connecting.backoff"}),s.onEnter("@ok.*",w=>{w.patch({successCount:w.successCount+1});const m=setTimeout(n.unpause,0);return b=>{u(b.socket),b.patch({socket:null}),clearTimeout(m),n.pause()}}).addTransitions("@ok.awaiting-pong",{PONG:"@ok.connected"}).addTimedTransition("@ok.awaiting-pong",Zc,{target:"@connecting.busy",effect:Ke(1,"Received no pong from server, assume implicit connection loss.")}).addTransitions("@ok.*",{EXPLICIT_SOCKET_ERROR:(w,m)=>{var b;return((b=m.socket)==null?void 0:b.readyState)===1?null:{target:"@connecting.backoff",effect:ze}},EXPLICIT_SOCKET_CLOSE:w=>wo(w.event.code)?{target:"@idle.failed",effect:[Qc,i(w.event.reason,w.event.code)]}:Wc(w.event.code)?w.event.code===4109?"@auth.busy":{target:"@auth.backoff",effect:[ze,Er(w.event)]}:bo(w.event.code)?{target:"@connecting.backoff",effect:[ko,Er(w.event)]}:{target:"@connecting.backoff",effect:[ze,Er(w.event)]}}),typeof document<"u"){const w=typeof document<"u"?document:void 0,m=typeof window<"u"?window:void 0,b=m!=null?m:w;s.onEnter("*",P=>{function N(){s.send({type:"NAVIGATOR_OFFLINE"})}function A(){s.send({type:"NAVIGATOR_ONLINE"})}function L(){(w==null?void 0:w.visibilityState)==="visible"&&s.send({type:"WINDOW_GOT_FOCUS"})}return m==null||m.addEventListener("online",A),m==null||m.addEventListener("offline",N),b==null||b.addEventListener("visibilitychange",L),()=>{b==null||b.removeEventListener("visibilitychange",L),m==null||m.removeEventListener("online",A),m==null||m.removeEventListener("offline",N),u(P.socket)}})}const _=[],{statusDidChange:p,didConnect:g,didDisconnect:y,unsubscribe:k}=el(s);return _.push(k),t.enableDebugLogging&&_.push(tl(s)),s.start(),{machine:s,cleanups:_,events:{statusDidChange:p,didConnect:g,didDisconnect:y,onMessage:n.observable,onLiveblocksError:r.observable}}}var rl=class{constructor(e,t=!1,n=!0){const{machine:r,events:i,cleanups:o}=nl(e,{waitForActorId:n,enableDebugLogging:t});this.machine=r,this.events=i,this.cleanups=o}getLegacyStatus(){return As(this.getStatus())}getStatus(){try{return Ls(this.machine)}catch{return"initial"}}get authValue(){return this.machine.context.authValue}connect(){this.machine.send({type:"CONNECT"})}reconnect(){this.machine.send({type:"RECONNECT"})}disconnect(){this.machine.send({type:"DISCONNECT"})}destroy(){this.machine.stop();let e;for(;e=this.cleanups.pop();)e()}send(e){var n;const t=(n=this.machine.context)==null?void 0:n.socket;t===null?ne("Cannot send: not connected yet",e):t.readyState!==1?ne("Cannot send: WebSocket no longer open",e):t.send(e)}_privateSendMachineEvent(e){this.machine.send(e)}};function Vr(e){return e.includes("room:write")}function Rs(e){return e.includes("comments:write")||e.includes("room:write")}function il(e){return Is(e)&&(e.k==="acc"||e.k==="id"||e.k==="sec-legacy")}function So(e){const t=e.split(".");if(t.length!==3)throw new Error("Authentication error: invalid JWT token");const n=Gi(Kc(t[1]));if(!(n&&il(n)))throw new Error("Authentication error: expected a valid token but did not get one. Hint: if you are using a callback, ensure the room is passed when creating the token. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientCallback");return{raw:e,parsed:n}}function ol(e){const t=sl(e),n=new Set,r=[],i=[],o=new Map;function s(){n.clear(),r.length=0,i.length=0,o.clear()}function a(h,f){return h==="comments:read"?f.includes("comments:read")||f.includes("comments:write")||f.includes("room:read")||f.includes("room:write"):h==="room:read"?f.includes("room:read")||f.includes("room:write"):!1}function c(h){const f=Math.ceil(Date.now()/1e3);for(let _=r.length-1;_>=0;_--){const p=r[_];if(i[_]<=f){r.splice(_,1),i.splice(_,1);continue}if(p.parsed.k==="id")return p;if(p.parsed.k==="acc"){if(!h.roomId&&Object.entries(p.parsed.perms).length===0)return p;for(const[y,k]of Object.entries(p.parsed.perms))if(h.roomId){if(y.includes("*")&&h.roomId.startsWith(y.replace("*",""))||h.roomId===y&&a(h.requestedScope,k))return p}else if(y.includes("*")&&a(h.requestedScope,k))return p}}}async function l(h){var _,p;const f=(p=(_=e.polyfills)==null?void 0:_.fetch)!=null?p:typeof window>"u"?void 0:window.fetch;if(t.type==="private"){if(f===void 0)throw new Re("To use Liveblocks client in a non-DOM environment with a url as auth endpoint, you need to provide a fetch polyfill.");const g=await al(f,t.url,{room:h.roomId}),y=So(g.token);if(n.has(y.raw))throw new Re("The same Liveblocks auth token was issued from the backend before. Caching Liveblocks tokens is not supported.");return y}if(t.type==="custom"){const g=await t.callback(h.roomId);if(g&&typeof g=="object"){if(typeof g.token=="string")return So(g.token);if(typeof g.error=="string"){const y=`Authentication failed: ${"reason"in g&&typeof g.reason=="string"?g.reason:"Forbidden"}`;throw g.error==="forbidden"?new Re(y):new Error(y)}}throw new Error('Your authentication callback function should return a token, but it did not. Hint: the return value should look like: { token: "..." }')}throw new Error("Unexpected authentication type. Must be private or custom.")}async function u(h){if(t.type==="public")return{type:"public",publicApiKey:t.publicApiKey};const f=c(h);if(f!==void 0)return{type:"secret",token:f};let _;h.roomId?(_=o.get(h.roomId),_===void 0&&(_=l(h),o.set(h.roomId,_))):(_=o.get("liveblocks-user-token"),_===void 0&&(_=l(h),o.set("liveblocks-user-token",_)));try{const p=await _,g=30,y=Math.floor(Date.now()/1e3)+(p.parsed.exp-p.parsed.iat)-g;return n.add(p.raw),p.parsed.k!=="sec-legacy"&&(r.push(p),i.push(y)),{type:"secret",token:p}}finally{h.roomId?o.delete(h.roomId):o.delete("liveblocks-user-token")}}return{reset:s,getAuthValue:u}}function sl(e){const{publicApiKey:t,authEndpoint:n}=e;if(n!==void 0&&t!==void 0)throw new Error("You cannot simultaneously use `publicApiKey` and `authEndpoint` options. Please pick one and leave the other option unspecified. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClient");if(typeof t=="string"){if(t.startsWith("sk_"))throw new Error("Invalid `publicApiKey` option. The value you passed is a secret key, which should not be used from the client. Please only ever pass a public key here. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientPublicKey");if(!t.startsWith("pk_"))throw new Error("Invalid key. Please use the public key format: pk_<public key>. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientPublicKey");return{type:"public",publicApiKey:t}}if(typeof n=="string")return{type:"private",url:n};if(typeof n=="function")return{type:"custom",callback:n};throw n!==void 0?new Error("The `authEndpoint` option must be a string or a function. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientAuthEndpoint"):new Error("Invalid Liveblocks client options. Please provide either a `publicApiKey` or `authEndpoint` option. They cannot both be empty. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClient")}async function al(e,t,n){const r=await e(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const s=`${(await r.text()).trim()||"reason not provided in auth response"} (${r.status} returned by POST ${t})`;throw r.status===401||r.status===403?new Re(`Unauthorized: ${s}`):new Error(`Failed to authenticate: ${s}`)}let i;try{i=await r.json()}catch(s){throw new Error(`Expected a JSON response when doing a POST request on "${t}". ${String(s)}`)}if(!Is(i)||typeof i.token!="string")throw new Error(`Expected a JSON response of the form \`{ token: "..." }\` when doing a POST request on "${t}", but got ${JSON.stringify(i)}`);const{token:o}=i;return{token:o}}var cl="https://api.liveblocks.io",xe=Symbol(),Ms=!1;function ll(e){Ms=e}function re(e,t){if(typeof window>"u")return;const n={...e,source:"liveblocks-devtools-client"};!((t==null?void 0:t.force)||Ms)||window.postMessage(n,"*")}var Ds=St();typeof window<"u"&&window.addEventListener("message",e=>{var t;e.source===window&&((t=e.data)==null?void 0:t.source)==="liveblocks-devtools-panel"&&Ds.notify(e.data)});var Us=Ds.observable,js=qe,xo=!1;function ul(e){typeof window>"u"||xo||(xo=!0,Us.subscribe(t=>{switch(t.msg){case"connect":{ll(!0);for(const n of e())re({msg:"room::available",roomId:n,clientVersion:js});break}}}),re({msg:"wake-up-devtools"},{force:!0}))}var zr=new Map;function Ji(e){var n;const t=(n=zr.get(e))!=null?n:[];zr.delete(e);for(const r of t)r()}function fl(e){Ji(e.id),wl(e),zr.set(e.id,[e.events.status.subscribe(()=>_l(e)),e.events.storageDidLoad.subscribeOnce(()=>Io(e)),e.events.storage.subscribe(()=>Io(e)),e.events.self.subscribe(()=>yl(e)),e.events.others.subscribe(()=>vl(e)),e.events.ydoc.subscribe(t=>dl(e,t)),e.events.customEvent.subscribe(t=>gl(e,t))])}function dl(e,t){re({msg:"room::sync::ydoc",roomId:e.id,update:t})}var hl=Date.now(),pl=0;function ml(){return`event-${hl}-${pl++}`}function gl(e,t){re({msg:"room::events::custom-event",roomId:e.id,event:{type:"CustomEvent",id:ml(),key:"Event",connectionId:t.connectionId,payload:t.event}})}function _l(e){re({msg:"room::sync::partial",roomId:e.id,status:e.getStatus()})}function Io(e){const t=e.getStorageSnapshot();t&&re({msg:"room::sync::partial",roomId:e.id,storage:t.toTreeNode("root").payload})}function yl(e){const t=e[xe].getSelf_forDevTools();t&&re({msg:"room::sync::partial",roomId:e.id,me:t})}function vl(e){const t=e[xe].getOthers_forDevTools();t&&re({msg:"room::sync::partial",roomId:e.id,others:t})}function wl(e){var i;const t=e.getStorageSnapshot(),n=e[xe].getSelf_forDevTools(),r=e[xe].getOthers_forDevTools();e.fetchYDoc(""),re({msg:"room::sync::full",roomId:e.id,status:e.getStatus(),storage:(i=t==null?void 0:t.toTreeNode("root").payload)!=null?i:null,me:n,others:r})}var Hr=new Map;function Bs(e){const t=Hr.get(e);Hr.delete(e),t&&t()}function bl(e,t){typeof window>"u"||(re({msg:"room::available",roomId:e,clientVersion:js}),Bs(e),Hr.set(e,Us.subscribe(n=>{switch(n.msg){case"room::subscribe":{n.roomId===e&&fl(t);break}case"room::unsubscribe":{n.roomId===e&&Ji(e);break}}})))}function kl(e){typeof window>"u"||(Ji(e),Bs(e),re({msg:"room::unavailable",roomId:e}))}function Fr(e,...t){if(typeof e!="object"||e===null||Array.isArray(e))return JSON.stringify(e,...t);const n=Object.keys(e).sort().reduce((r,i)=>(r[i]=e[i],r),{});return JSON.stringify(n,...t)}var Cl=50,El=100,Sr=()=>{},Sl=class{constructor(e){this.resolve=Sr,this.reject=Sr,this.promise=new Promise(Sr),this.args=e}},Qi=class{constructor(e,t){var n,r;this.queue=[],this.error=!1,this.callback=e,this.size=(n=t==null?void 0:t.size)!=null?n:Cl,this.delay=(r=t==null?void 0:t.delay)!=null?r:El}clearDelayTimeout(){this.delayTimeoutId!==void 0&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=void 0)}schedule(){this.queue.length===this.size?this.flush():this.queue.length===1&&(this.clearDelayTimeout(),this.delayTimeoutId=setTimeout(()=>void this.flush(),this.delay))}async flush(){if(this.queue.length===0)return;const e=this.queue.splice(0),t=e.map(n=>n.args);try{const n=await this.callback(t);this.error=!1,e.forEach((r,i)=>{const o=n==null?void 0:n[i];Array.isArray(n)?e.length!==n.length?r.reject(new Error(`Callback must return an array of the same length as the number of provided items. Expected ${e.length}, but got ${n.length}.`)):o instanceof Error?r.reject(o):r.resolve(o):r.reject(new Error("Callback must return an array."))})}catch(n){this.error=!0,e.forEach(r=>{r.reject(n)})}}get(...e){const t=this.queue.find(r=>Fr(r.args)===Fr(e));if(t)return t.promise;const n=new Sl(e);return n.promise=new Promise((r,i)=>{n.resolve=r,n.reject=i}),this.queue.push(n),this.schedule(),n.promise}clear(){this.queue=[],this.error=!1,this.clearDelayTimeout()}};function Po(e,t){const n=new Qi(e,t),r=new Map,i=St();function o(l){return Fr(l)}function s(l,u){u?r.set(l,u):r.delete(l),i.notify(u)}async function a(...l){const u=o(l);if(!r.has(u))try{s(u,{isLoading:!0});const h=await n.get(...l);s(u,{isLoading:!1,data:h})}catch(h){s(u,{isLoading:!1,error:h})}}function c(...l){const u=o(l);return r.get(u)}return{...i,get:a,getState:c}}function Vs(e){let t=e;const n=new Set;function r(){return t}function i(s){const a=s(t);if(t!==a){t=a;for(const c of n)c(t)}}function o(s){return n.add(s),s(t),()=>{n.delete(s)}}return{get:r,set:i,subscribe:o}}var Ao=new Set;function xl(e,t=e){Ao.has(t)||(Ao.add(t),Xi("Deprecation warning",e))}function Il(e,t,n=t){e&&xl(t,n)}function Kr(e){const t=e.editedAt?new Date(e.editedAt):void 0,n=new Date(e.createdAt),r=e.reactions.map(i=>({...i,createdAt:new Date(i.createdAt)}));if(e.body)return{...e,reactions:r,createdAt:n,editedAt:t};{const i=new Date(e.deletedAt);return{...e,reactions:r,createdAt:n,editedAt:t,deletedAt:i}}}function $n(e){const t=e.updatedAt?new Date(e.updatedAt):void 0,n=new Date(e.createdAt),r=e.comments.map(i=>Kr(i));return{...e,createdAt:n,updatedAt:t,comments:r}}function Pl(e){return{...e,createdAt:new Date(e.createdAt)}}function Wr(e){const t=new Date(e.notifiedAt),n=e.readAt?new Date(e.readAt):null;if("activities"in e){const r=e.activities.map(i=>({...i,createdAt:new Date(i.createdAt)}));return{...e,notifiedAt:t,readAt:n,activities:r}}return{...e,notifiedAt:t,readAt:n}}function zs(e){const t=new Date(e.deletedAt);return{...e,deletedAt:t}}function Hs(e){const t=new Date(e.deletedAt);return{...e,deletedAt:t}}function Al(e){const t=new URLSearchParams;for(const[n,r]of Object.entries(e))r!=null&&t.set(n,r.toString());return t}function Fs(e,t,n){const r=new URL(t,e);return n!==void 0&&(r.search=(n instanceof URLSearchParams?n:Al(n)).toString()),r.toString()}var Ll=50;function Tl({baseUrl:e,authManager:t,currentUserIdStore:n,fetcher:r}){async function i(h,f,_){const p=await t.getAuthValue({requestedScope:"comments:read"});if(p.type==="secret"&&p.token.parsed.k==="acc"){const w=p.token.parsed.uid;n.set(()=>w)}const g=Fs(e,`/v2/c${h}`,_),y=await r(g.toString(),{...f,headers:{...f==null?void 0:f.headers,Authorization:`Bearer ${Zr(p)}`}});if(!y.ok&&y.status>=400&&y.status<600){let w;try{const m=await y.json();w=new er(m.message,y.status,m)}catch{w=new er(y.statusText,y.status)}throw w}let k;try{k=await y.json()}catch{k={}}return k}async function o(h){var _;const f=await i("/inbox-notifications",void 0,{limit:h==null?void 0:h.limit,since:(_=h==null?void 0:h.since)==null?void 0:_.toISOString()});return{threads:f.threads.map(p=>$n(p)),inboxNotifications:f.inboxNotifications.map(p=>Wr(p)),deletedThreads:f.deletedThreads.map(p=>zs(p)),deletedInboxNotifications:f.deletedInboxNotifications.map(p=>Hs(p)),meta:{requestedAt:new Date(f.meta.requestedAt)}}}async function s(){const{count:h}=await i("/inbox-notifications/count");return h}async function a(){await i("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:"all"})})}async function c(h){await i("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:h})})}const l=new Qi(async h=>{const f=h.flat();return await c(f),f},{delay:Ll});async function u(h){await l.get(h)}return{getInboxNotifications:o,getUnreadInboxNotificationsCount:s,markAllInboxNotificationsAsRead:a,markInboxNotificationAsRead:u}}var ee=32,Ie=126,Ol=Ie-ee+1,to=eo(0),dr=eo(1),Nl=to+eo(-1);function eo(e){const t=ee+(e<0?Ol+e:e);if(t<ee||t>Ie)throw new Error(`Invalid n value: ${e}`);return String.fromCharCode(t)}function de(e,t){return e!==void 0&&t!==void 0?Dl(e,t):e!==void 0?Ml(e):t!==void 0?Rl(t):dr}function Rl(e){const t=e.length-1;for(let n=0;n<=t;n++){const r=e.charCodeAt(n);if(!(r<=ee))return n===t?r===ee+1?e.substring(0,n)+Nl:e.substring(0,n)+String.fromCharCode(r-1):e.substring(0,n+1)}return dr}function Ml(e){for(let t=0;t<=e.length-1;t++){const n=e.charCodeAt(t);if(!(n>=Ie))return e.substring(0,t)+String.fromCharCode(n+1)}return e+dr}function Dl(e,t){if(e<t)return qr(e,t);if(e>t)return qr(t,e);throw new Error("Cannot compute value between two equal positions")}function qr(e,t){let n=0;const r=e.length,i=t.length;for(;;){const o=n<r?e.charCodeAt(n):ee,s=n<i?t.charCodeAt(n):Ie;if(o===s){n++;continue}if(s-o===1){const a=n+1;let c=e.substring(0,a);c.length<a&&(c+=to.repeat(a-c.length));const l=e.substring(a);return c+qr(l,"")}else return Ul(e,n)+String.fromCharCode(s+o>>1)}}function Ul(e,t){return t<e.length?e.substring(0,t):e+to.repeat(t-e.length)}var jl=ee+1;function Bl(e){if(e==="")return!1;const t=e.length-1,n=e.charCodeAt(t);if(n<jl||n>Ie)return!1;for(let r=0;r<t;r++){const i=e.charCodeAt(r);if(i<ee||i>Ie)return!1}return!0}function Vl(e){const t=[];for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t.push(r<ee?ee:r>Ie?Ie:r)}for(;t.length>0&&t[t.length-1]===ee;)t.length--;return t.length>0?String.fromCharCode(...t):dr}function pn(e){return Bl(e)?e:Vl(e)}function zl(e){return e.type===5&&e.id==="ACK"}function Lo(e,t,n=pn(t)){return Object.freeze({type:"HasParent",node:e,key:t,pos:n})}var To=Object.freeze({type:"NoParent"});function Hl(e,t=pn(e)){return Object.freeze({type:"Orphaned",oldKey:e,oldPos:t})}var hr=class{constructor(){this._parent=To}_getParentKeyOrThrow(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":throw new Error("Parent key is missing");case"Orphaned":return this.parent.oldKey;default:return ae(this.parent,"Unknown state")}}get _parentPos(){switch(this.parent.type){case"HasParent":return this.parent.pos;case"NoParent":throw new Error("Parent key is missing");case"Orphaned":return this.parent.oldPos;default:return ae(this.parent,"Unknown state")}}get _pool(){return this.__pool}get roomId(){return this.__pool?this.__pool.roomId:null}get _id(){return this.__id}get parent(){return this._parent}get _parentKey(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":return null;case"Orphaned":return this.parent.oldKey;default:return ae(this.parent,"Unknown state")}}_apply(e,t){switch(e.type){case 5:return this.parent.type==="HasParent"?this.parent.node._detachChild(this):{modified:!1}}return{modified:!1}}_setParentLink(e,t){switch(this.parent.type){case"HasParent":if(this.parent.node!==e)throw new Error("Cannot set parent: node already has a parent");this._parent=Lo(e,t);return;case"Orphaned":case"NoParent":{this._parent=Lo(e,t);return}default:return ae(this.parent,"Unknown state")}}_attach(e,t){if(this.__id||this.__pool)throw new Error("Cannot attach node: already attached");t.addNode(e,this),this.__id=e,this.__pool=t}_detach(){switch(this.__pool&&this.__id&&this.__pool.deleteNode(this.__id),this.parent.type){case"HasParent":{this._parent=Hl(this.parent.key,this.parent.pos);break}case"NoParent":{this._parent=To;break}case"Orphaned":break;default:ae(this.parent,"Unknown state")}this.__pool=void 0}invalidate(){(this._cachedImmutable!==void 0||this._cachedTreeNode!==void 0)&&(this._cachedImmutable=void 0,this._cachedTreeNode=void 0,this.parent.type==="HasParent"&&this.parent.node.invalidate())}toTreeNode(e){return(this._cachedTreeNode===void 0||this._cachedTreeNodeKey!==e)&&(this._cachedTreeNodeKey=e,this._cachedTreeNode=this._toTreeNode(e)),this._cachedTreeNode}toImmutable(){return this._cachedImmutable===void 0&&(this._cachedImmutable=this._toImmutable()),this._cachedImmutable}};function Fl(e){return e.type===0&&!Kl(e)}function Kl(e){return e.parentId!==void 0&&e.parentKey!==void 0}function pr(e=7){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789,./;[]~!@#$%&*()_+=-",n=t.length;return Array.from({length:e},()=>t.charAt(Math.floor(Math.random()*n))).join("")}var Be=class Ks extends hr{constructor(t){super(),this._data=t}get data(){return this._data}static _deserialize([t,n],r,i){const o=new Ks(n.data);return o._attach(t,i),o}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize register if parentId or parentKey is undefined");return[{type:8,opId:r==null?void 0:r.generateOpId(),id:this._id,parentId:t,parentKey:n,data:this.data}]}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveRegister if parent is missing");return{type:3,parentId:lt(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key,data:this.data}}_attachChild(t){throw new Error("Method not implemented.")}_detachChild(t){throw new Error("Method not implemented.")}_apply(t,n){return super._apply(t,n)}_toTreeNode(t){var n;return{type:"Json",id:(n=this._id)!=null?n:pr(),key:t,payload:this._data}}_toImmutable(){return this._data}clone(){return hn(this.data)}};function Wl(e,t){const n=e._parentPos,r=t._parentPos;return n===r?0:n<r?-1:1}var tn=class $r extends hr{constructor(t=[]){super(),this._items=[],this._implicitlyDeletedItems=new WeakSet,this._unacknowledgedSets=new Map;let n;for(const r of t){const i=de(n),o=$e(r);o._setParentLink(this,i),this._items.push(o),n=i}}static _deserialize([t],n,r){const i=new $r;i._attach(t,r);const o=n.get(t);if(o===void 0)return i;for(const[s,a]of o){const c=$s([s,a],n,r);c._setParentLink(i,a.parentKey),i._insertAndSort(c)}return i}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const i=[],o={id:this._id,opId:r==null?void 0:r.generateOpId(),type:2,parentId:t,parentKey:n};i.push(o);for(const s of this._items){const a=s._getParentKeyOrThrow(),c=Mn(s._toOps(this._id,a,r),void 0),l=c[0].opId;l!==void 0&&this._unacknowledgedSets.set(a,l),i.push(...c)}return i}_insertAndSort(t){this._items.push(t),this._sortItems()}_sortItems(){this._items.sort(Wl),this.invalidate()}_indexOfPosition(t){return this._items.findIndex(n=>n._getParentKeyOrThrow()===t)}_attach(t,n){super._attach(t,n);for(const r of this._items)r._attach(n.generateId(),n)}_detach(){super._detach();for(const t of this._items)t._detach()}_applySetRemote(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:n,parentKey:r}=t,i=cn(t);i._attach(n,this._pool),i._setParentLink(this,r);const o=t.deletedId,s=this._indexOfPosition(r);if(s!==-1){const a=this._items[s];if(a._id===o)return a._detach(),this._items[s]=i,{modified:It(this,[He(s,i)]),reverse:[]};{this._implicitlyDeletedItems.add(a),this._items[s]=i;const c=[He(s,i)],l=this._detachItemAssociatedToSetOperation(t.deletedId);return l&&c.push(l),{modified:It(this,c),reverse:[]}}}else{const a=[],c=this._detachItemAssociatedToSetOperation(t.deletedId);return c&&a.push(c),this._insertAndSort(i),a.push(se(this._indexOfPosition(r),i)),{reverse:[],modified:It(this,a)}}}_applySetAck(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const n=[],r=this._detachItemAssociatedToSetOperation(t.deletedId);r&&n.push(r);const i=this._unacknowledgedSets.get(t.parentKey);if(i!==void 0){if(i!==t.opId)return n.length===0?{modified:!1}:{modified:It(this,n),reverse:[]};this._unacknowledgedSets.delete(t.parentKey)}const o=this._indexOfPosition(t.parentKey),s=this._items.find(a=>a._id===t.id);if(s!==void 0){if(s._parentKey===t.parentKey)return{modified:n.length>0?It(this,n):!1,reverse:[]};o!==-1&&(this._implicitlyDeletedItems.add(this._items[o]),this._items.splice(o,1),n.push(Rn(o)));const a=this._items.indexOf(s);s._setParentLink(this,t.parentKey),this._sortItems();const c=this._items.indexOf(s);return c!==a&&n.push(Le(a,c,s)),{modified:n.length>0?It(this,n):!1,reverse:[]}}else{const a=this._pool.getNode(t.id);if(a&&this._implicitlyDeletedItems.has(a)){a._setParentLink(this,t.parentKey),this._implicitlyDeletedItems.delete(a),this._insertAndSort(a);const c=this._items.indexOf(a);return{modified:It(this,[o===-1?se(c,a):He(c,a),...n]),reverse:[]}}else{o!==-1&&this._items.splice(o,1);const{newItem:c,newIndex:l}=this._createAttachItemAndSort(t,t.parentKey);return{modified:It(this,[o===-1?se(l,c):He(l,c),...n]),reverse:[]}}}}_detachItemAssociatedToSetOperation(t){if(t===void 0||this._pool===void 0)return null;const n=this._pool.getNode(t);if(n===void 0)return null;const r=this._detachChild(n);return r.modified===!1?null:r.modified.updates[0]}_applyRemoteInsert(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const n=pn(t.parentKey),r=this._indexOfPosition(n);r!==-1&&this._shiftItemPosition(r,n);const{newItem:i,newIndex:o}=this._createAttachItemAndSort(t,n);return{modified:It(this,[se(o,i)]),reverse:[]}}_applyInsertAck(t){const n=this._items.find(o=>o._id===t.id),r=pn(t.parentKey),i=this._indexOfPosition(r);if(n){if(n._parentKey===r)return{modified:!1};{const o=this._items.indexOf(n);i!==-1&&this._shiftItemPosition(i,r),n._setParentLink(this,r),this._sortItems();const s=this._indexOfPosition(r);return s===o?{modified:!1}:{modified:It(this,[Le(o,s,n)]),reverse:[]}}}else{const o=lt(this._pool).getNode(t.id);if(o&&this._implicitlyDeletedItems.has(o)){o._setParentLink(this,r),this._implicitlyDeletedItems.delete(o),this._insertAndSort(o);const s=this._indexOfPosition(r);return{modified:It(this,[se(s,o)]),reverse:[]}}else{i!==-1&&this._shiftItemPosition(i,r);const{newItem:s,newIndex:a}=this._createAttachItemAndSort(t,r);return{modified:It(this,[se(a,s)]),reverse:[]}}}}_applyInsertUndoRedo(t){var c,l,u;const{id:n,parentKey:r}=t,i=cn(t);if(((c=this._pool)==null?void 0:c.getNode(n))!==void 0)return{modified:!1};i._attach(n,lt(this._pool)),i._setParentLink(this,r);const o=this._indexOfPosition(r);let s=r;if(o!==-1){const h=(l=this._items[o])==null?void 0:l._parentPos,f=(u=this._items[o+1])==null?void 0:u._parentPos;s=de(h,f),i._setParentLink(this,s)}this._insertAndSort(i);const a=this._indexOfPosition(s);return{modified:It(this,[se(a,i)]),reverse:[{type:5,id:n}]}}_applySetUndoRedo(t){var a;const{id:n,parentKey:r}=t,i=cn(t);if(((a=this._pool)==null?void 0:a.getNode(n))!==void 0)return{modified:!1};this._unacknowledgedSets.set(r,lt(t.opId));const o=this._indexOfPosition(r);i._attach(n,lt(this._pool)),i._setParentLink(this,r);const s=r;if(o!==-1){const c=this._items[o];c._detach(),this._items[o]=i;const l=Mn(c._toOps(lt(this._id),r,this._pool),t.id),u=[He(o,i)],h=this._detachItemAssociatedToSetOperation(t.deletedId);return h&&u.push(h),{modified:It(this,u),reverse:l}}else{this._insertAndSort(i),this._detachItemAssociatedToSetOperation(t.deletedId);const c=this._indexOfPosition(s);return{reverse:[{type:5,id:n}],modified:It(this,[se(c,i)])}}}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");let r;return t.intent==="set"?n===1?r=this._applySetRemote(t):n===2?r=this._applySetAck(t):r=this._applySetUndoRedo(t):n===1?r=this._applyRemoteInsert(t):n===2?r=this._applyInsertAck(t):r=this._applyInsertUndoRedo(t),r.modified!==!1&&this.invalidate(),r}_detachChild(t){if(t){const n=lt(t._parentKey),r=t._toOps(lt(this._id),n,this._pool),i=this._items.indexOf(t);return i===-1?{modified:!1}:(this._items.splice(i,1),this.invalidate(),t._detach(),{modified:It(this,[Rn(i)]),reverse:r})}return{modified:!1}}_applySetChildKeyRemote(t,n){var o;if(this._implicitlyDeletedItems.has(n)){this._implicitlyDeletedItems.delete(n),n._setParentLink(this,t),this._insertAndSort(n);const s=this._items.indexOf(n);return{modified:It(this,[se(s,n)]),reverse:[]}}const r=n._parentKey;if(t===r)return{modified:!1};const i=this._indexOfPosition(t);if(i===-1){const s=this._items.indexOf(n);n._setParentLink(this,t),this._sortItems();const a=this._items.indexOf(n);return a===s?{modified:!1}:{modified:It(this,[Le(s,a,n)]),reverse:[]}}else{this._items[i]._setParentLink(this,de(t,(o=this._items[i+1])==null?void 0:o._parentPos));const s=this._items.indexOf(n);n._setParentLink(this,t),this._sortItems();const a=this._items.indexOf(n);return a===s?{modified:!1}:{modified:It(this,[Le(s,a,n)]),reverse:[]}}}_applySetChildKeyAck(t,n){var i,o;const r=lt(n._parentKey);if(this._implicitlyDeletedItems.has(n)){const s=this._indexOfPosition(t);return this._implicitlyDeletedItems.delete(n),s!==-1&&this._items[s]._setParentLink(this,de(t,(i=this._items[s+1])==null?void 0:i._parentPos)),n._setParentLink(this,t),this._insertAndSort(n),{modified:!1}}else{if(t===r)return{modified:!1};const s=this._items.indexOf(n),a=this._indexOfPosition(t);a!==-1&&this._items[a]._setParentLink(this,de(t,(o=this._items[a+1])==null?void 0:o._parentPos)),n._setParentLink(this,t),this._sortItems();const c=this._items.indexOf(n);return s===c?{modified:!1}:{modified:It(this,[Le(s,c,n)]),reverse:[]}}}_applySetChildKeyUndoRedo(t,n){var a;const r=lt(n._parentKey),i=this._items.indexOf(n),o=this._indexOfPosition(t);o!==-1&&this._items[o]._setParentLink(this,de(t,(a=this._items[o+1])==null?void 0:a._parentPos)),n._setParentLink(this,t),this._sortItems();const s=this._items.indexOf(n);return i===s?{modified:!1}:{modified:It(this,[Le(i,s,n)]),reverse:[{type:1,id:lt(n._id),parentKey:r}]}}_setChildKey(t,n,r){return r===1?this._applySetChildKeyRemote(t,n):r===2?this._applySetChildKeyAck(t,n):this._applySetChildKeyUndoRedo(t,n)}_apply(t,n){return super._apply(t,n)}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveList if parent is missing");return{type:1,parentId:lt(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get length(){return this._items.length}push(t){var n;return(n=this._pool)==null||n.assertStorageIsWritable(),this.insert(t,this.length)}insert(t,n){var a;if((a=this._pool)==null||a.assertStorageIsWritable(),n<0||n>this._items.length)throw new Error(`Cannot insert list item at index "${n}". index should be between 0 and ${this._items.length}`);const r=this._items[n-1]?this._items[n-1]._parentPos:void 0,i=this._items[n]?this._items[n]._parentPos:void 0,o=de(r,i),s=$e(t);if(s._setParentLink(this,o),this._insertAndSort(s),this._pool&&this._id){const c=this._pool.generateId();s._attach(c,this._pool),this._pool.dispatch(s._toOps(this._id,o,this._pool),[{type:5,id:c}],new Map([[this._id,It(this,[se(n,s)])]]))}}move(t,n){var c;if((c=this._pool)==null||c.assertStorageIsWritable(),n<0)throw new Error("targetIndex cannot be less than 0");if(n>=this._items.length)throw new Error("targetIndex cannot be greater or equal than the list length");if(t<0)throw new Error("index cannot be less than 0");if(t>=this._items.length)throw new Error("index cannot be greater or equal than the list length");let r=null,i=null;t<n?(i=n===this._items.length-1?void 0:this._items[n+1]._parentPos,r=this._items[n]._parentPos):(i=this._items[n]._parentPos,r=n===0?void 0:this._items[n-1]._parentPos);const o=de(r,i),s=this._items[t],a=s._getParentKeyOrThrow();if(s._setParentLink(this,o),this._sortItems(),this._pool&&this._id){const l=new Map([[this._id,It(this,[Le(t,n,s)])]]);this._pool.dispatch([{type:1,id:lt(s._id),opId:this._pool.generateOpId(),parentKey:o}],[{type:1,id:lt(s._id),parentKey:a}],l)}}delete(t){var r;if((r=this._pool)==null||r.assertStorageIsWritable(),t<0||t>=this._items.length)throw new Error(`Cannot delete list item at index "${t}". index should be between 0 and ${this._items.length-1}`);const n=this._items[t];if(n._detach(),this._items.splice(t,1),this.invalidate(),this._pool){const i=n._id;if(i){const o=new Map;o.set(lt(this._id),It(this,[Rn(t)])),this._pool.dispatch([{id:i,opId:this._pool.generateOpId(),type:5}],n._toOps(lt(this._id),n._getParentKeyOrThrow()),o)}}}clear(){var t;if((t=this._pool)==null||t.assertStorageIsWritable(),this._pool){const n=[],r=[],i=[];for(const s of this._items){s._detach();const a=s._id;a&&(n.push({type:5,id:a,opId:this._pool.generateOpId()}),r.push(...s._toOps(lt(this._id),s._getParentKeyOrThrow())),i.push(Rn(0)))}this._items=[],this.invalidate();const o=new Map;o.set(lt(this._id),It(this,i)),this._pool.dispatch(n,r,o)}else{for(const n of this._items)n._detach();this._items=[],this.invalidate()}}set(t,n){var a;if((a=this._pool)==null||a.assertStorageIsWritable(),t<0||t>=this._items.length)throw new Error(`Cannot set list item at index "${t}". index should be between 0 and ${this._items.length-1}`);const r=this._items[t],i=r._getParentKeyOrThrow(),o=r._id;r._detach();const s=$e(n);if(s._setParentLink(this,i),this._items[t]=s,this.invalidate(),this._pool&&this._id){const c=this._pool.generateId();s._attach(c,this._pool);const l=new Map;l.set(this._id,It(this,[He(t,s)]));const u=Mn(s._toOps(this._id,i,this._pool),o);this._unacknowledgedSets.set(i,lt(u[0].opId));const h=Mn(r._toOps(this._id,i,void 0),c);this._pool.dispatch(u,h,l)}}toArray(){return this._items.map(t=>Me(t))}every(t){return this.toArray().every(t)}filter(t){return this.toArray().filter(t)}find(t){return this.toArray().find(t)}findIndex(t){return this.toArray().findIndex(t)}forEach(t){return this.toArray().forEach(t)}get(t){if(!(t<0||t>=this._items.length))return Me(this._items[t])}indexOf(t,n){return this.toArray().indexOf(t,n)}lastIndexOf(t,n){return this.toArray().lastIndexOf(t,n)}map(t){return this._items.map((n,r)=>t(Me(n),r))}some(t){return this.toArray().some(t)}[Symbol.iterator](){return new ql(this._items)}_createAttachItemAndSort(t,n){const r=cn(t);r._attach(t.id,lt(this._pool)),r._setParentLink(this,n),this._insertAndSort(r);const i=this._indexOfPosition(n);return{newItem:r,newIndex:i}}_shiftItemPosition(t,n){var i;const r=de(n,this._items.length>t+1?(i=this._items[t+1])==null?void 0:i._parentPos:void 0);this._items[t]._setParentLink(this,r)}_toTreeNode(t){var n;return{type:"LiveList",id:(n=this._id)!=null?n:pr(),key:t,payload:this._items.map((r,i)=>r.toTreeNode(i.toString()))}}toImmutable(){return super.toImmutable()}_toImmutable(){const t=this._items.map(n=>n.toImmutable());return Object.freeze(t)}clone(){return new $r(this._items.map(t=>t.clone()))}},ql=class{constructor(e){this._innerIterator=e[Symbol.iterator]()}[Symbol.iterator](){return this}next(){const e=this._innerIterator.next();return e.done?{done:!0,value:void 0}:{value:Me(e.value)}}};function It(e,t){return{node:e,type:"LiveList",updates:t}}function He(e,t){return{index:e,type:"set",item:t instanceof Be?t.data:t}}function Rn(e){return{index:e,type:"delete"}}function se(e,t){return{index:e,type:"insert",item:t instanceof Be?t.data:t}}function Le(e,t,n){return{index:t,type:"move",previousIndex:e,item:n instanceof Be?n.data:n}}function Mn(e,t){return e.map((n,r)=>r===0?{...n,intent:"set",deletedId:t}:n)}var _e=Object.freeze,en=class Yr extends hr{constructor(t){if(super(),this.unacknowledgedSet=new Map,t){const n=[];for(const[r,i]of t){const o=$e(i);o._setParentLink(this,r),n.push([r,o])}this._map=new Map(n)}else this._map=new Map}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const i=[],o={id:this._id,opId:r==null?void 0:r.generateOpId(),type:7,parentId:t,parentKey:n};i.push(o);for(const[s,a]of this._map)i.push(...a._toOps(this._id,s,r));return i}static _deserialize([t,n],r,i){const o=new Yr;o._attach(t,i);const s=r.get(t);if(s===void 0)return o;for(const[a,c]of s){const l=$s([a,c],r,i);l._setParentLink(o,c.parentKey),o._map.set(c.parentKey,l),o.invalidate()}return o}_attach(t,n){super._attach(t,n);for(const[r,i]of this._map)jt(i)&&i._attach(n.generateId(),n)}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:r,parentKey:i,opId:o}=t,s=i,a=cn(t);if(this._pool.getNode(r)!==void 0)return{modified:!1};if(n===2){const u=this.unacknowledgedSet.get(s);if(u===o)return this.unacknowledgedSet.delete(s),{modified:!1};if(u!==void 0)return{modified:!1}}else n===1&&this.unacknowledgedSet.delete(s);const c=this._map.get(s);let l;if(c){const u=lt(this._id);l=c._toOps(u,s),c._detach()}else l=[{type:5,id:r}];return a._setParentLink(this,s),a._attach(r,this._pool),this._map.set(s,a),this.invalidate(),{modified:{node:this,type:"LiveMap",updates:{[s]:{type:"update"}}},reverse:l}}_detach(){super._detach();for(const t of this._map.values())t._detach()}_detachChild(t){const n=lt(this._id),r=lt(t._parentKey),i=t._toOps(n,r,this._pool);for(const[s,a]of this._map)a===t&&(this._map.delete(s),this.invalidate());return t._detach(),{modified:{node:this,type:"LiveMap",updates:{[r]:{type:"delete"}}},reverse:i}}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveMap if parent is missing");return{type:2,parentId:lt(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get(t){const n=this._map.get(t);if(n!==void 0)return Me(n)}set(t,n){var o;(o=this._pool)==null||o.assertStorageIsWritable();const r=this._map.get(t);r&&r._detach();const i=$e(n);if(i._setParentLink(this,t),this._map.set(t,i),this.invalidate(),this._pool&&this._id){const s=this._pool.generateId();i._attach(s,this._pool);const a=new Map;a.set(this._id,{node:this,type:"LiveMap",updates:{[t]:{type:"update"}}});const c=i._toOps(this._id,t,this._pool);this.unacknowledgedSet.set(t,lt(c[0].opId)),this._pool.dispatch(i._toOps(this._id,t,this._pool),r?r._toOps(this._id,t):[{type:5,id:s}],a)}}get size(){return this._map.size}has(t){return this._map.has(t)}delete(t){var r;(r=this._pool)==null||r.assertStorageIsWritable();const n=this._map.get(t);if(n===void 0)return!1;if(n._detach(),this._map.delete(t),this.invalidate(),this._pool&&n._id){const i=lt(this._id),o=new Map;o.set(i,{node:this,type:"LiveMap",updates:{[t]:{type:"delete"}}}),this._pool.dispatch([{type:5,id:n._id,opId:this._pool.generateOpId()}],n._toOps(i,t),o)}return!0}entries(){const t=this._map.entries();return{[Symbol.iterator](){return this},next(){const n=t.next();if(n.done)return{done:!0,value:void 0};const i=n.value[0],o=Me(n.value[1]);return{value:[i,o]}}}}[Symbol.iterator](){return this.entries()}keys(){return this._map.keys()}values(){const t=this._map.values();return{[Symbol.iterator](){return this},next(){const n=t.next();return n.done?{done:!0,value:void 0}:{value:Me(n.value)}}}}forEach(t){for(const n of this)t(n[1],n[0],this)}_toTreeNode(t){var n;return{type:"LiveMap",id:(n=this._id)!=null?n:pr(),key:t,payload:Array.from(this._map.entries()).map(([r,i])=>i.toTreeNode(r))}}toImmutable(){return super.toImmutable()}_toImmutable(){const t=new Map;for(const[n,r]of this._map)t.set(n,r.toImmutable());return _e(t)}clone(){return new Yr(Array.from(this._map).map(([t,n])=>[t,n.clone()]))}},Gt=class an extends hr{constructor(t={}){super(),this._propToLastUpdate=new Map;const n=fr(t);for(const r of Object.keys(n)){const i=n[r];jt(i)&&i._setParentLink(this,r)}this._map=new Map(Object.entries(n))}static _buildRootAndParentToChildren(t){const n=new Map;let r=null;for(const[i,o]of t)if(Fl(o))r=[i,o];else{const s=[i,o],a=n.get(o.parentId);a!==void 0?a.push(s):n.set(o.parentId,[s])}if(r===null)throw new Error("Root can't be null");return[r,n]}static _fromItems(t,n){const[r,i]=an._buildRootAndParentToChildren(t);return an._deserialize(r,i,n)}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const i=r==null?void 0:r.generateOpId(),o=[],s={type:4,id:this._id,opId:i,parentId:t,parentKey:n,data:{}};o.push(s);for(const[a,c]of this._map)jt(c)?o.push(...c._toOps(this._id,a,r)):s.data[a]=c;return o}static _deserialize([t,n],r,i){const o=new an(n.data);return o._attach(t,i),this._deserializeChildren(o,r,i)}static _deserializeChildren(t,n,r){const i=n.get(lt(t._id));if(i===void 0)return t;for(const[o,s]of i){const a=$l([o,s],n,r);We(a)&&a._setParentLink(t,s.parentKey),t._map.set(s.parentKey,a),t.invalidate()}return t}_attach(t,n){super._attach(t,n);for(const[r,i]of this._map)jt(i)&&i._attach(n.generateId(),n)}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:r,opId:i,parentKey:o}=t,s=Ws(t);if(this._pool.getNode(r)!==void 0)return this._propToLastUpdate.get(o)===i&&this._propToLastUpdate.delete(o),{modified:!1};if(n===0)this._propToLastUpdate.set(o,lt(i));else if(this._propToLastUpdate.get(o)!==void 0)return this._propToLastUpdate.get(o)===i?(this._propToLastUpdate.delete(o),{modified:!1}):{modified:!1};const a=lt(this._id),c=this._map.get(o);let l;return jt(c)?(l=c._toOps(a,o),c._detach()):c===void 0?l=[{type:6,id:a,key:o}]:l=[{type:3,id:a,data:{[o]:c}}],this._map.set(o,s),this.invalidate(),We(s)&&(s._setParentLink(this,o),s._attach(r,this._pool)),{reverse:l,modified:{node:this,type:"LiveObject",updates:{[o]:{type:"update"}}}}}_detachChild(t){if(t){const n=lt(this._id),r=lt(t._parentKey),i=t._toOps(n,r,this._pool);for(const[s,a]of this._map)a===t&&(this._map.delete(s),this.invalidate());return t._detach(),{modified:{node:this,type:"LiveObject",updates:{[r]:{type:"delete"}}},reverse:i}}return{modified:!1}}_detach(){super._detach();for(const t of this._map.values())jt(t)&&t._detach()}_apply(t,n){return t.type===3?this._applyUpdate(t,n):t.type===6?this._applyDeleteObjectKey(t,n):super._apply(t,n)}_serialize(){const t={};for(const[n,r]of this._map)jt(r)||(t[n]=r);return this.parent.type==="HasParent"&&this.parent.node._id?{type:0,parentId:this.parent.node._id,parentKey:this.parent.key,data:t}:{type:0,data:t}}_applyUpdate(t,n){let r=!1;const i=lt(this._id),o=[],s={type:3,id:i,data:{}};for(const c in t.data){const l=this._map.get(c);jt(l)?(o.push(...l._toOps(i,c)),l._detach()):l!==void 0?s.data[c]=l:l===void 0&&o.push({type:6,id:i,key:c})}const a={};for(const c in t.data){const l=t.data[c];if(l===void 0)continue;if(n)this._propToLastUpdate.set(c,lt(t.opId));else if(this._propToLastUpdate.get(c)===void 0)r=!0;else if(this._propToLastUpdate.get(c)===t.opId){this._propToLastUpdate.delete(c);continue}else continue;const u=this._map.get(c);jt(u)&&u._detach(),r=!0,a[c]={type:"update"},this._map.set(c,l),this.invalidate()}return Object.keys(s.data).length!==0&&o.unshift(s),r?{modified:{node:this,type:"LiveObject",updates:a},reverse:o}:{modified:!1}}_applyDeleteObjectKey(t,n){const r=t.key;if(this._map.has(r)===!1)return{modified:!1};if(!n&&this._propToLastUpdate.get(r)!==void 0)return{modified:!1};const i=this._map.get(r),o=lt(this._id);let s=[];return jt(i)?(s=i._toOps(o,t.key),i._detach()):i!==void 0&&(s=[{type:3,id:o,data:{[r]:i}}]),this._map.delete(r),this.invalidate(),{modified:{node:this,type:"LiveObject",updates:{[t.key]:{type:"delete"}}},reverse:s}}toObject(){return Object.fromEntries(this._map)}set(t,n){var r;(r=this._pool)==null||r.assertStorageIsWritable(),this.update({[t]:n})}get(t){return this._map.get(t)}delete(t){var s;(s=this._pool)==null||s.assertStorageIsWritable();const n=t,r=this._map.get(n);if(r===void 0)return;if(this._pool===void 0||this._id===void 0){jt(r)&&r._detach(),this._map.delete(n),this.invalidate();return}let i;jt(r)?(r._detach(),i=r._toOps(this._id,n)):i=[{type:3,data:{[n]:r},id:this._id}],this._map.delete(n),this.invalidate();const o=new Map;o.set(this._id,{node:this,type:"LiveObject",updates:{[t]:{type:"delete"}}}),this._pool.dispatch([{type:6,key:n,id:this._id,opId:this._pool.generateOpId()}],i,o)}update(t){var l;if((l=this._pool)==null||l.assertStorageIsWritable(),this._pool===void 0||this._id===void 0){for(const u in t){const h=t[u];if(h===void 0)continue;const f=this._map.get(u);jt(f)&&f._detach(),jt(h)&&h._setParentLink(this,u),this._map.set(u,h),this.invalidate()}return}const n=[],r=[],i=this._pool.generateOpId(),o={},s={id:this._id,type:3,data:{}},a={};for(const u in t){const h=t[u];if(h===void 0)continue;const f=this._map.get(u);if(jt(f)?(r.push(...f._toOps(this._id,u)),f._detach()):f===void 0?r.push({type:6,id:this._id,key:u}):s.data[u]=f,jt(h)){h._setParentLink(this,u),h._attach(this._pool.generateId(),this._pool);const _=h._toOps(this._id,u,this._pool),p=_.find(g=>g.parentId===this._id);p&&this._propToLastUpdate.set(u,lt(p.opId)),n.push(..._)}else o[u]=h,this._propToLastUpdate.set(u,i);this._map.set(u,h),this.invalidate(),a[u]={type:"update"}}Object.keys(s.data).length!==0&&r.unshift(s),Object.keys(o).length!==0&&n.unshift({opId:i,id:this._id,type:3,data:o});const c=new Map;c.set(this._id,{node:this,type:"LiveObject",updates:a}),this._pool.dispatch(n,r,c)}toImmutable(){return super.toImmutable()}toTreeNode(t){return super.toTreeNode(t)}_toTreeNode(t){var r;const n=(r=this._id)!=null?r:pr();return{type:"LiveObject",id:n,key:t,payload:Array.from(this._map.entries()).map(([i,o])=>jt(o)?o.toTreeNode(i):{type:"Json",id:`${n}:${i}`,key:i,payload:o})}}_toImmutable(){const t={};for(const[n,r]of this._map)t[n]=We(r)?r.toImmutable():r;return Object.freeze(t)}clone(){return new an(Object.fromEntries(Array.from(this._map).map(([t,n])=>[t,We(n)?n.clone():hn(n)])))}};function cn(e){return $e(Ws(e))}function Ws(e){switch(e.type){case 8:return e.data;case 4:return new Gt(e.data);case 7:return new en;case 2:return new tn;default:return ae(e,"Unknown creation Op")}}function qs(e,t){return e===t?!0:e.parent.type==="HasParent"?qs(e.parent.node,t):!1}function $s([e,t],n,r){switch(t.type){case 0:return Gt._deserialize([e,t],n,r);case 1:return tn._deserialize([e,t],n,r);case 2:return en._deserialize([e,t],n,r);case 3:return Be._deserialize([e,t],n,r);default:throw new Error("Unexpected CRDT type")}}function $l([e,t],n,r){switch(t.type){case 0:return Gt._deserialize([e,t],n,r);case 1:return tn._deserialize([e,t],n,r);case 2:return en._deserialize([e,t],n,r);case 3:return t.data;default:throw new Error("Unexpected CRDT type")}}function We(e){return Ys(e)||Yl(e)||Zl(e)}function jt(e){return We(e)||Xl(e)}function Ys(e){return e instanceof tn}function Yl(e){return e instanceof en}function Zl(e){return e instanceof Gt}function Xl(e){return e instanceof Be}function Gl(e){return e===void 0?void 0:We(e)?e.clone():hn(e)}function Me(e){return e instanceof Be?e.data:e instanceof tn||e instanceof en||e instanceof Gt?e:ae(e,"Unknown AbstractCrdt")}function $e(e){return e instanceof Gt||e instanceof en||e instanceof tn?e:new Be(e)}function Jl(e,t){const n=[];return e.forEach((r,i)=>{t.get(i)||n.push({type:5,id:i})}),t.forEach((r,i)=>{const o=e.get(i);if(o)r.type===0&&(o.type!==0||JSON.stringify(r.data)!==JSON.stringify(o.data))&&n.push({type:3,id:i,data:r.data}),r.parentKey!==o.parentKey&&n.push({type:1,id:i,parentKey:lt(r.parentKey,"Parent key must not be missing")});else switch(r.type){case 3:n.push({type:8,id:i,parentId:r.parentId,parentKey:r.parentKey,data:r.data});break;case 1:n.push({type:2,id:i,parentId:r.parentId,parentKey:r.parentKey});break;case 0:if(r.parentId===void 0||r.parentKey===void 0)throw new Error("Internal error. Cannot serialize storage root into an operation");n.push({type:4,id:i,parentId:r.parentId,parentKey:r.parentKey,data:r.data});break;case 2:n.push({type:7,id:i,parentId:r.parentId,parentKey:r.parentKey});break}}),n}function Ql(e,t){const n=e.updates;for(const[r,i]of Ps(t.updates))n[r]=i;return{...t,updates:n}}function tu(e,t){const n=e.updates;for(const[r,i]of Ps(t.updates))n[r]=i;return{...t,updates:n}}function eu(e,t){const n=e.updates;return{...t,updates:n.concat(t.updates)}}function xr(e,t){return e===void 0?t:e.type==="LiveObject"&&t.type==="LiveObject"?Ql(e,t):e.type==="LiveMap"&&t.type==="LiveMap"?tu(e,t):e.type==="LiveList"&&t.type==="LiveList"?eu(e,t):t}function nu(e,t){const n={name:e};if(typeof Error.captureStackTrace=="function")return Error.captureStackTrace(n,t),n.stack}function ru(e){return e===null||typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Zs(e){return Array.isArray(e)}function iu(e){return!ru(e)&&!Zs(e)}var ou=/^[a-zA-Z_][a-zA-Z0-9_]*$/;function su(e){let t=[];const n=Object.entries(e),r=[],i=[],o=[];return n.forEach(([s,a])=>{if(!ou.test(s))throw new Error("Key must only contain letters, numbers, _");Ro(a)?r.push([s,a]):Mo(a)?i.push([s,a]):typeof a=="object"&&!("startsWith"in a)&&o.push([s,a])}),t=[...Oo(r),...No(i)],o.forEach(([s,a])=>{const c=Object.entries(a),l=[],u=[];c.forEach(([h,f])=>{if(Xs(h))throw new Error("Key cannot be empty");Ro(f)?l.push([Do(s,h),f]):Mo(f)&&u.push([Do(s,h),f])}),t=[...t,...Oo(l),...No(u)]}),t.map(({key:s,operator:a,value:c})=>au(s,a,cu(c))).join(" AND ")}var Oo=e=>{const t=[];return e.forEach(([n,r])=>{t.push({key:n,operator:":",value:r})}),t},No=e=>{const t=[];return e.forEach(([n,r])=>{"startsWith"in r&&typeof r.startsWith=="string"&&t.push({key:n,operator:"^",value:r.startsWith})}),t},Ro=e=>typeof e=="string"||typeof e=="number"||typeof e=="boolean",Mo=e=>typeof e=="object"&&e!==null&&"startsWith"in e,au=(e,t,n)=>`${e}${t}${n}`,Do=(e,t)=>t?`${e}[${JSON.stringify(t)}]`:e,cu=e=>{if(typeof e=="string"){if(Xs(e))throw new Error("Value cannot be empty");return JSON.stringify(e)}return e.toString()},Xs=e=>!e||e.toString().trim()==="";function Gs(e,t){let n=!1;const r={...e};return Object.keys(t).forEach(i=>{const o=i,s=t[o];r[o]!==s&&(s===void 0?delete r[o]:r[o]=s,n=!0)}),n?r:e}var mr=class{constructor(){this._ev=St()}get didInvalidate(){return this._ev.observable}invalidate(){this._cache!==void 0&&(this._cache=void 0,this._ev.notify())}get current(){var e;return(e=this._cache)!=null?e:this._cache=this._toImmutable()}};function lu(e,t){const{connectionId:n,id:r,info:i}=e,o=Vr(e.scopes);return _e(fr({connectionId:n,id:r,info:i,canWrite:o,canComment:Rs(e.scopes),isReadOnly:!o,presence:t}))}var uu=class extends mr{constructor(){super(),this._connections=new Map,this._presences=new Map,this._users=new Map}connectionIds(){return this._connections.keys()}_toImmutable(){return Br(Array.from(this._presences.keys()).map(t=>this.getUser(Number(t))))}clearOthers(){this._connections=new Map,this._presences=new Map,this._users=new Map,this.invalidate()}_getUser(e){const t=this._connections.get(e),n=this._presences.get(e);if(t!==void 0&&n!==void 0)return lu(t,n)}getUser(e){const t=this._users.get(e);if(t)return t;const n=this._getUser(e);if(n)return this._users.set(e,n),n}_invalidateUser(e){this._users.has(e)&&this._users.delete(e),this.invalidate()}setConnection(e,t,n,r){this._connections.set(e,_e({connectionId:e,id:t,info:n,scopes:r})),this._presences.has(e)&&this._invalidateUser(e)}removeConnection(e){this._connections.delete(e),this._presences.delete(e),this._invalidateUser(e)}setOther(e,t){this._presences.set(e,_e(fr(t))),this._connections.has(e)&&this._invalidateUser(e)}patchOther(e,t){const n=this._presences.get(e);if(n===void 0)return;const r=Gs(n,t);n!==r&&(this._presences.set(e,_e(r)),this._invalidateUser(e))}},fu=class extends mr{constructor(e){super(),this._data=_e(fr(e))}_toImmutable(){return this._data}patch(e){const t=this._data,n=Gs(t,e);t!==n&&(this._data=_e(n),this.invalidate())}},Uo=class extends mr{constructor(e){super(),this._value=_e(e)}_toImmutable(){return this._value}set(e){this._value=_e(e),this.invalidate()}},Ir=class extends mr{constructor(...e){super();const t=e.pop(),n=e;this._refs=n,this._refs.forEach(r=>{r.didInvalidate.subscribe(()=>this.invalidate())}),this._transform=t}_toImmutable(){return this._transform(...this._refs.map(e=>e.current))}},du=1024*1024-1024;function hu(e){let t=0;return()=>`${e}:${t++}`}function jo(e,t){return{type:"User",id:`${t.connectionId}`,key:e,payload:t}}function pu(){const e=typeof document<"u"?document:void 0,t={current:null};function n(){var i;(e==null?void 0:e.visibilityState)==="hidden"?t.current=(i=t.current)!=null?i:Date.now():t.current=null}return e==null||e.addEventListener("visibilitychange",n),[t,()=>{e==null||e.removeEventListener("visibilitychange",n)}]}var Bo=class extends Error{constructor(e,t,n){super(e),this.message=e,this.status=t,this.details=n}};function mu(e,t,n){async function r(p,g,y){const k=await t();return n(e,p,k,y,g)}async function i(p,g,y){const k=await r(p,y,g);if(!k.ok&&k.status>=400&&k.status<600){let m;try{const b=await k.json();m=new Bo(b.message,k.status,b)}catch{m=new Bo(k.statusText,k.status)}throw m}let w;try{w=await k.json()}catch{w={}}return w}async function o(p){var k;let g;p!=null&&p.query&&(g=su(p.query));const y=await r("/threads",{since:(k=p==null?void 0:p.since)==null?void 0:k.toISOString(),query:g},{headers:{"Content-Type":"application/json"}});if(y.ok){const w=await y.json();return{threads:w.data.map(m=>$n(m)),inboxNotifications:w.inboxNotifications.map(m=>Wr(m)),deletedThreads:w.deletedThreads.map(m=>zs(m)),deletedInboxNotifications:w.deletedInboxNotifications.map(m=>Hs(m)),meta:{requestedAt:new Date(w.meta.requestedAt)}}}else{if(y.status===404)return{threads:[],inboxNotifications:[],deletedThreads:[],deletedInboxNotifications:[],meta:{requestedAt:new Date}};throw new Error("There was an error while getting threads.")}}async function s({threadId:p}){const g=await r(`/thread-with-notification/${p}`);if(g.ok){const y=await g.json();return{thread:$n(y.thread),inboxNotification:y.inboxNotification?Wr(y.inboxNotification):void 0}}else{if(g.status===404)return;throw new Error(`There was an error while getting thread ${p}.`)}}async function a({metadata:p,body:g,commentId:y,threadId:k}){const w=await i("/threads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:k,comment:{id:y,body:g},metadata:p})});return $n(w)}async function c({metadata:p,threadId:g}){return await i(`/threads/${encodeURIComponent(g)}/metadata`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})}async function l({threadId:p,commentId:g,body:y}){const k=await i(`/threads/${encodeURIComponent(p)}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g,body:y})});return Kr(k)}async function u({threadId:p,commentId:g,body:y}){const k=await i(`/threads/${encodeURIComponent(p)}/comments/${encodeURIComponent(g)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({body:y})});return Kr(k)}async function h({threadId:p,commentId:g}){await i(`/threads/${encodeURIComponent(p)}/comments/${encodeURIComponent(g)}`,{method:"DELETE"})}async function f({threadId:p,commentId:g,emoji:y}){const k=await i(`/threads/${encodeURIComponent(p)}/comments/${encodeURIComponent(g)}/reactions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emoji:y})});return Pl(k)}async function _({threadId:p,commentId:g,emoji:y}){await i(`/threads/${encodeURIComponent(p)}/comments/${encodeURIComponent(g)}/reactions/${encodeURIComponent(y)}`,{method:"DELETE"})}return{getThreads:o,getThread:s,createThread:a,editThreadMetadata:c,createComment:l,editComment:u,deleteComment:h,addReaction:f,removeReaction:_}}var gu=50;function _u(e,t){var mo;const n=typeof e.initialPresence=="function"?e.initialPresence(t.roomId):e.initialPresence,r=typeof e.initialStorage=="function"?e.initialStorage(t.roomId):e.initialStorage,[i,o]=pu(),s={...t.delegates,canZombie(){return t.backgroundKeepAliveTimeout!==void 0&&i.current!==null&&Date.now()>i.current+t.backgroundKeepAliveTimeout&&An()!=="synchronizing"}},a=new rl(s,t.enableDebugLogging),c={buffer:{flushTimerID:void 0,lastFlushedAt:0,presenceUpdates:{type:"full",data:n},messages:[],storageOperations:[]},staticSessionInfo:new Uo(null),dynamicSessionInfo:new Uo(null),myPresence:new fu(n),others:new uu,initialStorage:r,idFactory:null,clock:0,opClock:0,nodes:new Map,root:void 0,undoStack:[],redoStack:[],pausedHistory:null,activeBatch:null,unacknowledgedOps:new Map,opStackTraces:new Map},l=x=>x(),u=(mo=t.unstable_batchedUpdates)!=null?mo:l;let h;function f(x){const M=a.authValue;if(M!==null){const B=Zr(M);if(B!==h)if(h=B,M.type==="secret"){const X=M.token.parsed;c.staticSessionInfo.set({userId:X.k==="sec-legacy"?X.id:X.uid,userInfo:X.k==="sec-legacy"?X.info:X.ui})}else c.staticSessionInfo.set({userId:void 0,userInfo:void 0})}u(()=>{m.status.notify(x),U(l)})}let _,p=!1;function g(x){x==="reconnecting"?_=setTimeout(()=>{u(()=>{m.lostConnection.notify("lost"),p=!0,c.others.clearOthers(),S({others:[{type:"reset"}]},l)})},t.lostConnectionTimeout):(clearTimeout(_),p&&(u(x==="disconnected"?()=>{m.lostConnection.notify("failed")}:()=>{m.lostConnection.notify("restored")}),p=!1))}function y(){c.buffer.presenceUpdates={type:"full",data:{...c.myPresence.current}},we!==null&&uo({flush:!1}),Ut()}function k(){clearTimeout(c.buffer.flushTimerID)}a.events.onMessage.subscribe(En),a.events.statusDidChange.subscribe(f),a.events.statusDidChange.subscribe(g),a.events.didConnect.subscribe(y),a.events.didDisconnect.subscribe(k),a.events.onLiveblocksError.subscribe(x=>{u(()=>{Zi(`Connection to websocket server closed. Reason: ${x.message} (code: ${x.code}).`),m.error.notify(x)})});const w={roomId:t.roomId,getNode:x=>c.nodes.get(x),addNode:(x,M)=>void c.nodes.set(x,M),deleteNode:x=>void c.nodes.delete(x),generateId:()=>`${z()}:${c.clock++}`,generateOpId:()=>`${z()}:${c.opClock++}`,dispatch(x,M,B){const X=c.activeBatch;{const pt=nu("Storage mutation",this.dispatch);if(pt)for(const tt of x)tt.opId&&lt(c.opStackTraces).set(tt.opId,pt)}if(X){for(const pt of x)X.ops.push(pt);for(const[pt,tt]of B)X.updates.storageUpdates.set(pt,xr(X.updates.storageUpdates.get(pt),tt));X.reverseOps.unshift(...M)}else u(()=>{I(M,l),c.redoStack.length=0,Ve(x),S({storageUpdates:B},l)})},assertStorageIsWritable:()=>{var B;const x=(B=c.dynamicSessionInfo.current)==null?void 0:B.scopes;if(x===void 0)return;if(!Vr(x))throw new Error("Cannot write to storage with a read only user, please ensure the user has write permissions")}},m={connection:St(),status:St(),lostConnection:St(),customEvent:St(),self:St(),myPresence:St(),others:St(),error:St(),storage:St(),history:St(),storageDidLoad:St(),storageStatus:St(),ydoc:St(),comments:St()};async function b(x,M,B,X,pt){var At;const tt=Fs(t.baseUrl,`/v2/c/rooms/${encodeURIComponent(x)}${M}`,pt);return await(((At=t.polyfills)==null?void 0:At.fetch)||fetch)(tt,{...X,headers:{...X==null?void 0:X.headers,Authorization:`Bearer ${Zr(B)}`}})}async function P(x,M){return b(M,"/storage",x,{method:"GET",headers:{"Content-Type":"application/json"}})}async function N(x,M){if(!a.authValue)throw new Error("Not authorized");return b(t.roomId,x,a.authValue,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})}function A(x){var X;const M=JSON.stringify(x),B=(X=c.dynamicSessionInfo.current)==null?void 0:X.nonce;if(t.unstable_fallbackToHTTP&&B&&new TextEncoder().encode(M).length>du){N("/send-message",{nonce:B,messages:x}).then(tt=>{!tt.ok&&tt.status===403&&a.reconnect()}),ne("Message was too large for websockets and sent over HTTP instead");return}a.send(M)}const L=new Ir(c.staticSessionInfo,c.dynamicSessionInfo,c.myPresence,(x,M,B)=>{if(x===null||M===null)return null;{const X=Vr(M.scopes);return{connectionId:M.actor,id:x.userId,info:x.userInfo,presence:B,canWrite:X,canComment:Rs(M.scopes),isReadOnly:!X}}});let j;function U(x){const M=L.current;M!==null&&M!==j&&(x(()=>{m.self.notify(M)}),j=M)}const W=new Ir(L,x=>x!==null?jo("Me",x):null);function R(x,M){if(x.items.length===0)throw new Error("Internal error: cannot load storage without items");c.root!==void 0?G(x.items,M):c.root=Gt._fromItems(x.items,w);const B=c.undoStack.length;for(const X in c.initialStorage)c.root.get(X)===void 0&&c.root.set(X,Gl(c.initialStorage[X]));c.undoStack.length=B}function G(x,M){if(c.root===void 0)return;const B=new Map;for(const[tt,gt]of c.nodes)B.set(tt,gt._serialize());const X=Jl(B,new Map(x)),pt=K(X,!1);S(pt.updates,M)}function v(x,M){c.undoStack.length>=50&&c.undoStack.shift(),c.undoStack.push(x),ct(M)}function I(x,M){c.pausedHistory!==null?c.pausedHistory.unshift(...x):v(x,M)}function S(x,M){const B=x.storageUpdates,X=x.others;M(()=>{var pt;if(X!==void 0&&X.length>0){const tt=c.others.current;for(const gt of X)m.others.notify({...gt,others:tt})}if((pt=x.presence)!=null&&pt&&(U(l),m.myPresence.notify(c.myPresence.current)),B!==void 0&&B.size>0){const tt=Array.from(B.values());m.storage.notify(tt)}Ln()})}function z(){const x=c.dynamicSessionInfo.current;if(x)return x.actor;throw new Error("Internal. Tried to get connection id but connection was never open")}function K(x,M){const B={reverse:[],storageUpdates:new Map,presence:!1},X=new Set,pt=x.map(tt=>tt.type!=="presence"&&!tt.opId?{...tt,opId:w.generateOpId()}:tt);for(const tt of pt)if(tt.type==="presence"){const gt={type:"presence",data:{}};for(const At in tt.data)gt.data[At]=c.myPresence.current[At];if(c.myPresence.patch(tt.data),c.buffer.presenceUpdates===null)c.buffer.presenceUpdates={type:"partial",data:tt.data};else for(const At in tt.data)c.buffer.presenceUpdates.data[At]=tt.data[At];B.reverse.unshift(gt),B.presence=!0}else{let gt;if(M)gt=0;else{const oe=lt(tt.opId);lt(c.opStackTraces).delete(oe),gt=c.unacknowledgedOps.delete(oe)?2:1}const At=q(tt,gt);if(At.modified){const oe=At.modified.node._id;oe&&X.has(oe)||(B.storageUpdates.set(lt(At.modified.node._id),xr(B.storageUpdates.get(lt(At.modified.node._id)),At.modified)),B.reverse.unshift(...At.reverse)),(tt.type===2||tt.type===7||tt.type===4)&&X.add(lt(tt.id))}}return{ops:pt,reverse:B.reverse,updates:{storageUpdates:B.storageUpdates,presence:B.presence}}}function q(x,M){if(zl(x))return{modified:!1};switch(x.type){case 6:case 3:case 5:{const B=c.nodes.get(x.id);return B===void 0?{modified:!1}:B._apply(x,M===0)}case 1:{const B=c.nodes.get(x.id);return B===void 0?{modified:!1}:B.parent.type==="HasParent"&&Ys(B.parent.node)?B.parent.node._setChildKey(pn(x.parentKey),B,M):{modified:!1}}case 4:case 2:case 7:case 8:{if(x.parentId===void 0)return{modified:!1};const B=c.nodes.get(x.parentId);return B===void 0?{modified:!1}:B._attachChild(x,M)}}}function V(x,M){const B={};c.buffer.presenceUpdates===null&&(c.buffer.presenceUpdates={type:"partial",data:{}});for(const X in x){const pt=x[X];pt!==void 0&&(c.buffer.presenceUpdates.data[X]=pt,B[X]=c.myPresence.current[X])}c.myPresence.patch(x),c.activeBatch?(M!=null&&M.addToHistory&&c.activeBatch.reverseOps.unshift({type:"presence",data:B}),c.activeBatch.updates.presence=!0):(Ut(),u(()=>{M!=null&&M.addToHistory&&I([{type:"presence",data:B}],l),S({presence:!0},l)}))}function Y(x){if(x.targetActor!==void 0){const B=c.others.getUser(x.actor);c.others.setOther(x.actor,x.data);const X=c.others.getUser(x.actor);if(B===void 0&&X!==void 0)return{type:"enter",user:X}}else c.others.patchOther(x.actor,x.data);const M=c.others.getUser(x.actor);if(M)return{type:"update",updates:x.data,user:M}}function Q(x){const M=c.others.getUser(x.actor);return M?(c.others.removeConnection(x.actor),{type:"leave",user:M}):null}function D(x,M){c.dynamicSessionInfo.set({actor:x.actor,nonce:x.nonce,scopes:x.scopes}),c.idFactory=hu(x.actor),U(M);for(const B of c.others.connectionIds())x.users[B]===void 0&&c.others.removeConnection(B);for(const B in x.users){const X=x.users[B],pt=Number(B);c.others.setConnection(pt,X.id,X.info,X.scopes)}return{type:"reset"}}function ut(){return c.undoStack.length>0}function _t(){return c.redoStack.length>0}function ct(x){x(()=>{m.history.notify({canUndo:ut(),canRedo:_t()})})}function ft(x){c.others.setConnection(x.actor,x.id,x.info,x.scopes),c.buffer.messages.push({type:100,data:c.myPresence.current,targetActor:x.actor}),Ut();const M=c.others.getUser(x.actor);return M?{type:"enter",user:M}:void 0}function xt(x){return iu(x)?x:null}function Ft(x){const M=Gi(x);return M===void 0?null:Zs(M)?Br(M.map(B=>xt(B))):Br([xt(M)])}function Cn(x,M){if(x.size===0)return;const B=[],X=Array.from(x.values()),pt=K(X,!0);B.push({type:201,ops:pt.ops}),S(pt.updates,M),A(B)}function En(x){if(typeof x.data!="string")return;const M=Ft(x.data);if(M===null||M.length===0)return;const B={storageUpdates:new Map,others:[]};u(()=>{var X,pt;for(const tt of M)switch(tt.type){case 101:{const gt=ft(tt);gt&&B.others.push(gt);break}case 100:{const gt=Y(tt);gt&&B.others.push(gt);break}case 103:{const gt=c.others.current;m.customEvent.notify({connectionId:tt.actor,user:tt.actor<0?null:(X=gt.find(At=>At.connectionId===tt.actor))!=null?X:null,event:tt.event});break}case 102:{const gt=Q(tt);gt&&B.others.push(gt);break}case 300:{m.ydoc.notify(tt);break}case 104:{B.others.push(D(tt,l));break}case 200:{lo(tt);break}case 201:{const gt=K(tt.ops,!1);for(const[At,oe]of gt.updates.storageUpdates)B.storageUpdates.set(At,xr(B.storageUpdates.get(At),oe));break}case 299:{Xi("Storage mutation rejection error",tt.reason);{const gt=new Set;for(const At of tt.opIds){const oe=(pt=c.opStackTraces)==null?void 0:pt.get(At);oe&&gt.add(oe)}throw gt.size>0&&xs("The following function calls caused the rejected storage mutations:",`

${Array.from(gt).join(`

`)}`),new Error(`Storage mutations rejected by server: ${tt.reason}`)}}case 400:case 401:case 405:case 406:case 402:case 403:case 404:{m.comments.notify(tt);break}}S(B,l)})}function Ut(){const x=c.buffer.storageOperations;if(x.length>0){for(const X of x)c.unacknowledgedOps.set(lt(X.opId),X);Ln()}if(a.getStatus()!=="connected"){c.buffer.storageOperations=[];return}const M=Date.now(),B=M-c.buffer.lastFlushedAt;if(B>=t.throttleDelay){const X=Sn();if(X.length===0)return;A(X),c.buffer={flushTimerID:void 0,lastFlushedAt:M,messages:[],storageOperations:[],presenceUpdates:null}}else clearTimeout(c.buffer.flushTimerID),c.buffer.flushTimerID=setTimeout(Ut,t.throttleDelay-B)}function Sn(){const x=[];c.buffer.presenceUpdates&&x.push(c.buffer.presenceUpdates.type==="full"?{type:100,targetActor:-1,data:c.buffer.presenceUpdates.data}:{type:100,data:c.buffer.presenceUpdates.data});for(const M of c.buffer.messages)x.push(M);return c.buffer.storageOperations.length>0&&x.push({type:201,ops:c.buffer.storageOperations}),x}function xn(x,M){const B={type:301,update:x,guid:M};c.buffer.messages.push(B),m.ydoc.notify(B),Ut()}function In(x,M={shouldQueueEventIfNotReady:!1}){a.getStatus()!=="connected"&&!M.shouldQueueEventIfNotReady||(c.buffer.messages.push({type:103,event:x}),Ut())}function Ve(x){const{storageOperations:M}=c.buffer;for(const B of x)M.push(B);Ut()}let we=null,Pn=null;function lo(x){const M=new Map(c.unacknowledgedOps);R(x,l),Cn(M,l),Pn==null||Pn(),Ln(),m.storageDidLoad.notify()}async function ac(){if(!a.authValue)return;const M=await(await P(a.authValue,t.roomId)).json();lo({type:200,items:M})}function uo(x){const M=c.buffer.messages;t.unstable_streamData?ac():M.some(B=>B.type===200)||M.push({type:200}),x.flush&&Ut()}function fo(){return we===null&&(uo({flush:!0}),we=new Promise(x=>{Pn=x}),Ln()),we}function cc(){const x=c.root;return x!==void 0?x:(fo(),null)}async function lc(){return c.root!==void 0?Promise.resolve({root:c.root}):(await fo(),{root:lt(c.root)})}function uc(x,M){c.buffer.messages.find(B=>B.type===300&&B.vector===x&&B.guid===M)||c.buffer.messages.push({type:300,vector:x,guid:M}),Ut()}function fc(){if(c.activeBatch)throw new Error("undo is not allowed during a batch");const x=c.undoStack.pop();if(x===void 0)return;c.pausedHistory=null;const M=K(x,!0);u(()=>{S(M.updates,l),c.redoStack.push(M.reverse),ct(l)});for(const B of M.ops)B.type!=="presence"&&c.buffer.storageOperations.push(B);Ut()}function dc(){if(c.activeBatch)throw new Error("redo is not allowed during a batch");const x=c.redoStack.pop();if(x===void 0)return;c.pausedHistory=null;const M=K(x,!0);u(()=>{S(M.updates,l),c.undoStack.push(M.reverse),ct(l)});for(const B of M.ops)B.type!=="presence"&&c.buffer.storageOperations.push(B);Ut()}function hc(){c.undoStack.length=0,c.redoStack.length=0}function pc(x){if(c.activeBatch)return x();let M;return u(()=>{c.activeBatch={ops:[],updates:{storageUpdates:new Map,presence:!1,others:[]},reverseOps:[]};try{M=x()}finally{const B=c.activeBatch;c.activeBatch=null,B.reverseOps.length>0&&I(B.reverseOps,l),B.ops.length>0&&(c.redoStack.length=0),B.ops.length>0&&Ve(B.ops),S(B.updates,l),Ut()}}),M}function mc(){c.pausedHistory===null&&(c.pausedHistory=[])}function gc(){const x=c.pausedHistory;c.pausedHistory=null,x!==null&&x.length>0&&v(x,u)}function An(){return c.root===void 0?we===null?"not-loaded":"loading":c.unacknowledgedOps.size===0?"synchronized":"synchronizing"}let ho=An();function Ln(){const x=An();ho!==x&&(ho=x,m.storageStatus.notify(x))}const _c=new Ir(c.others,x=>x.map((M,B)=>jo(`Other ${B}`,M))),po={status:m.status.observable,lostConnection:m.lostConnection.observable,customEvent:m.customEvent.observable,others:m.others.observable,self:m.self.observable,myPresence:m.myPresence.observable,error:m.error.observable,storage:m.storage.observable,history:m.history.observable,storageDidLoad:m.storageDidLoad.observable,storageStatus:m.storageStatus.observable,ydoc:m.ydoc.observable,comments:m.comments.observable},yc=mu(t.roomId,s.authenticate,b);async function Cr(x,M){const B=await s.authenticate(),X=await b(t.roomId,x,B,M);if(!X.ok&&X.status>=400&&X.status<600){let tt;try{const gt=await X.json();tt=new er(gt.message,X.status,gt)}catch{tt=new er(X.statusText,X.status)}throw tt}let pt;try{pt=await X.json()}catch{pt={}}return pt}function vc(){return Cr("/notification-settings")}function wc(x){return Cr("/notification-settings",{method:"POST",body:JSON.stringify(x),headers:{"Content-Type":"application/json"}})}async function bc(x){await Cr("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:x})})}const kc=new Qi(async x=>{const M=x.flat();return await bc(M),M},{delay:gu});async function Cc(x){await kc.get(x)}return Object.defineProperty({[xe]:{get presenceBuffer(){var x,M;return hn((M=(x=c.buffer.presenceUpdates)==null?void 0:x.data)!=null?M:null)},get undoStack(){return hn(c.undoStack)},get nodeCount(){return c.nodes.size},getSelf_forDevTools:()=>W.current,getOthers_forDevTools:()=>_c.current,simulate:{explicitClose:x=>a._privateSendMachineEvent({type:"EXPLICIT_SOCKET_CLOSE",event:x}),rawSend:x=>a.send(x)},comments:{...yc},notifications:{getRoomNotificationSettings:vc,updateRoomNotificationSettings:wc,markInboxNotificationAsRead:Cc}},id:t.roomId,subscribe:yu(po),connect:()=>a.connect(),reconnect:()=>a.reconnect(),disconnect:()=>a.disconnect(),destroy:()=>{o(),a.destroy()},updatePresence:V,updateYDoc:xn,broadcastEvent:In,batch:pc,history:{undo:fc,redo:dc,canUndo:ut,canRedo:_t,clear:hc,pause:mc,resume:gc},fetchYDoc:uc,getStorage:lc,getStorageSnapshot:cc,getStorageStatus:An,events:po,getStatus:()=>a.getStatus(),getConnectionState:()=>a.getLegacyStatus(),getSelf:()=>L.current,getPresence:()=>c.myPresence.current,getOthers:()=>c.others.current},xe,{enumerable:!1})}function yu(e){function t(i,o){return e.storage.subscribe(s=>{const a=s.filter(c=>qs(c.node,i));a.length>0&&o(a)})}function n(i,o){return e.storage.subscribe(s=>{for(const a of s)a.node._id===i._id&&o(a.node)})}function r(i,o,s){if(typeof i=="string"&&vu(i)){if(typeof o!="function")throw new Error("Second argument must be a callback function");const a=o;switch(i){case"event":return e.customEvent.subscribe(a);case"my-presence":return e.myPresence.subscribe(a);case"others":{const c=a;return e.others.subscribe(l=>{const{others:u,...h}=l;return c(u,h)})}case"error":return e.error.subscribe(a);case"connection":{const c=a;return e.status.subscribe(l=>c(As(l)))}case"status":return e.status.subscribe(a);case"lost-connection":return e.lostConnection.subscribe(a);case"history":return e.history.subscribe(a);case"storage-status":return e.storageStatus.subscribe(a);default:return ae(i,`"${String(i)}" is not a valid event name`)}}if(o===void 0||typeof i=="function")if(typeof i=="function"){const a=i;return e.storage.subscribe(a)}else throw new Error("Please specify a listener callback");if(jt(i)){const a=i;return s!=null&&s.isDeep?t(a,o):n(a,o)}throw new Error(`${String(i)} is not a value that can be subscribed to.`)}return r}function vu(e){return e==="my-presence"||e==="others"||e==="event"||e==="error"||e==="history"||e==="status"||e==="storage-status"||e==="lost-connection"||e==="connection"}function wu(e,t){return async()=>t.getAuthValue({requestedScope:"room:read",roomId:e})}function bu(e,t,n){return r=>{const i=n!=null?n:typeof WebSocket>"u"?void 0:WebSocket;if(i===void 0)throw new Re("To use Liveblocks client in a non-DOM environment, you need to provide a WebSocket polyfill.");const o=new URL(t);if(o.protocol=o.protocol==="http:"?"ws":"wss",o.pathname="/v7",o.searchParams.set("roomId",e),r.type==="secret")o.searchParams.set("tok",r.token.raw);else if(r.type==="public")o.searchParams.set("pubkey",r.publicApiKey);else return ae(r,"Unhandled case");return o.searchParams.set("version",qe),new i(o.toString())}}function ku(){const e=Vs({threads:{},queries:{},optimisticUpdates:[],inboxNotifications:{},notificationSettings:{}});return{...e,deleteThread(t){e.set(n=>({...n,threads:Cu(n.threads,t),inboxNotifications:Object.fromEntries(Object.entries(n.inboxNotifications).filter(([r,i])=>i.kind==="thread"&&i.threadId===t))}))},updateThreadAndNotification(t,n){e.set(r=>{const i=r.threads[t.id];return{...r,threads:i===void 0||Js(t,i)===1?{...r.threads,[t.id]:t}:r.threads,inboxNotifications:n===void 0?r.inboxNotifications:{...r.inboxNotifications,[n.id]:n}}})},updateThreadsAndNotifications(t,n,r,i,o){e.set(s=>({...s,threads:Eu(s.threads,{newThreads:t,deletedThreads:r}),inboxNotifications:Su(s.inboxNotifications,{newInboxNotifications:n,deletedNotifications:i}),queries:o!==void 0?{...s.queries,[o]:{isLoading:!1}}:s.queries}))},updateRoomInboxNotificationSettings(t,n,r){e.set(i=>({...i,notificationSettings:{...i.notificationSettings,[t]:n},queries:{...i.queries,[r]:{isLoading:!1}}}))},pushOptimisticUpdate(t){e.set(n=>({...n,optimisticUpdates:[...n.optimisticUpdates,t]}))},setQueryState(t,n){e.set(r=>({...r,queries:{...r.queries,[t]:n}}))}}}function Cu(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){const{[t]:n,...r}=e;return r}return e}function Js(e,t){return e.updatedAt&&t.updatedAt?e.updatedAt>t.updatedAt?1:e.updatedAt<t.updatedAt?-1:0:e.updatedAt||t.updatedAt?e.updatedAt?1:-1:e.createdAt>t.createdAt?1:e.createdAt<t.createdAt?-1:0}function Eu(e,t){const n={...e};return t.newThreads.forEach(r=>{const i=n[r.id];i&&Js(i,r)===1||(n[r.id]=r)}),t.deletedThreads.forEach(({id:r,deletedAt:i})=>{const o=n[r];o!==void 0&&(o.deletedAt=i,o.updatedAt=i,o.comments=[])}),n}function Su(e,t){const n={...e};return t.newInboxNotifications.forEach(r=>{const i=n[r.id];i&&xu(i,r)===1||(n[r.id]=r)}),t.deletedNotifications.forEach(({id:r})=>delete n[r]),n}function xu(e,t){return e.notifiedAt>t.notifiedAt?1:e.notifiedAt<t.notifiedAt?-1:e.readAt&&t.readAt?e.readAt>t.readAt?1:e.readAt<t.readAt?-1:0:e.readAt||t.readAt?e.readAt?1:-1:0}var Iu=16,Pu=1e3,Au=100,Lu=15e3,Tu=200,Ou=1e3,Nu=3e4,Ru=5e3,Mu=50,Du=50;function Uu(e){return typeof e=="string"&&e.startsWith("http")?e:cl}function Zr(e){return e.type==="public"?e.publicApiKey:e.token.raw}function Vo(e){var W,R,G;const t=e,n=Bu((W=t.throttle)!=null?W:Au),r=Vu((R=t.lostConnectionTimeout)!=null?R:Ru),i=ju(t.backgroundKeepAliveTimeout),o=Uu(t.baseUrl),s=ol(e),a=new Map;function c(v){kl(v.id),a.delete(v.id),v.destroy()}function l(v){const I=()=>{const S=I;v.unsubs.delete(S)?v.unsubs.size===0&&c(v.room):ne("This leave function was already called. Calling it more than once has no effect.")};return v.unsubs.add(I),{room:v.room,leave:I}}function u(v,I){var V,Y,Q,D,ut,_t;const S=a.get(v);if(S!==void 0)return l(S);Il(I.initialPresence===null||I.initialPresence===void 0,"Please provide an initial presence value for the current user when entering the room.");const z=_u({initialPresence:(V=I.initialPresence)!=null?V:{},initialStorage:I.initialStorage},{roomId:v,throttleDelay:n,lostConnectionTimeout:r,backgroundKeepAliveTimeout:i,polyfills:t.polyfills,delegates:(Q=t.mockedDelegates)!=null?Q:{createSocket:bu(v,o,(Y=t.polyfills)==null?void 0:Y.WebSocket),authenticate:wu(v,s)},enableDebugLogging:t.enableDebugLogging,unstable_batchedUpdates:I==null?void 0:I.unstable_batchedUpdates,baseUrl:o,unstable_fallbackToHTTP:!!t.unstable_fallbackToHTTP,unstable_streamData:!!t.unstable_streamData}),K={room:z,unsubs:new Set};if(a.set(v,K),ul(()=>Array.from(a.keys())),bl(v,z),(ut=(D=I.autoConnect)!=null?D:I.shouldInitiallyConnect)!=null?ut:!0){if(typeof atob>"u"){if(((_t=t.polyfills)==null?void 0:_t.atob)===void 0)throw new Error("You need to polyfill atob to use the client in your environment. Please follow the instructions at https://liveblocks.io/docs/errors/liveblocks-client/atob-polyfill");global.atob=t.polyfills.atob}z.connect()}return l(K)}function h(v,I){const{room:S,leave:z}=u(v,I);return S}function f(v){var S;const I=(S=a.get(v))==null?void 0:S.room;return I||null}function _(v){var S,z;const I=(z=(S=a.get(v))==null?void 0:S.unsubs)!=null?z:new Set;for(const K of I)K()}function p(){s.reset();for(const{room:v}of a.values())qc(v.getStatus())||v.reconnect()}const g=Vs(null),{getInboxNotifications:y,getUnreadInboxNotificationsCount:k,markAllInboxNotificationsAsRead:w,markInboxNotificationAsRead:m}=Tl({baseUrl:o,fetcher:((G=t.polyfills)==null?void 0:G.fetch)||fetch,authManager:s,currentUserIdStore:g}),b=ku(),P=t.resolveUsers,N=zo(()=>!P,"Set the resolveUsers option in createClient to specify user info."),A=Po(async v=>{const I=v.flat(),S=await(P==null?void 0:P({userIds:I}));return N(),S!=null?S:I.map(()=>{})},{delay:Mu}),L=t.resolveRoomsInfo,j=zo(()=>!L,"Set the resolveRoomsInfo option in createClient to specify room info."),U=Po(async v=>{const I=v.flat(),S=await(L==null?void 0:L({roomIds:I}));return j(),S!=null?S:I.map(()=>{})},{delay:Du});return Object.defineProperty({logout:p,enter:h,getRoom:f,leave:_,enterRoom:u,[xe]:{notifications:{getInboxNotifications:y,getUnreadInboxNotificationsCount:k,markAllInboxNotificationsAsRead:w,markInboxNotificationAsRead:m},currentUserIdStore:g,resolveMentionSuggestions:t.resolveMentionSuggestions,cacheStore:b,usersStore:A,roomsInfoStore:U,getRoomIds(){return Array.from(a.keys())}}},xe,{enumerable:!1})}var er=class extends Error{constructor(e,t,n){super(e),this.message=e,this.status=t,this.details=n}};function no(e,t,n,r,i){if(typeof t!="number"||t<n||r!==void 0&&t>r)throw new Error(r!==void 0?`${e} should be between ${i!=null?i:n} and ${r}.`:`${e} should be at least ${i!=null?i:n}.`);return t}function ju(e){if(e!==void 0)return no("backgroundKeepAliveTimeout",e,Lu)}function Bu(e){return no("throttle",e,Iu,Pu)}function Vu(e){return no("lostConnectionTimeout",e,Tu,Nu,Ou)}function zo(e,...t){let n=!1;return()=>{!n&&(typeof e=="function"?e():e)&&(ne(...t),n=!0)}}var zu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};new RegExp(Object.keys(zu).map(e=>`\\${e}`).join("|"),"g");var Hu={_:"\\_","*":"\\*","#":"\\#","`":"\\`","~":"\\~","!":"\\!","|":"\\|","(":"\\(",")":"\\)","{":"\\{","}":"\\}","[":"\\[","]":"\\]"};new RegExp(Object.keys(Hu).map(e=>`\\${e}`).join("|"),"g");ks(bs,qe,Oc);var Fu="@liveblocks/client",Ku="1.12.0",Wu="esm";ks(Fu,Ku,Wu);const nr=Symbol(),Xr=Symbol(),{Error:Ho}=Qe;function Gr(e){let t;const n=e[2].default,r=Fi(n,e,e[1],null),i={c:function(){r&&r.c()},l:function(s){r&&r.l(s)},m:function(s,a){r&&r.m(s,a),t=!0},p:function(s,[a]){r&&r.p&&(!t||a&2)&&Ki(r,n,s,s[1],t?qi(n,s[1],a,null):Wi(s[1]),null)},i:function(s){t||(Z(r,s),t=!0)},o:function(s){J(r,s),t=!1},d:function(s){r&&r.d(s)}};return $("SvelteRegisterBlock",{block:i,id:Gr.name,type:"component",source:"",ctx:e}),i}function qu(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("LiveblocksProvider",r,["default"]);let{client:o}=t;if(!o)throw new Error("LiveblocksProvider requires a client");Qn(nr,o),e.$$.on_mount.push(function(){o===void 0&&!("client"in t||e.$$.bound[e.$$.props.client])&&console.warn("<LiveblocksProvider> was created without expected prop 'client'")});const s=["client"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<LiveblocksProvider> was created with unknown prop '${a}'`)}),e.$$set=a=>{"client"in a&&n(0,o=a.client),"$$scope"in a&&n(1,i=a.$$scope)},e.$capture_state=()=>({clientSymbol:nr,setContext:Qn,client:o}),e.$inject_state=a=>{"client"in a&&n(0,o=a.client)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o,i,r]}class Qs extends Tt{constructor(t){super(t),Ot(this,t,qu,Gr,Nt,{client:0}),$("SvelteRegisterComponent",{component:this,tagName:"LiveblocksProvider",options:t,id:Gr.name})}get client(){throw new Ho("<LiveblocksProvider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set client(t){throw new Ho("<LiveblocksProvider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{Error:Dn}=Qe;function Jr(e){let t;const n=e[3].default,r=Fi(n,e,e[2],null),i={c:function(){r&&r.c()},l:function(s){r&&r.l(s)},m:function(s,a){r&&r.m(s,a),t=!0},p:function(s,[a]){r&&r.p&&(!t||a&4)&&Ki(r,n,s,s[2],t?qi(n,s[2],a,null):Wi(s[2]),null)},i:function(s){t||(Z(r,s),t=!0)},o:function(s){J(r,s),t=!1},d:function(s){r&&r.d(s)}};return $("SvelteRegisterBlock",{block:i,id:Jr.name,type:"component",source:"",ctx:e}),i}function $u(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("RoomProvider",r,["default"]);let{id:o}=t,{initialPresence:s={}}=t;if(!o)throw new Error("RoomProvider requires an id");const a=jr(nr);if(a){const l=a.enter(o,{initialPresence:s});Qn(Xr,l),Xe(()=>{a.leave(o)})}e.$$.on_mount.push(function(){o===void 0&&!("id"in t||e.$$.bound[e.$$.props.id])&&console.warn("<RoomProvider> was created without expected prop 'id'")});const c=["id","initialPresence"];return Object.keys(t).forEach(l=>{!~c.indexOf(l)&&l.slice(0,2)!=="$$"&&l!=="slot"&&console.warn(`<RoomProvider> was created with unknown prop '${l}'`)}),e.$$set=l=>{"id"in l&&n(0,o=l.id),"initialPresence"in l&&n(1,s=l.initialPresence),"$$scope"in l&&n(2,i=l.$$scope)},e.$capture_state=()=>({clientSymbol:nr,roomSymbol:Xr,getContext:jr,onDestroy:Xe,setContext:Qn,id:o,initialPresence:s,client:a}),e.$inject_state=l=>{"id"in l&&n(0,o=l.id),"initialPresence"in l&&n(1,s=l.initialPresence)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o,s,i,r]}class ta extends Tt{constructor(t){super(t),Ot(this,t,$u,Jr,Nt,{id:0,initialPresence:1}),$("SvelteRegisterComponent",{component:this,tagName:"RoomProvider",options:t,id:Jr.name})}get id(){throw new Dn("<RoomProvider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set id(t){throw new Dn("<RoomProvider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get initialPresence(){throw new Dn("<RoomProvider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set initialPresence(t){throw new Dn("<RoomProvider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Un="src/lib/ContentWarningModal.svelte";function Qr(e){let t,n,r,i,o,s,a,c,l;const u={c:function(){t=H("form"),n=H("div"),r=H("h3"),i=et(`Since the project is an open interactive art canvas, you may encounter some disturbing and\r
			potentially NSFW content in the rooms.`),o=st(),s=H("button"),a=et("OK"),this.h()},l:function(f){t=F(f,"FORM",{class:!0});var _=O(t);n=F(_,"DIV",{class:!0});var p=O(n);r=F(p,"H3",{class:!0});var g=O(r);i=nt(g,`Since the project is an open interactive art canvas, you may encounter some disturbing and\r
			potentially NSFW content in the rooms.`),g.forEach(E),o=at(p),s=F(p,"BUTTON",{class:!0,title:!0});var y=O(s);a=nt(y,"OK"),y.forEach(E),p.forEach(E),_.forEach(E),this.h()},h:function(){d(r,"class","font-semibold text-black text-base 2xl:text-2xl spacing tracking-wide hover:saturate-150 mb-3"),T(r,Un,14,2,437),d(s,"class","font-semibold bg-blue-700 text-white rounded-lg px-5 text-xl 2xl:text-2xl spacing tracking-wide hover:saturate-150"),d(s,"title","Input prompt to generate image and  negative prompt inside brackets <NEGATIVE PROMPT>"),T(s,Un,21,2,704),d(n,"class","text-center p-3 m-3 bg-white overflow-hidden rounded-2xl w-full max-w-lg 2xl:max-w-xl"),T(n,Un,11,1,328),d(t,"class","fixed w-screen top-0 left-0 bottom-0 right-0 h-screen z-50 flex items-center justify-center bg-black bg-opacity-80"),T(t,Un,8,0,192)},m:function(f,_){rt(f,t,_),C(t,n),C(n,r),C(r,i),C(n,o),C(n,s),C(s,a),e[2](s),c||(l=$t(s,"click",e[3],!1,!1,!1,!1),c=!0)},p:mt,i:mt,o:mt,d:function(f){f&&E(t),e[2](null),c=!1,l()}};return $("SvelteRegisterBlock",{block:u,id:Qr.name,type:"component",source:"",ctx:e}),u}function Yu(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("ContentWarningModal",r,[]);const o=Ee();let s;Yt(()=>{s.focus()});const a=[];Object.keys(t).forEach(u=>{!~a.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<ContentWarningModal> was created with unknown prop '${u}'`)});function c(u){Se[u?"unshift":"push"](()=>{s=u,n(0,s)})}const l=()=>{o("contentModal")};return e.$capture_state=()=>({createEventDispatcher:Ee,onMount:Yt,dispatch:o,okButton:s}),e.$inject_state=u=>{"okButton"in u&&n(0,s=u.okButton)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[s,o,c,l]}class ea extends Tt{constructor(t){super(t),Ot(this,t,Yu,Qr,Nt,{}),$("SvelteRegisterComponent",{component:this,tagName:"ContentWarningModal",options:t,id:Qr.name})}}const Pr="src/lib/Icons/Cursor.svelte";function ti(e){let t,n,r;const i={c:function(){t=it("svg"),n=it("path"),r=it("path"),this.h()},l:function(s){t=ot(s,"svg",{class:!0,width:!0,height:!0,viewBox:!0,xmlns:!0});var a=O(t);n=ot(a,"path",{d:!0,fill:!0}),O(n).forEach(E),r=ot(a,"path",{"fill-rule":!0,"clip-rule":!0,d:!0,fill:!0,"fill-opacity":!0}),O(r).forEach(E),a.forEach(E),this.h()},h:function(){d(n,"d","M3.09022 1.77278C2.25499 1.40456 1.40358 2.25597 1.7718 3.0912L4.57875 9.45818C4.95365 10.3086 6.18455 10.2323 6.4516 9.34213L6.9637 7.63515C7.06029 7.31317 7.31219 7.06126 7.63417 6.96467L9.34117 6.45258C10.2313 6.18552 10.3076 4.95463 9.45722 4.57972L3.09022 1.77278Z"),d(n,"fill",e[1]),T(n,Pr,11,1,200),d(r,"fill-rule","evenodd"),d(r,"clip-rule","evenodd"),d(r,"d","M3.66305 9.86091L0.856101 3.49392C0.119663 1.82347 1.82248 0.120639 3.49294 0.857077L9.85994 3.66402C11.5607 4.41383 11.4082 6.87562 9.62784 7.40973L7.92085 7.92182L7.40875 9.62881C6.87465 11.4092 4.41286 11.5617 3.66305 9.86091ZM1.77113 3.09053C1.40291 2.2553 2.25432 1.40388 3.08955 1.7721L9.45654 4.57905C10.3069 4.95395 10.2307 6.18485 9.34049 6.4519L7.6335 6.964C7.31152 7.06059 7.05961 7.3125 6.96302 7.63448L6.45093 9.34146C6.18387 10.2316 4.95298 10.3079 4.57807 9.45751L1.77113 3.09053Z"),d(r,"fill","white"),d(r,"fill-opacity","0.8"),T(r,Pr,15,1,500),d(t,"class",e[0]),d(t,"width","1em"),d(t,"height","1em"),d(t,"viewBox","0 0 12 12"),d(t,"xmlns","http://www.w3.org/2000/svg"),T(t,Pr,4,0,82)},m:function(s,a){rt(s,t,a),C(t,n),C(t,r)},p:function(s,[a]){a&2&&d(n,"fill",s[1]),a&1&&d(t,"class",s[0])},i:mt,o:mt,d:function(s){s&&E(t)}};return $("SvelteRegisterBlock",{block:i,id:ti.name,type:"component",source:"",ctx:e}),i}function Zu(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("Cursor",r,[]);let{classList:o=""}=t,{fill:s=""}=t;const a=["classList","fill"];return Object.keys(t).forEach(c=>{!~a.indexOf(c)&&c.slice(0,2)!=="$$"&&c!=="slot"&&console.warn(`<Cursor> was created with unknown prop '${c}'`)}),e.$$set=c=>{"classList"in c&&n(0,o=c.classList),"fill"in c&&n(1,s=c.fill)},e.$capture_state=()=>({classList:o,fill:s}),e.$inject_state=c=>{"classList"in c&&n(0,o=c.classList),"fill"in c&&n(1,s=c.fill)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o,s]}class na extends Tt{constructor(t){super(t),Ot(this,t,Zu,ti,Nt,{classList:0,fill:1}),$("SvelteRegisterComponent",{component:this,tagName:"Cursor",options:t,id:ti.name})}get classList(){throw new Error("<Cursor>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<Cursor>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get fill(){throw new Error("<Cursor>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set fill(t){throw new Error("<Cursor>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Xu="src/lib/Cursor.svelte";function ei(e){let t,n,r,i;n=new na({props:{classList:"block z-0 col-span-2 row-span-2 text-8xl",fill:e[1]},$$inline:!0});const o={c:function(){t=H("div"),wt(n.$$.fragment),this.h()},l:function(a){t=F(a,"DIV",{class:!0,style:!0});var c=O(t);bt(n.$$.fragment,c),c.forEach(E),this.h()},h:function(){d(t,"class","cursor text-4xl s-CYMtZEZ3YyWL"),d(t,"style",r=`transform: translateX(${e[2].x}px) translateY(${e[2].y}px) scale(${e[0].k});`),T(t,Xu,10,0,258)},m:function(a,c){rt(a,t,c),kt(n,t,null),i=!0},p:function(a,[c]){const l={};c&2&&(l.fill=a[1]),n.$set(l),(!i||c&5&&r!==(r=`transform: translateX(${a[2].x}px) translateY(${a[2].y}px) scale(${a[0].k});`))&&d(t,"style",r)},i:function(a){i||(Z(n.$$.fragment,a),i=!0)},o:function(a){J(n.$$.fragment,a),i=!1},d:function(a){a&&E(t),Ct(n)}};return $("SvelteRegisterBlock",{block:o,id:ei.name,type:"component",source:"",ctx:e}),o}function Gu(e,t,n){let r,{$$slots:i={},$$scope:o}=t;Rt("Cursor",i,[]);let{transform:s}=t,{color:a=""}=t,{position:c={x:0,y:0}}=t;e.$$.on_mount.push(function(){s===void 0&&!("transform"in t||e.$$.bound[e.$$.props.transform])&&console.warn("<Cursor> was created without expected prop 'transform'")});const l=["transform","color","position"];return Object.keys(t).forEach(u=>{!~l.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<Cursor> was created with unknown prop '${u}'`)}),e.$$set=u=>{"transform"in u&&n(0,s=u.transform),"color"in u&&n(1,a=u.color),"position"in u&&n(3,c=u.position)},e.$capture_state=()=>({Cursor:na,transform:s,color:a,position:c,coord:r}),e.$inject_state=u=>{"transform"in u&&n(0,s=u.transform),"color"in u&&n(1,a=u.color),"position"in u&&n(3,c=u.position),"coord"in u&&n(2,r=u.coord)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&9&&n(2,r={x:s.applyX(c.x),y:s.applyY(c.y)})},[s,a,r,c]}class ra extends Tt{constructor(t){super(t),Ot(this,t,Gu,ei,Nt,{transform:0,color:1,position:3}),$("SvelteRegisterComponent",{component:this,tagName:"Cursor_1",options:t,id:ei.name})}get transform(){throw new Error("<Cursor>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set transform(t){throw new Error("<Cursor>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get color(){throw new Error("<Cursor>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set color(t){throw new Error("<Cursor>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get position(){throw new Error("<Cursor>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set position(t){throw new Error("<Cursor>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Ar="src/lib/Icons/LoadingIcon.svelte";function ni(e){let t,n,r;const i={c:function(){t=it("svg"),n=it("circle"),r=it("path"),this.h()},l:function(s){t=ot(s,"svg",{class:!0,xmlns:!0,"xmlns:xlink":!0,"aria-hidden":!0,fill:!0,focusable:!0,role:!0,width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var a=O(t);n=ot(a,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),O(n).forEach(E),r=ot(a,"path",{fill:!0,d:!0}),O(r).forEach(E),a.forEach(E),this.h()},h:function(){d(n,"class","opacity-50"),d(n,"cx","12"),d(n,"cy","12"),d(n,"r","10"),d(n,"stroke","currentColor"),d(n,"stroke-width","4"),T(n,Ar,16,1,328),d(r,"fill","currentColor"),d(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),T(r,Ar,17,1,422),d(t,"class",e[0]),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),d(t,"aria-hidden","true"),d(t,"fill","none"),d(t,"focusable","false"),d(t,"role","img"),d(t,"width","1em"),d(t,"height","1em"),d(t,"preserveAspectRatio","xMidYMid meet"),d(t,"viewBox","0 0 24 24"),T(t,Ar,3,0,59)},m:function(s,a){rt(s,t,a),C(t,n),C(t,r)},p:function(s,[a]){a&1&&d(t,"class",s[0])},i:mt,o:mt,d:function(s){s&&E(t)}};return $("SvelteRegisterBlock",{block:i,id:ni.name,type:"component",source:"",ctx:e}),i}function Ju(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("LoadingIcon",r,[]);let{classList:o=""}=t;const s=["classList"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<LoadingIcon> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classList"in a&&n(0,o=a.classList)},e.$capture_state=()=>({classList:o}),e.$inject_state=a=>{"classList"in a&&n(0,o=a.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class Ae extends Tt{constructor(t){super(t),Ot(this,t,Ju,ni,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"LoadingIcon",options:t,id:ni.name})}get classList(){throw new Error("<LoadingIcon>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<LoadingIcon>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ln=["#505669","#414AA6","#1C5B92","#216B44","#893301","#912728","#98184D","#743095","#5F4199","#8f3f94"],Ce=50,Bt=32,dt=512;var ht=(e=>(e.ready="ready",e.loading="loading",e.prompting="prompting",e.processing="processing",e.dragging="dragging",e.masking="masking",e))(ht||{});const De="src/lib/Frame.svelte";function ia(e){let t,n;const r={c:function(){t=H("p"),n=et("Someone is typing:"),this.h()},l:function(o){t=F(o,"P",{class:!0});var s=O(t);n=nt(s,"Someone is typing:"),s.forEach(E),this.h()},h:function(){d(t,"class","text-4xl"),T(t,De,27,4,1142)},m:function(o,s){rt(o,t,s),C(t,n)},i:mt,o:mt,d:function(o){o&&E(t)}};return $("SvelteRegisterBlock",{block:r,id:ia.name,type:"if",source:"(27:41) ",ctx:e}),r}function oa(e){let t,n;const r={c:function(){t=H("p"),n=et("Someone is masking"),this.h()},l:function(o){t=F(o,"P",{class:!0});var s=O(t);n=nt(s,"Someone is masking"),s.forEach(E),this.h()},h:function(){d(t,"class","text-4xl"),T(t,De,25,4,1051)},m:function(o,s){rt(o,t,s),C(t,n)},i:mt,o:mt,d:function(o){o&&E(t)}};return $("SvelteRegisterBlock",{block:r,id:oa.name,type:"if",source:"(25:39) ",ctx:e}),r}function sa(e){let t,n,r,i,o;t=new Ae({props:{classList:"animate-spin text-4xl inline mr-2 mx-auto text-white mb-4"},$$inline:!0});const s={c:function(){wt(t.$$.fragment),n=st(),r=H("p"),i=et("Someone is painting:"),this.h()},l:function(c){bt(t.$$.fragment,c),n=at(c),r=F(c,"P",{class:!0});var l=O(r);i=nt(l,"Someone is painting:"),l.forEach(E),this.h()},h:function(){d(r,"class","text-4xl"),T(r,De,23,4,960)},m:function(c,l){kt(t,c,l),rt(c,n,l),rt(c,r,l),C(r,i),o=!0},i:function(c){o||(Z(t.$$.fragment,c),o=!0)},o:function(c){J(t.$$.fragment,c),o=!1},d:function(c){Ct(t,c),c&&E(n),c&&E(r)}};return $("SvelteRegisterBlock",{block:s,id:sa.name,type:"if",source:"(22:3) {#if status === Status.loading || status === Status.processing}",ctx:e}),s}function ri(e){let t,n,r,i;const o={c:function(){t=H("span"),n=et('"'),r=et(e[1]),i=et('"'),this.h()},l:function(a){t=F(a,"SPAN",{class:!0});var c=O(t);n=nt(c,'"'),r=nt(c,e[1]),i=nt(c,'"'),c.forEach(E),this.h()},h:function(){d(t,"class","italic font-normal line-clamp-4"),T(t,De,30,4,1217)},m:function(a,c){rt(a,t,c),C(t,n),C(t,r),C(t,i)},p:function(a,c){c&2&&ye(r,a[1])},d:function(a){a&&E(t)}};return $("SvelteRegisterBlock",{block:o,id:ri.name,type:"if",source:"(30:3) {#if prompt}",ctx:e}),o}function ii(e){let t,n,r,i,o,s,a,c;const l=[sa,oa,ia],u=[];function h(p,g){return p[2]===ht.loading||p[2]===ht.processing?0:p[2]===ht.masking?1:p[2]===ht.prompting?2:-1}~(i=h(e))&&(o=u[i]=l[i](e));let f=e[1]&&ri(e);const _={c:function(){t=H("div"),n=H("div"),r=H("div"),o&&o.c(),s=st(),f&&f.c(),this.h()},l:function(g){t=F(g,"DIV",{class:!0,style:!0});var y=O(t);n=F(y,"DIV",{class:!0});var k=O(n);r=F(k,"DIV",{class:!0});var w=O(r);o&&o.l(w),s=at(w),f&&f.l(w),w.forEach(E),k.forEach(E),y.forEach(E),this.h()},h:function(){d(r,"class","font-bold !text-4xl text-white rounded-2xl text-center p-10"),T(r,De,20,2,720),d(n,"class","pointer-events-none touch-none"),T(n,De,19,1,672),d(t,"class","absolute top-0 left-0 border-8 border-dashed border-black flex items-center justify-center bg-black/60"),d(t,"style",a=`width: ${dt}px;
			height: ${dt}px;
			transform: translateX(${e[3].x}px) translateY(${e[3].y}px) scale(${e[0].k}); transform-origin: 0 0;`),T(t,De,13,0,373)},m:function(g,y){rt(g,t,y),C(t,n),C(n,r),~i&&u[i].m(r,null),C(r,s),f&&f.m(r,null),c=!0},p:function(g,[y]){let k=i;i=h(g),i!==k&&(o&&(zt(),J(u[k],1,1,()=>{u[k]=null}),Ht()),~i?(o=u[i],o||(o=u[i]=l[i](g),o.c()),Z(o,1),o.m(r,s)):o=null),g[1]?f?f.p(g,y):(f=ri(g),f.c(),f.m(r,null)):f&&(f.d(1),f=null),(!c||y&9&&a!==(a=`width: ${dt}px;
			height: ${dt}px;
			transform: translateX(${g[3].x}px) translateY(${g[3].y}px) scale(${g[0].k}); transform-origin: 0 0;`))&&d(t,"style",a)},i:function(g){c||(Z(o),c=!0)},o:function(g){J(o),c=!1},d:function(g){g&&E(t),~i&&u[i].d(),f&&f.d()}};return $("SvelteRegisterBlock",{block:_,id:ii.name,type:"component",source:"",ctx:e}),_}function Qu(e,t,n){let r,{$$slots:i={},$$scope:o}=t;Rt("Frame",i,[]);let{transform:s}=t,{position:a={x:0,y:0}}=t,{prompt:c=""}=t,{status:l}=t;e.$$.on_mount.push(function(){s===void 0&&!("transform"in t||e.$$.bound[e.$$.props.transform])&&console.warn("<Frame> was created without expected prop 'transform'"),l===void 0&&!("status"in t||e.$$.bound[e.$$.props.status])&&console.warn("<Frame> was created without expected prop 'status'")});const u=["transform","position","prompt","status"];return Object.keys(t).forEach(h=>{!~u.indexOf(h)&&h.slice(0,2)!=="$$"&&h!=="slot"&&console.warn(`<Frame> was created with unknown prop '${h}'`)}),e.$$set=h=>{"transform"in h&&n(0,s=h.transform),"position"in h&&n(4,a=h.position),"prompt"in h&&n(1,c=h.prompt),"status"in h&&n(2,l=h.status)},e.$capture_state=()=>({LoadingIcon:Ae,FRAME_SIZE:dt,Status:ht,transform:s,position:a,prompt:c,status:l,coord:r}),e.$inject_state=h=>{"transform"in h&&n(0,s=h.transform),"position"in h&&n(4,a=h.position),"prompt"in h&&n(1,c=h.prompt),"status"in h&&n(2,l=h.status),"coord"in h&&n(3,r=h.coord)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&17&&n(3,r={x:s.applyX(a.x),y:s.applyY(a.y)})},[s,c,l,r,a]}class aa extends Tt{constructor(t){super(t),Ot(this,t,Qu,ii,Nt,{transform:0,position:4,prompt:1,status:2}),$("SvelteRegisterComponent",{component:this,tagName:"Frame",options:t,id:ii.name})}get transform(){throw new Error("<Frame>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set transform(t){throw new Error("<Frame>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get position(){throw new Error("<Frame>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set position(t){throw new Error("<Frame>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get prompt(){throw new Error("<Frame>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set prompt(t){throw new Error("<Frame>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get status(){throw new Error("<Frame>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set status(t){throw new Error("<Frame>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}var tf={value:()=>{}};function gr(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Yn(n)}function Yn(e){this._=e}function ef(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Yn.prototype=gr.prototype={constructor:Yn,on:function(e,t){var n=this._,r=ef(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=nf(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=Fo(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Fo(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Yn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function nf(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Fo(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=tf,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var oi="http://www.w3.org/1999/xhtml";const Ko={svg:"http://www.w3.org/2000/svg",xhtml:oi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _r(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ko.hasOwnProperty(t)?{space:Ko[t],local:e}:e}function rf(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===oi&&t.documentElement.namespaceURI===oi?t.createElement(e):t.createElementNS(n,e)}}function of(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ca(e){var t=_r(e);return(t.local?of:rf)(t)}function sf(){}function ro(e){return e==null?sf:function(){return this.querySelector(e)}}function af(e){typeof e!="function"&&(e=ro(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=new Array(s),c,l,u=0;u<s;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new Zt(r,this._parents)}function cf(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function lf(){return[]}function la(e){return e==null?lf:function(){return this.querySelectorAll(e)}}function uf(e){return function(){return cf(e.apply(this,arguments))}}function ff(e){typeof e=="function"?e=uf(e):e=la(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s=t[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(r.push(e.call(c,c.__data__,l,s)),i.push(c));return new Zt(r,i)}function ua(e){return function(){return this.matches(e)}}function fa(e){return function(t){return t.matches(e)}}var df=Array.prototype.find;function hf(e){return function(){return df.call(this.children,e)}}function pf(){return this.firstElementChild}function mf(e){return this.select(e==null?pf:hf(typeof e=="function"?e:fa(e)))}var gf=Array.prototype.filter;function _f(){return Array.from(this.children)}function yf(e){return function(){return gf.call(this.children,e)}}function vf(e){return this.selectAll(e==null?_f:yf(typeof e=="function"?e:fa(e)))}function wf(e){typeof e!="function"&&(e=ua(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new Zt(r,this._parents)}function da(e){return new Array(e.length)}function bf(){return new Zt(this._enter||this._groups.map(da),this._parents)}function rr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rr.prototype={constructor:rr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function kf(e){return function(){return e}}function Cf(e,t,n,r,i,o){for(var s=0,a,c=t.length,l=o.length;s<l;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new rr(e,o[s]);for(;s<c;++s)(a=t[s])&&(i[s]=a)}function Ef(e,t,n,r,i,o,s){var a,c,l=new Map,u=t.length,h=o.length,f=new Array(u),_;for(a=0;a<u;++a)(c=t[a])&&(f[a]=_=s.call(c,c.__data__,a,t)+"",l.has(_)?i[a]=c:l.set(_,c));for(a=0;a<h;++a)_=s.call(e,o[a],a,o)+"",(c=l.get(_))?(r[a]=c,c.__data__=o[a],l.delete(_)):n[a]=new rr(e,o[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(i[a]=c)}function Sf(e){return e.__data__}function xf(e,t){if(!arguments.length)return Array.from(this,Sf);var n=t?Ef:Cf,r=this._parents,i=this._groups;typeof e!="function"&&(e=kf(e));for(var o=i.length,s=new Array(o),a=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],h=i[l],f=h.length,_=If(e.call(u,u&&u.__data__,l,r)),p=_.length,g=a[l]=new Array(p),y=s[l]=new Array(p),k=c[l]=new Array(f);n(u,h,g,y,k,_,t);for(var w=0,m=0,b,P;w<p;++w)if(b=g[w]){for(w>=m&&(m=w+1);!(P=y[m])&&++m<p;);b._next=P||null}}return s=new Zt(s,r),s._enter=a,s._exit=c,s}function If(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Pf(){return new Zt(this._exit||this._groups.map(da),this._parents)}function Af(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Lf(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),c=0;c<s;++c)for(var l=n[c],u=r[c],h=l.length,f=a[c]=new Array(h),_,p=0;p<h;++p)(_=l[p]||u[p])&&(f[p]=_);for(;c<i;++c)a[c]=n[c];return new Zt(a,this._parents)}function Tf(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Of(e){e||(e=Nf);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,c=i[o]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new Zt(i,this._parents).order()}function Nf(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Rf(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Mf(){return Array.from(this)}function Df(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function Uf(){let e=0;for(const t of this)++e;return e}function jf(){return!this.node()}function Bf(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function Vf(e){return function(){this.removeAttribute(e)}}function zf(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Hf(e,t){return function(){this.setAttribute(e,t)}}function Ff(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Kf(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Wf(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function qf(e,t){var n=_r(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?zf:Vf:typeof t=="function"?n.local?Wf:Kf:n.local?Ff:Hf)(n,t))}function ha(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $f(e){return function(){this.style.removeProperty(e)}}function Yf(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Zf(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Xf(e,t,n){return arguments.length>1?this.each((t==null?$f:typeof t=="function"?Zf:Yf)(e,t,n==null?"":n)):Ge(this.node(),e)}function Ge(e,t){return e.style.getPropertyValue(t)||ha(e).getComputedStyle(e,null).getPropertyValue(t)}function Gf(e){return function(){delete this[e]}}function Jf(e,t){return function(){this[e]=t}}function Qf(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function td(e,t){return arguments.length>1?this.each((t==null?Gf:typeof t=="function"?Qf:Jf)(e,t)):this.node()[e]}function pa(e){return e.trim().split(/^|\s+/)}function io(e){return e.classList||new ma(e)}function ma(e){this._node=e,this._names=pa(e.getAttribute("class")||"")}ma.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ga(e,t){for(var n=io(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function _a(e,t){for(var n=io(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function ed(e){return function(){ga(this,e)}}function nd(e){return function(){_a(this,e)}}function rd(e,t){return function(){(t.apply(this,arguments)?ga:_a)(this,e)}}function id(e,t){var n=pa(e+"");if(arguments.length<2){for(var r=io(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?rd:t?ed:nd)(n,t))}function od(){this.textContent=""}function sd(e){return function(){this.textContent=e}}function ad(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function cd(e){return arguments.length?this.each(e==null?od:(typeof e=="function"?ad:sd)(e)):this.node().textContent}function ld(){this.innerHTML=""}function ud(e){return function(){this.innerHTML=e}}function fd(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function dd(e){return arguments.length?this.each(e==null?ld:(typeof e=="function"?fd:ud)(e)):this.node().innerHTML}function hd(){this.nextSibling&&this.parentNode.appendChild(this)}function pd(){return this.each(hd)}function md(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gd(){return this.each(md)}function _d(e){var t=typeof e=="function"?e:ca(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function yd(){return null}function vd(e,t){var n=typeof e=="function"?e:ca(e),r=t==null?yd:typeof t=="function"?t:ro(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function wd(){var e=this.parentNode;e&&e.removeChild(this)}function bd(){return this.each(wd)}function kd(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cd(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ed(e){return this.select(e?Cd:kd)}function Sd(e){return arguments.length?this.property("__data__",e):this.node().__data__}function xd(e){return function(t){e.call(this,t,this.__data__)}}function Id(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Pd(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Ad(e,t,n){return function(){var r=this.__on,i,o=xd(t);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Ld(e,t,n){var r=Id(e+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(i=0,u=a[c];i<o;++i)if((s=r[i]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Ad:Pd,i=0;i<o;++i)this.each(a(r[i],t,n));return this}function ya(e,t,n){var r=ha(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Td(e,t){return function(){return ya(this,e,t)}}function Od(e,t){return function(){return ya(this,e,t.apply(this,arguments))}}function Nd(e,t){return this.each((typeof t=="function"?Od:Td)(e,t))}function*Rd(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var va=[null];function Zt(e,t){this._groups=e,this._parents=t}function bn(){return new Zt([[document.documentElement]],va)}function Md(){return this}Zt.prototype=bn.prototype={constructor:Zt,select:af,selectAll:ff,selectChild:mf,selectChildren:vf,filter:wf,data:xf,enter:bf,exit:Pf,join:Af,merge:Lf,selection:Md,order:Tf,sort:Of,call:Rf,nodes:Mf,node:Df,size:Uf,empty:jf,each:Bf,attr:qf,style:Xf,property:td,classed:id,text:cd,html:dd,raise:pd,lower:gd,append:_d,insert:vd,remove:bd,clone:Ed,datum:Sd,on:Ld,dispatch:Nd,[Symbol.iterator]:Rd};function Wt(e){return typeof e=="string"?new Zt([[document.querySelector(e)]],[document.documentElement]):new Zt([[e]],va)}function Dd(e){let t;for(;t=e.sourceEvent;)e=t;return e}function me(e,t){if(e=Dd(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ud={passive:!1},mn={capture:!0,passive:!1};function Lr(e){e.stopImmediatePropagation()}function Ye(e){e.preventDefault(),e.stopImmediatePropagation()}function wa(e){var t=e.document.documentElement,n=Wt(e).on("dragstart.drag",Ye,mn);"onselectstart"in t?n.on("selectstart.drag",Ye,mn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ba(e,t){var n=e.document.documentElement,r=Wt(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ye,mn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const jn=e=>()=>e;function si(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}si.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function jd(e){return!e.ctrlKey&&!e.button}function Bd(){return this.parentNode}function Vd(e,t){return t==null?{x:e.x,y:e.y}:t}function zd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tr(){var e=jd,t=Bd,n=Vd,r=zd,i={},o=gr("start","drag","end"),s=0,a,c,l,u,h=0;function f(b){b.on("mousedown.drag",_).filter(r).on("touchstart.drag",y).on("touchmove.drag",k,Ud).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(b,P){if(!(u||!e.call(this,b,P))){var N=m(this,t.call(this,b,P),b,P,"mouse");!N||(Wt(b.view).on("mousemove.drag",p,mn).on("mouseup.drag",g,mn),wa(b.view),Lr(b),l=!1,a=b.clientX,c=b.clientY,N("start",b))}}function p(b){if(Ye(b),!l){var P=b.clientX-a,N=b.clientY-c;l=P*P+N*N>h}i.mouse("drag",b)}function g(b){Wt(b.view).on("mousemove.drag mouseup.drag",null),ba(b.view,l),Ye(b),i.mouse("end",b)}function y(b,P){if(!!e.call(this,b,P)){var N=b.changedTouches,A=t.call(this,b,P),L=N.length,j,U;for(j=0;j<L;++j)(U=m(this,A,b,P,N[j].identifier,N[j]))&&(Lr(b),U("start",b,N[j]))}}function k(b){var P=b.changedTouches,N=P.length,A,L;for(A=0;A<N;++A)(L=i[P[A].identifier])&&(Ye(b),L("drag",b,P[A]))}function w(b){var P=b.changedTouches,N=P.length,A,L;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),A=0;A<N;++A)(L=i[P[A].identifier])&&(Lr(b),L("end",b,P[A]))}function m(b,P,N,A,L,j){var U=o.copy(),W=me(j||N,P),R,G,v;if((v=n.call(b,new si("beforestart",{sourceEvent:N,target:f,identifier:L,active:s,x:W[0],y:W[1],dx:0,dy:0,dispatch:U}),A))!=null)return R=v.x-W[0]||0,G=v.y-W[1]||0,function I(S,z,K){var q=W,V;switch(S){case"start":i[L]=I,V=s++;break;case"end":delete i[L],--s;case"drag":W=me(K||z,P),V=s;break}U.call(S,b,new si(S,{sourceEvent:z,subject:v,target:f,identifier:L,active:V,x:W[0]+R,y:W[1]+G,dx:W[0]-q[0],dy:W[1]-q[1],dispatch:U}),A)}}return f.filter=function(b){return arguments.length?(e=typeof b=="function"?b:jn(!!b),f):e},f.container=function(b){return arguments.length?(t=typeof b=="function"?b:jn(b),f):t},f.subject=function(b){return arguments.length?(n=typeof b=="function"?b:jn(b),f):n},f.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:jn(!!b),f):r},f.on=function(){var b=o.on.apply(o,arguments);return b===o?f:b},f.clickDistance=function(b){return arguments.length?(h=(b=+b)*b,f):Math.sqrt(h)},f}const Wo="ws://0.0.0.0:7860/gradio/queue/join",qo="https://d26smi9133w0oo.cloudfront.net",dn="/server/api";async function $o(e,t){const n=Hd(t.prompt),r=`${t.position.x}_${t.position.y}`,i=`sd-${t.room}-${t.id}-${n}-${r}.jpeg`,o=new File([e],i,{type:"image/jpeg"}),s=new FormData;s.append("file",o);const a=await fetch(dn+"/uploadfile",{method:"POST",body:s});if(a.status===200)return await a.json();throw new Error("Failed to upload image")}function nn(e,t){const n=t.width-dt,r=e%Bt<Bt/2?e-e%Bt:e+Bt-e%Bt;return Math.max(0,Math.min(Math.round(r),n))}function Hd(e){return e?e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""}function yr(){const e=jr(Xr);if(!e)throw new Error("Use RoomProvider as parent with id prop");return e}function Pe(e={}){const t=yr(),{subscribe:n,set:r}=Xt();function i(s,a){t.updatePresence(s,{...e,...a})}const o=t.subscribe("my-presence",s=>{r(s)});return Xe(()=>{o()}),{subscribe:n,update:i}}function Yo(){const e=yr(),t=Xt(),n=e.subscribe("others",r=>{t.set(r)});return Xe(n),t}function Fd(){const e=yr(),t=Xt();async function n(){const{root:r}=await e.getStorage();t.set(r)}return n(),t}function ir(e,t){const n=yr(),r=Fd(),i=Xt();let o=()=>{};const s=r.subscribe(a=>{!a||(a.get(e)||a.set(e,new Gt(t)),i.set(a.get(e)),o(),o=n.subscribe(a.get(e),c=>{i.set(c)}))});return Xe(s),i}const Kd=1e4;function Zo(){const e=Xt([]),t=setInterval(()=>{Xo().then(n=>e.set(n))},Kd);return Xo().then(n=>e.set(n)),Xe(()=>{clearInterval(t)}),e}async function Xo(){return fetch(dn+"/rooms").then(e=>e.json())}function oo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ka(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function kn(){}var gn=.7,or=1/gn,Ze="\\s*([+-]?\\d+)\\s*",_n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ue="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wd=/^#([0-9a-f]{3,8})$/,qd=new RegExp(`^rgb\\(${Ze},${Ze},${Ze}\\)$`),$d=new RegExp(`^rgb\\(${ue},${ue},${ue}\\)$`),Yd=new RegExp(`^rgba\\(${Ze},${Ze},${Ze},${_n}\\)$`),Zd=new RegExp(`^rgba\\(${ue},${ue},${ue},${_n}\\)$`),Xd=new RegExp(`^hsl\\(${_n},${ue},${ue}\\)$`),Gd=new RegExp(`^hsla\\(${_n},${ue},${ue},${_n}\\)$`),Go={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};oo(kn,yn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Jo,formatHex:Jo,formatHex8:Jd,formatHsl:Qd,formatRgb:Qo,toString:Qo});function Jo(){return this.rgb().formatHex()}function Jd(){return this.rgb().formatHex8()}function Qd(){return Ca(this).formatHsl()}function Qo(){return this.rgb().formatRgb()}function yn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wd.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ts(t):n===3?new qt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Bn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Bn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qd.exec(e))?new qt(t[1],t[2],t[3],1):(t=$d.exec(e))?new qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yd.exec(e))?Bn(t[1],t[2],t[3],t[4]):(t=Zd.exec(e))?Bn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Xd.exec(e))?rs(t[1],t[2]/100,t[3]/100,1):(t=Gd.exec(e))?rs(t[1],t[2]/100,t[3]/100,t[4]):Go.hasOwnProperty(e)?ts(Go[e]):e==="transparent"?new qt(NaN,NaN,NaN,0):null}function ts(e){return new qt(e>>16&255,e>>8&255,e&255,1)}function Bn(e,t,n,r){return r<=0&&(e=t=n=NaN),new qt(e,t,n,r)}function th(e){return e instanceof kn||(e=yn(e)),e?(e=e.rgb(),new qt(e.r,e.g,e.b,e.opacity)):new qt}function ai(e,t,n,r){return arguments.length===1?th(e):new qt(e,t,n,r==null?1:r)}function qt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}oo(qt,ai,ka(kn,{brighter(e){return e=e==null?or:Math.pow(or,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gn:Math.pow(gn,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new qt(Ue(this.r),Ue(this.g),Ue(this.b),sr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:es,formatHex:es,formatHex8:eh,formatRgb:ns,toString:ns}));function es(){return`#${Te(this.r)}${Te(this.g)}${Te(this.b)}`}function eh(){return`#${Te(this.r)}${Te(this.g)}${Te(this.b)}${Te((isNaN(this.opacity)?1:this.opacity)*255)}`}function ns(){const e=sr(this.opacity);return`${e===1?"rgb(":"rgba("}${Ue(this.r)}, ${Ue(this.g)}, ${Ue(this.b)}${e===1?")":`, ${e})`}`}function sr(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ue(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Te(e){return e=Ue(e),(e<16?"0":"")+e.toString(16)}function rs(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Jt(e,t,n,r)}function Ca(e){if(e instanceof Jt)return new Jt(e.h,e.s,e.l,e.opacity);if(e instanceof kn||(e=yn(e)),!e)return new Jt;if(e instanceof Jt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,c=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?o+i:2-o-i,s*=60):a=c>0&&c<1?0:s,new Jt(s,a,c,e.opacity)}function nh(e,t,n,r){return arguments.length===1?Ca(e):new Jt(e,t,n,r==null?1:r)}function Jt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}oo(Jt,nh,ka(kn,{brighter(e){return e=e==null?or:Math.pow(or,e),new Jt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gn:Math.pow(gn,e),new Jt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new qt(Or(e>=240?e-240:e+120,i,r),Or(e,i,r),Or(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Jt(is(this.h),Vn(this.s),Vn(this.l),sr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sr(this.opacity);return`${e===1?"hsl(":"hsla("}${is(this.h)}, ${Vn(this.s)*100}%, ${Vn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function is(e){return e=(e||0)%360,e<0?e+360:e}function Vn(e){return Math.max(0,Math.min(1,e||0))}function Or(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ea=e=>()=>e;function rh(e,t){return function(n){return e+n*t}}function ih(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function oh(e){return(e=+e)==1?Sa:function(t,n){return n-t?ih(t,n,e):Ea(isNaN(t)?n:t)}}function Sa(e,t){var n=t-e;return n?rh(e,n):Ea(isNaN(e)?t:e)}const os=function e(t){var n=oh(t);function r(i,o){var s=n((i=ai(i)).r,(o=ai(o)).r),a=n(i.g,o.g),c=n(i.b,o.b),l=Sa(i.opacity,o.opacity);return function(u){return i.r=s(u),i.g=a(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=e,r}(1);function be(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ci=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nr=new RegExp(ci.source,"g");function sh(e){return function(){return e}}function ah(e){return function(t){return e(t)+""}}function ch(e,t){var n=ci.lastIndex=Nr.lastIndex=0,r,i,o,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=ci.exec(e))&&(i=Nr.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,c.push({i:s,x:be(r,i)})),n=Nr.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?ah(c[0].x):sh(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}var ss=180/Math.PI,li={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xa(e,t,n,r,i,o){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*ss,skewX:Math.atan(c)*ss,scaleX:s,scaleY:a}}var zn;function lh(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?li:xa(t.a,t.b,t.c,t.d,t.e,t.f)}function uh(e){return e==null||(zn||(zn=document.createElementNS("http://www.w3.org/2000/svg","g")),zn.setAttribute("transform",e),!(e=zn.transform.baseVal.consolidate()))?li:(e=e.matrix,xa(e.a,e.b,e.c,e.d,e.e,e.f))}function Ia(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,u,h,f,_,p){if(l!==h||u!==f){var g=_.push("translate(",null,t,null,n);p.push({i:g-4,x:be(l,h)},{i:g-2,x:be(u,f)})}else(h||f)&&_.push("translate("+h+t+f+n)}function s(l,u,h,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:be(l,u)})):u&&h.push(i(h)+"rotate("+u+r)}function a(l,u,h,f){l!==u?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:be(l,u)}):u&&h.push(i(h)+"skewX("+u+r)}function c(l,u,h,f,_,p){if(l!==h||u!==f){var g=_.push(i(_)+"scale(",null,",",null,")");p.push({i:g-4,x:be(l,h)},{i:g-2,x:be(u,f)})}else(h!==1||f!==1)&&_.push(i(_)+"scale("+h+","+f+")")}return function(l,u){var h=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,h,f),s(l.rotate,u.rotate,h,f),a(l.skewX,u.skewX,h,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,f),l=u=null,function(_){for(var p=-1,g=f.length,y;++p<g;)h[(y=f[p]).i]=y.x(_);return h.join("")}}}var fh=Ia(lh,"px, ","px)","deg)"),dh=Ia(uh,", ",")",")"),hh=1e-12;function as(e){return((e=Math.exp(e))+1/e)/2}function ph(e){return((e=Math.exp(e))-1/e)/2}function mh(e){return((e=Math.exp(2*e))-1)/(e+1)}const gh=function e(t,n,r){function i(o,s){var a=o[0],c=o[1],l=o[2],u=s[0],h=s[1],f=s[2],_=u-a,p=h-c,g=_*_+p*p,y,k;if(g<hh)k=Math.log(f/l)/t,y=function(A){return[a+A*_,c+A*p,l*Math.exp(t*A*k)]};else{var w=Math.sqrt(g),m=(f*f-l*l+r*g)/(2*l*n*w),b=(f*f-l*l-r*g)/(2*f*n*w),P=Math.log(Math.sqrt(m*m+1)-m),N=Math.log(Math.sqrt(b*b+1)-b);k=(N-P)/t,y=function(A){var L=A*k,j=as(P),U=l/(n*w)*(j*mh(t*L+P)-ph(P));return[a+U*_,c+U*p,l*j/as(t*L+P)]}}return y.duration=k*1e3*t/Math.SQRT2,y}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return e(s,a,c)},i}(Math.SQRT2,2,4);var Je=0,un=0,rn=0,Pa=1e3,ar,fn,cr=0,je=0,vr=0,vn=typeof performance=="object"&&performance.now?performance:Date,Aa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function so(){return je||(Aa(_h),je=vn.now()+vr)}function _h(){je=0}function lr(){this._call=this._time=this._next=null}lr.prototype=La.prototype={constructor:lr,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?so():+n)+(t==null?0:+t),!this._next&&fn!==this&&(fn?fn._next=this:ar=this,fn=this),this._call=e,this._time=n,ui()},stop:function(){this._call&&(this._call=null,this._time=1/0,ui())}};function La(e,t,n){var r=new lr;return r.restart(e,t,n),r}function yh(){so(),++Je;for(var e=ar,t;e;)(t=je-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Je}function cs(){je=(cr=vn.now())+vr,Je=un=0;try{yh()}finally{Je=0,wh(),je=0}}function vh(){var e=vn.now(),t=e-cr;t>Pa&&(vr-=t,cr=e)}function wh(){for(var e,t=ar,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ar=n);fn=e,ui(r)}function ui(e){if(!Je){un&&(un=clearTimeout(un));var t=e-je;t>24?(e<1/0&&(un=setTimeout(cs,e-vn.now()-vr)),rn&&(rn=clearInterval(rn))):(rn||(cr=vn.now(),rn=setInterval(vh,Pa)),Je=1,Aa(cs))}}function ls(e,t,n){var r=new lr;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var bh=gr("start","end","cancel","interrupt"),kh=[],Ta=0,us=1,fi=2,Zn=3,fs=4,di=5,Xn=6;function wr(e,t,n,r,i,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Ch(e,n,{name:t,index:r,group:i,on:bh,tween:kh,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Ta})}function ao(e,t){var n=ie(e,t);if(n.state>Ta)throw new Error("too late; already scheduled");return n}function fe(e,t){var n=ie(e,t);if(n.state>Zn)throw new Error("too late; already running");return n}function ie(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ch(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=La(o,0,n.time);function o(l){n.state=us,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,h,f,_;if(n.state!==us)return c();for(u in r)if(_=r[u],_.name===n.name){if(_.state===Zn)return ls(s);_.state===fs?(_.state=Xn,_.timer.stop(),_.on.call("interrupt",e,e.__data__,_.index,_.group),delete r[u]):+u<t&&(_.state=Xn,_.timer.stop(),_.on.call("cancel",e,e.__data__,_.index,_.group),delete r[u])}if(ls(function(){n.state===Zn&&(n.state=fs,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=fi,n.on.call("start",e,e.__data__,n.index,n.group),n.state===fi){for(n.state=Zn,i=new Array(f=n.tween.length),u=0,h=-1;u<f;++u)(_=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=_);i.length=h+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=di,1),h=-1,f=i.length;++h<f;)i[h].call(e,u);n.state===di&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Xn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Gn(e,t){var n=e.__transition,r,i,o=!0,s;if(!!n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){o=!1;continue}i=r.state>fi&&r.state<di,r.state=Xn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}o&&delete e.__transition}}function Eh(e){return this.each(function(){Gn(this,e)})}function Sh(e,t){var n,r;return function(){var i=fe(this,e),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function xh(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=fe(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=a;break}c===l&&i.push(a)}o.tween=i}}function Ih(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ie(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===e)return s.value;return null}return this.each((t==null?Sh:xh)(n,e,t))}function co(e,t,n){var r=e._id;return e.each(function(){var i=fe(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ie(i,r).value[t]}}function Oa(e,t){var n;return(typeof t=="number"?be:t instanceof yn?os:(n=yn(t))?(t=n,os):ch)(e,t)}function Ph(e){return function(){this.removeAttribute(e)}}function Ah(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Lh(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===r?o:o=t(r=s,n)}}function Th(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?o:o=t(r=s,n)}}function Oh(e,t,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a)))}}function Nh(e,t,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a)))}}function Rh(e,t){var n=_r(e),r=n==="transform"?dh:Oa;return this.attrTween(e,typeof t=="function"?(n.local?Nh:Oh)(n,r,co(this,"attr."+e,t)):t==null?(n.local?Ah:Ph)(n):(n.local?Th:Lh)(n,r,t))}function Mh(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Dh(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Uh(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Dh(e,o)),n}return i._value=t,i}function jh(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Mh(e,o)),n}return i._value=t,i}function Bh(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=_r(e);return this.tween(n,(r.local?Uh:jh)(r,t))}function Vh(e,t){return function(){ao(this,e).delay=+t.apply(this,arguments)}}function zh(e,t){return t=+t,function(){ao(this,e).delay=t}}function Hh(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Vh:zh)(t,e)):ie(this.node(),t).delay}function Fh(e,t){return function(){fe(this,e).duration=+t.apply(this,arguments)}}function Kh(e,t){return t=+t,function(){fe(this,e).duration=t}}function Wh(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Fh:Kh)(t,e)):ie(this.node(),t).duration}function qh(e,t){if(typeof t!="function")throw new Error;return function(){fe(this,e).ease=t}}function $h(e){var t=this._id;return arguments.length?this.each(qh(t,e)):ie(this.node(),t).ease}function Yh(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;fe(this,e).ease=n}}function Zh(e){if(typeof e!="function")throw new Error;return this.each(Yh(this._id,e))}function Xh(e){typeof e!="function"&&(e=ua(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new ve(r,this._parents,this._name,this._id)}function Gh(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var c=t[a],l=n[a],u=c.length,h=s[a]=new Array(u),f,_=0;_<u;++_)(f=c[_]||l[_])&&(h[_]=f);for(;a<r;++a)s[a]=t[a];return new ve(s,this._parents,this._name,this._id)}function Jh(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Qh(e,t,n){var r,i,o=Jh(t)?ao:fe;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}function tp(e,t){var n=this._id;return arguments.length<2?ie(this.node(),n).on.on(e):this.each(Qh(n,e,t))}function ep(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function np(){return this.on("end.remove",ep(this._id))}function rp(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ro(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],c=a.length,l=o[s]=new Array(c),u,h,f=0;f<c;++f)(u=a[f])&&(h=e.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),l[f]=h,wr(l[f],t,n,f,l,ie(u,n)));return new ve(o,this._parents,t,n)}function ip(e){var t=this._name,n=this._id;typeof e!="function"&&(e=la(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var c=r[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var f=e.call(u,u.__data__,h,c),_,p=ie(u,n),g=0,y=f.length;g<y;++g)(_=f[g])&&wr(_,t,n,g,f,p);o.push(f),s.push(u)}return new ve(o,s,t,n)}var op=bn.prototype.constructor;function sp(){return new op(this._groups,this._parents)}function ap(e,t){var n,r,i;return function(){var o=Ge(this,e),s=(this.style.removeProperty(e),Ge(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}function Na(e){return function(){this.style.removeProperty(e)}}function cp(e,t,n){var r,i=n+"",o;return function(){var s=Ge(this,e);return s===i?null:s===r?o:o=t(r=s,n)}}function lp(e,t,n){var r,i,o;return function(){var s=Ge(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Ge(this,e))),s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a))}}function up(e,t){var n,r,i,o="style."+t,s="end."+o,a;return function(){var c=fe(this,e),l=c.on,u=c.value[o]==null?a||(a=Na(t)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(s,i=u),c.on=r}}function fp(e,t,n){var r=(e+="")=="transform"?fh:Oa;return t==null?this.styleTween(e,ap(e,r)).on("end.style."+e,Na(e)):typeof t=="function"?this.styleTween(e,lp(e,r,co(this,"style."+e,t))).each(up(this._id,e)):this.styleTween(e,cp(e,r,t),n).on("end.style."+e,null)}function dp(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function hp(e,t,n){var r,i;function o(){var s=t.apply(this,arguments);return s!==i&&(r=(i=s)&&dp(e,s,n)),r}return o._value=t,o}function pp(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,hp(e,t,n==null?"":n))}function mp(e){return function(){this.textContent=e}}function gp(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function _p(e){return this.tween("text",typeof e=="function"?gp(co(this,"text",e)):mp(e==null?"":e+""))}function yp(e){return function(t){this.textContent=e.call(this,t)}}function vp(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&yp(i)),t}return r._value=e,r}function wp(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,vp(e))}function bp(){for(var e=this._name,t=this._id,n=Ra(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=ie(c,t);wr(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ve(r,this._parents,e,n)}function kp(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--i===0&&o()}};n.each(function(){var l=fe(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),i===0&&o()})}var Cp=0;function ve(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ra(){return++Cp}var he=bn.prototype;ve.prototype={constructor:ve,select:rp,selectAll:ip,selectChild:he.selectChild,selectChildren:he.selectChildren,filter:Xh,merge:Gh,selection:sp,transition:bp,call:he.call,nodes:he.nodes,node:he.node,size:he.size,empty:he.empty,each:he.each,on:tp,attr:Rh,attrTween:Bh,style:fp,styleTween:pp,text:_p,textTween:wp,remove:np,tween:Ih,delay:Hh,duration:Wh,ease:$h,easeVarying:Zh,end:kp,[Symbol.iterator]:he[Symbol.iterator]};function Ep(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Sp={time:null,delay:0,duration:250,ease:Ep};function xp(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ip(e){var t,n;e instanceof ve?(t=e._id,e=e._name):(t=Ra(),(n=Sp).time=so(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&wr(c,e,t,l,s,n||xp(c,t));return new ve(r,this._parents,e,t)}bn.prototype.interrupt=Eh;bn.prototype.transition=Ip;const Hn=e=>()=>e;function Pp(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ge(e,t,n){this.k=e,this.x=t,this.y=n}ge.prototype={constructor:ge,scale:function(e){return e===1?this:new ge(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ge(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wn=new ge(1,0,0);ge.prototype;function Rr(e){e.stopImmediatePropagation()}function on(e){e.preventDefault(),e.stopImmediatePropagation()}function Ap(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lp(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ds(){return this.__zoom||wn}function Tp(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Op(){return navigator.maxTouchPoints||"ontouchstart"in this}function Np(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function hs(){var e=Ap,t=Lp,n=Np,r=Tp,i=Op,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=gh,l=gr("start","zoom","end"),u,h,f,_=500,p=150,g=0,y=10;function k(v){v.property("__zoom",ds).on("wheel.zoom",L,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",U).filter(i).on("touchstart.zoom",W).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}k.transform=function(v,I,S,z){var K=v.selection?v.selection():v;K.property("__zoom",ds),v!==K?P(v,I,S,z):K.interrupt().each(function(){N(this,arguments).event(z).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},k.scaleBy=function(v,I,S,z){k.scaleTo(v,function(){var K=this.__zoom.k,q=typeof I=="function"?I.apply(this,arguments):I;return K*q},S,z)},k.scaleTo=function(v,I,S,z){k.transform(v,function(){var K=t.apply(this,arguments),q=this.__zoom,V=S==null?b(K):typeof S=="function"?S.apply(this,arguments):S,Y=q.invert(V),Q=typeof I=="function"?I.apply(this,arguments):I;return n(m(w(q,Q),V,Y),K,s)},S,z)},k.translateBy=function(v,I,S,z){k.transform(v,function(){return n(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,z)},k.translateTo=function(v,I,S,z,K){k.transform(v,function(){var q=t.apply(this,arguments),V=this.__zoom,Y=z==null?b(q):typeof z=="function"?z.apply(this,arguments):z;return n(wn.translate(Y[0],Y[1]).scale(V.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof S=="function"?-S.apply(this,arguments):-S),q,s)},z,K)};function w(v,I){return I=Math.max(o[0],Math.min(o[1],I)),I===v.k?v:new ge(I,v.x,v.y)}function m(v,I,S){var z=I[0]-S[0]*v.k,K=I[1]-S[1]*v.k;return z===v.x&&K===v.y?v:new ge(v.k,z,K)}function b(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function P(v,I,S,z){v.on("start.zoom",function(){N(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(z).end()}).tween("zoom",function(){var K=this,q=arguments,V=N(K,q).event(z),Y=t.apply(K,q),Q=S==null?b(Y):typeof S=="function"?S.apply(K,q):S,D=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),ut=K.__zoom,_t=typeof I=="function"?I.apply(K,q):I,ct=c(ut.invert(Q).concat(D/ut.k),_t.invert(Q).concat(D/_t.k));return function(ft){if(ft===1)ft=_t;else{var xt=ct(ft),Ft=D/xt[2];ft=new ge(Ft,Q[0]-xt[0]*Ft,Q[1]-xt[1]*Ft)}V.zoom(null,ft)}})}function N(v,I,S){return!S&&v.__zooming||new A(v,I)}function A(v,I){this.that=v,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,I),this.taps=0}A.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,I){return this.mouse&&v!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var I=Wt(this.that).datum();l.call(v,this.that,new Pp(v,{sourceEvent:this.sourceEvent,target:k,type:v,transform:this.that.__zoom,dispatch:l}),I)}};function L(v,...I){if(!e.apply(this,arguments))return;var S=N(this,I).event(v),z=this.__zoom,K=Math.max(o[0],Math.min(o[1],z.k*Math.pow(2,r.apply(this,arguments)))),q=me(v);if(S.wheel)(S.mouse[0][0]!==q[0]||S.mouse[0][1]!==q[1])&&(S.mouse[1]=z.invert(S.mouse[0]=q)),clearTimeout(S.wheel);else{if(z.k===K)return;S.mouse=[q,z.invert(q)],Gn(this),S.start()}on(v),S.wheel=setTimeout(V,p),S.zoom("mouse",n(m(w(z,K),S.mouse[0],S.mouse[1]),S.extent,s));function V(){S.wheel=null,S.end()}}function j(v,...I){if(f||!e.apply(this,arguments))return;var S=v.currentTarget,z=N(this,I,!0).event(v),K=Wt(v.view).on("mousemove.zoom",Q,!0).on("mouseup.zoom",D,!0),q=me(v,S),V=v.clientX,Y=v.clientY;wa(v.view),Rr(v),z.mouse=[q,this.__zoom.invert(q)],Gn(this),z.start();function Q(ut){if(on(ut),!z.moved){var _t=ut.clientX-V,ct=ut.clientY-Y;z.moved=_t*_t+ct*ct>g}z.event(ut).zoom("mouse",n(m(z.that.__zoom,z.mouse[0]=me(ut,S),z.mouse[1]),z.extent,s))}function D(ut){K.on("mousemove.zoom mouseup.zoom",null),ba(ut.view,z.moved),on(ut),z.event(ut).end()}}function U(v,...I){if(!!e.apply(this,arguments)){var S=this.__zoom,z=me(v.changedTouches?v.changedTouches[0]:v,this),K=S.invert(z),q=S.k*(v.shiftKey?.5:2),V=n(m(w(S,q),z,K),t.apply(this,I),s);on(v),a>0?Wt(this).transition().duration(a).call(P,V,z,v):Wt(this).call(k.transform,V,z,v)}}function W(v,...I){if(!!e.apply(this,arguments)){var S=v.touches,z=S.length,K=N(this,I,v.changedTouches.length===z).event(v),q,V,Y,Q;for(Rr(v),V=0;V<z;++V)Y=S[V],Q=me(Y,this),Q=[Q,this.__zoom.invert(Q),Y.identifier],K.touch0?!K.touch1&&K.touch0[2]!==Q[2]&&(K.touch1=Q,K.taps=0):(K.touch0=Q,q=!0,K.taps=1+!!u);u&&(u=clearTimeout(u)),q&&(K.taps<2&&(h=Q[0],u=setTimeout(function(){u=null},_)),Gn(this),K.start())}}function R(v,...I){if(!!this.__zooming){var S=N(this,I).event(v),z=v.changedTouches,K=z.length,q,V,Y,Q;for(on(v),q=0;q<K;++q)V=z[q],Y=me(V,this),S.touch0&&S.touch0[2]===V.identifier?S.touch0[0]=Y:S.touch1&&S.touch1[2]===V.identifier&&(S.touch1[0]=Y);if(V=S.that.__zoom,S.touch1){var D=S.touch0[0],ut=S.touch0[1],_t=S.touch1[0],ct=S.touch1[1],ft=(ft=_t[0]-D[0])*ft+(ft=_t[1]-D[1])*ft,xt=(xt=ct[0]-ut[0])*xt+(xt=ct[1]-ut[1])*xt;V=w(V,Math.sqrt(ft/xt)),Y=[(D[0]+_t[0])/2,(D[1]+_t[1])/2],Q=[(ut[0]+ct[0])/2,(ut[1]+ct[1])/2]}else if(S.touch0)Y=S.touch0[0],Q=S.touch0[1];else return;S.zoom("touch",n(m(V,Y,Q),S.extent,s))}}function G(v,...I){if(!!this.__zooming){var S=N(this,I).event(v),z=v.changedTouches,K=z.length,q,V;for(Rr(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},_),q=0;q<K;++q)V=z[q],S.touch0&&S.touch0[2]===V.identifier?delete S.touch0:S.touch1&&S.touch1[2]===V.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(V=me(V,this),Math.hypot(h[0]-V[0],h[1]-V[1])<y)){var Y=Wt(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return k.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:Hn(+v),k):r},k.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Hn(!!v),k):e},k.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:Hn(!!v),k):i},k.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Hn([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),k):t},k.scaleExtent=function(v){return arguments.length?(o[0]=+v[0],o[1]=+v[1],k):[o[0],o[1]]},k.translateExtent=function(v){return arguments.length?(s[0][0]=+v[0][0],s[1][0]=+v[1][0],s[0][1]=+v[0][1],s[1][1]=+v[1][1],k):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},k.constrain=function(v){return arguments.length?(n=v,k):n},k.duration=function(v){return arguments.length?(a=+v,k):a},k.interpolate=function(v){return arguments.length?(c=v,k):c},k.on=function(){var v=l.on.apply(l,arguments);return v===l?k:v},k.clickDistance=function(v){return arguments.length?(g=(v=+v)*v,k):Math.sqrt(g)},k.tapDistance=function(v){return arguments.length?(y=+v,k):y},k}const Dt=Xt(""),Oe=Xt(wn),Qt=Xt(),Ne=Xt(),Vt=Xt(),ke=Xt(!1),te=Xt(!1),le=Xt({width:512*16,height:512*16});const Mt="src/lib/PaintFrame.svelte";function hi(e){let t,n;t=new Ae({props:{classList:"absolute inset-0 m-auto animate-spin text-6xl text-black"},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:hi.name,type:"if",source:"(191:3) {#if isLoading}",ctx:e}),r}function pi(e){let t,n;const r={c:function(){t=H("div"),this.h()},l:function(o){t=F(o,"DIV",{class:!0}),O(t).forEach(E),this.h()},h:function(){d(t,"class",n="absolute inset-0 bg-gradient-to-t "+(e[5]?"from-blue-700/40":"from-blue-700/90")+" to-blue-500/10"),T(t,Mt,194,4,6285)},m:function(o,s){rt(o,t,s)},p:function(o,s){s[0]&32&&n!==(n="absolute inset-0 bg-gradient-to-t "+(o[5]?"from-blue-700/40":"from-blue-700/90")+" to-blue-500/10")&&d(t,"class",n)},d:function(o){o&&E(t)}};return $("SvelteRegisterBlock",{block:r,id:pi.name,type:"if",source:"(194:3) {#if $myPresence?.status !== 'masking'}",ctx:e}),r}function mi(e){let t,n;const r={c:function(){t=H("div"),n=et(e[8]),this.h()},l:function(o){t=F(o,"DIV",{class:!0});var s=O(t);n=nt(s,e[8]),s.forEach(E),this.h()},h:function(){d(t,"class","font-bold text-4xl text-[#387CFF] text-center px-2 line-clamp-4"),T(t,Mt,209,5,6793)},m:function(o,s){rt(o,t,s),C(t,n)},p:function(o,s){s[0]&256&&ye(n,o[8])},d:function(o){o&&E(t)}};return $("SvelteRegisterBlock",{block:r,id:mi.name,type:"if",source:"(209:4) {#if prompt}",ctx:e}),r}function Ma(e){let t,n=e[1]?"\u{1F91A} Drag me":"\u{1F91A} Enable Drag",r;const i={c:function(){t=H("span"),r=et(n),this.h()},l:function(s){t=F(s,"SPAN",{class:!0});var a=O(t);r=nt(a,n),a.forEach(E),this.h()},h:function(){d(t,"class","select-none"),T(t,Mt,235,6,7710)},m:function(s,a){rt(s,t,a),C(t,r)},p:function(s,a){a[0]&2&&n!==(n=s[1]?"\u{1F91A} Drag me":"\u{1F91A} Enable Drag")&&ye(r,n)},d:function(s){s&&E(t)}};return $("SvelteRegisterBlock",{block:i,id:Ma.name,type:"else",source:"(235:5) {:else}",ctx:e}),i}function Da(e){let t,n,r,i,o,s=e[2]==="NFSW"&&gi(e);const a={c:function(){t=H("div"),s&&s.c(),n=st(),r=H("p"),i=et(e[2]),o=et("..."),this.h()},l:function(l){t=F(l,"DIV",{class:!0});var u=O(t);s&&s.l(u),n=at(u),r=F(u,"P",{});var h=O(r);i=nt(h,e[2]),o=nt(h,"..."),h.forEach(E),u.forEach(E),this.h()},h:function(){T(r,Mt,232,7,7649),d(t,"class",""),T(t,Mt,225,6,7388)},m:function(l,u){rt(l,t,u),s&&s.m(t,null),C(t,n),C(t,r),C(r,i),C(r,o)},p:function(l,u){l[2]==="NFSW"?s||(s=gi(l),s.c(),s.m(t,n)):s&&(s.d(1),s=null),u[0]&4&&ye(i,l[2])},d:function(l){l&&E(t),s&&s.d()}};return $("SvelteRegisterBlock",{block:a,id:Da.name,type:"if",source:"(225:5) {#if $loadingState !== ''}",ctx:e}),a}function gi(e){let t,n,r,i,o;const s={c:function(){t=H("h2"),n=et("NSFW Alert"),r=st(),i=H("h3"),o=et("Possible NSFW result detected, please try again"),this.h()},l:function(c){t=F(c,"H2",{class:!0});var l=O(t);n=nt(l,"NSFW Alert"),l.forEach(E),r=at(c),i=F(c,"H3",{class:!0});var u=O(i);o=nt(u,"Possible NSFW result detected, please try again"),u.forEach(E),this.h()},h:function(){d(t,"class","text-red-500 text-2xl font-bold"),T(t,Mt,227,8,7451),d(i,"class","text-red-500 text-lg"),T(i,Mt,228,8,7520)},m:function(c,l){rt(c,t,l),C(t,n),rt(c,r,l),rt(c,i,l),C(i,o)},d:function(c){c&&E(t),c&&E(r),c&&E(i)}};return $("SvelteRegisterBlock",{block:s,id:gi.name,type:"if",source:"(227:7) {#if $loadingState === 'NFSW'}",ctx:e}),s}function _i(e){let t,n,r,i,o,s,a,c,l;const u={c:function(){t=H("div"),n=H("button"),r=et("\u{1F58D}"),i=st(),o=H("button"),s=it("svg"),a=it("path"),this.h()},l:function(f){t=F(f,"DIV",{class:!0});var _=O(t);n=F(_,"BUTTON",{title:!0,class:!0});var p=O(n);r=nt(p,"\u{1F58D}"),p.forEach(E),i=at(_),o=F(_,"BUTTON",{title:!0,class:!0});var g=O(o);s=ot(g,"svg",{class:!0,width:!0,height:!0,viewBox:!0});var y=O(s);a=ot(y,"path",{fill:!0,d:!0,color:!0}),O(a).forEach(E),y.forEach(E),g.forEach(E),_.forEach(E),this.h()},h:function(){d(n,"title","Click to prompt and paint"),d(n,"class","w-10 h-10 bg-blue-600 hover:saturate-150 shadow-2xl shadow-blue-500 rounded-lg flex items-center justify-center text-3xl"),T(n,Mt,245,6,8039),d(a,"fill","currentColor"),d(a,"d","m65.453 10.826l-.053 5c3.073.034 6.144.549 9.059 1.52l1.58-4.744a34.758 34.758 0 0 0-10.586-1.776zm-5.365.352a35.131 35.131 0 0 0-10.26 3.119l2.17 4.506a30.166 30.166 0 0 1 8.799-2.674l-.71-4.951zm20.908 3.51l-2.283 4.447a30.131 30.131 0 0 1 7.447 5.394l3.522-3.549a35.101 35.101 0 0 0-8.686-6.293zM35 19.125c-19.3 0-35 15.7-35 35s15.7 35 35 35c8.934 0 17.087-3.374 23.275-8.904c.005 0 .01 0 .014.002c.065-.059.127-.121.191-.18l.125-.115a34.677 34.677 0 0 0 2.461-2.496c.083-.092.167-.183.248-.276c.399-.455.79-.919 1.165-1.394c-.482-.04-.961-.092-1.436-.155c-.318-.041-.632-.094-.947-.146c-.158-.026-.316-.046-.473-.074a29.93 29.93 0 0 1-1.383-.283a29.851 29.851 0 0 1-1.183-.301c-.065-.018-.13-.033-.194-.051C44.234 71.216 35 59.651 35 45.875a29.876 29.876 0 0 1 9.557-21.955c.162-.151.324-.302.49-.45c.249-.22.504-.436.76-.65c.158-.131.313-.266.474-.394c.415-.332.837-.656 1.27-.965a35.075 35.075 0 0 0-2.867-.965l-.03-.008c-.287-.082-.577-.155-.867-.23c-.215-.056-.43-.118-.646-.17c-.349-.084-.701-.155-1.053-.229c-.126-.026-.25-.057-.377-.082l-.002.002A34.83 34.83 0 0 0 35 19.125zm58.2 5.928l-4.028 2.967a30.012 30.012 0 0 1 4.252 8.15l4.736-1.606a34.98 34.98 0 0 0-4.96-9.511zm6.294 14.717l-4.924.87c.536 3.029.603 6.145.194 9.19l4.955.666c.48-3.562.4-7.19-.225-10.726zM93.8 54.338a30.198 30.198 0 0 1-3.936 8.314l4.143 2.801a35.162 35.162 0 0 0 4.586-9.695l-4.793-1.42zm-6.803 11.928a29.79 29.79 0 0 1-7.213 5.687l2.451 4.358a34.776 34.776 0 0 0 8.428-6.647l-3.666-3.398zm-11.394 7.638a30.155 30.155 0 0 1-9.002 1.887l.265 4.992a35.12 35.12 0 0 0 10.498-2.199l-1.761-4.68z"),d(a,"color","currentColor"),T(a,Mt,258,9,8666),d(s,"class","text-white"),d(s,"width","1em"),d(s,"height","1em"),d(s,"viewBox","0 0 100 100"),T(s,Mt,257,7,8585),d(o,"title","Draw your custom mask on the frame"),d(o,"class","w-10 h-10 bg-blue-600 hover:saturate-200 shadow-2xl shadow-blue-500 rounded-lg flex items-center justify-center text-3xl"),T(o,Mt,252,6,8338),d(t,"class","mx-4 flex flex-col gap-2"),T(t,Mt,244,5,7993)},m:function(f,_){rt(f,t,_),C(t,n),C(n,r),C(t,i),C(t,o),C(o,s),C(s,a),c||(l=[$t(n,"click",e[19],!1,!1,!1,!1),$t(o,"click",e[13],!1,!1,!1,!1)],c=!0)},p:mt,d:function(f){f&&E(t),c=!1,$i(l)}};return $("SvelteRegisterBlock",{block:u,id:_i.name,type:"if",source:"(244:4) {#if !isLoading}",ctx:e}),u}function yi(e){var K;let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k,w,m,b,P,N,A,L,j,U=e[6]&&hi(e),W=((K=e[3])==null?void 0:K.status)!=="masking"&&pi(e),R=e[8]&&mi(e);function G(q,V){return q[2]!==""?Da:Ma}let v=G(e),I=v(e),S=!e[6]&&_i(e);const z={c:function(){t=H("div"),n=H("div"),r=H("div"),U&&U.c(),i=st(),W&&W.c(),o=st(),s=H("canvas"),c=st(),l=H("div"),R&&R.c(),u=st(),h=H("div"),f=H("div"),I.c(),p=st(),g=H("div"),S&&S.c(),w=st(),m=H("div"),this.h()},l:function(V){t=F(V,"DIV",{});var Y=O(t);n=F(Y,"DIV",{class:!0,style:!0});var Q=O(n);r=F(Q,"DIV",{class:!0,style:!0});var D=O(r);U&&U.l(D),i=at(D),W&&W.l(D),o=at(D),s=F(D,"CANVAS",{title:!0,class:!0,width:!0,height:!0}),O(s).forEach(E),c=at(D),l=F(D,"DIV",{class:!0});var ut=O(l);R&&R.l(ut),ut.forEach(E),u=at(D),h=F(D,"DIV",{class:!0,style:!0});var _t=O(h);f=F(_t,"DIV",{class:!0,title:!0});var ct=O(f);I.l(ct),ct.forEach(E),_t.forEach(E),p=at(D),g=F(D,"DIV",{class:!0,style:!0});var ft=O(g);S&&S.l(ft),ft.forEach(E),D.forEach(E),Q.forEach(E),w=at(Y),m=F(Y,"DIV",{title:!0,class:!0,style:!0}),O(m).forEach(E),Y.forEach(E),this.h()},h:function(){d(s,"title","Draw your mask here. The masked area will be inpainted by Stable Diffusion"),d(s,"class",a=(e[1]?"hidden":"bg-white block")+" absolute top-0 left-0 z-0"),d(s,"width",dt),d(s,"height",dt),T(s,Mt,200,3,6444),d(l,"class","pointer-events-none touch-none col-span-3 z-10"),T(l,Mt,207,3,6708),d(f,"class","pl-3 pr-5 py-1 bg-blue-700/90 text-white text-lg xl:text-2xl rounded-tr-xl font-medium tracking-wide cursor-pointer"),d(f,"title","Enable dragging to move the frame"),T(f,Mt,219,4,7122),d(h,"class","absolute bottom-0 origin-bottom-left"),d(h,"style",_=`transform: scale(${Math.max(2.5-e[0].k,1)});`),T(h,Mt,214,3,6926),d(g,"class","absolute left-full"),d(g,"style",y=`transform: scale(${Math.max(2.5-e[0].k,1)}); transform-origin: 0 0;`),T(g,Mt,239,3,7831),d(r,"class","frame relative s-HhHr-TV-2_Je"),d(r,"style",`width: ${dt}px;height: ${dt}px;`),T(r,Mt,189,2,6027),d(n,"class","absolute top-0 left-0 pen"),d(n,"style",k=`transform: translateX(${e[7].x}px) translateY(${e[7].y}px) scale(${e[0].k}); transform-origin: 0 0;`),T(n,Mt,185,1,5858),d(m,"title",b=e[1]?"Drag the frame around, prompt, and paint":"Enable dragging"),d(m,"class",P="absolute top-0 left-0 ring-8 hand "+(e[1]?"block":"hidden")+" "+(e[6]?"cursor-wait":e[1]?"block cursor-move":"hidden cursor-pointer")),d(m,"style",N=`width: ${dt}px;height: ${dt}px;transform: translateX(${e[7].x}px) translateY(${e[7].y}px) scale(${e[0].k}); transform-origin: 0 0;`),T(m,Mt,270,1,10428),T(t,Mt,184,0,5850)},m:function(V,Y){rt(V,t,Y),C(t,n),C(n,r),U&&U.m(r,null),C(r,i),W&&W.m(r,null),C(r,o),C(r,s),e[17](s),C(r,c),C(r,l),R&&R.m(l,null),C(r,u),C(r,h),C(h,f),I.m(f,null),C(r,p),C(r,g),S&&S.m(g,null),C(t,w),C(t,m),e[20](m),A=!0,L||(j=$t(f,"click",e[18],!1,!1,!1,!1),L=!0)},p:function(V,Y){var Q;V[6]?U?Y[0]&64&&Z(U,1):(U=hi(V),U.c(),Z(U,1),U.m(r,i)):U&&(zt(),J(U,1,1,()=>{U=null}),Ht()),((Q=V[3])==null?void 0:Q.status)!=="masking"?W?W.p(V,Y):(W=pi(V),W.c(),W.m(r,o)):W&&(W.d(1),W=null),(!A||Y[0]&2&&a!==(a=(V[1]?"hidden":"bg-white block")+" absolute top-0 left-0 z-0"))&&d(s,"class",a),V[8]?R?R.p(V,Y):(R=mi(V),R.c(),R.m(l,null)):R&&(R.d(1),R=null),v===(v=G(V))&&I?I.p(V,Y):(I.d(1),I=v(V),I&&(I.c(),I.m(f,null))),(!A||Y[0]&1&&_!==(_=`transform: scale(${Math.max(2.5-V[0].k,1)});`))&&d(h,"style",_),V[6]?S&&(S.d(1),S=null):S?S.p(V,Y):(S=_i(V),S.c(),S.m(g,null)),(!A||Y[0]&1&&y!==(y=`transform: scale(${Math.max(2.5-V[0].k,1)}); transform-origin: 0 0;`))&&d(g,"style",y),(!A||Y[0]&129&&k!==(k=`transform: translateX(${V[7].x}px) translateY(${V[7].y}px) scale(${V[0].k}); transform-origin: 0 0;`))&&d(n,"style",k),(!A||Y[0]&2&&b!==(b=V[1]?"Drag the frame around, prompt, and paint":"Enable dragging"))&&d(m,"title",b),(!A||Y[0]&66&&P!==(P="absolute top-0 left-0 ring-8 hand "+(V[1]?"block":"hidden")+" "+(V[6]?"cursor-wait":V[1]?"block cursor-move":"hidden cursor-pointer")))&&d(m,"class",P),(!A||Y[0]&129&&N!==(N=`width: ${dt}px;height: ${dt}px;transform: translateX(${V[7].x}px) translateY(${V[7].y}px) scale(${V[0].k}); transform-origin: 0 0;`))&&d(m,"style",N)},i:function(V){A||(Z(U),A=!0)},o:function(V){J(U),A=!1},d:function(V){V&&E(t),U&&U.d(),W&&W.d(),e[17](null),R&&R.d(),I.d(),S&&S.d(),e[20](null),L=!1,j()}};return $("SvelteRegisterBlock",{block:z,id:yi.name,type:"component",source:"",ctx:e}),z}function Rp(e,t,n){let r,i,o,s,a,c,l,u,h;yt(le,"canvasSize"),vt(e,le,D=>n(24,s=D)),yt(Qt,"canvasEl"),vt(e,Qt,D=>n(25,a=D)),yt(Ne,"maskEl"),vt(e,Ne,D=>n(9,c=D)),yt(Dt,"loadingState"),vt(e,Dt,D=>n(2,l=D)),yt(te,"isRenderingCanvas"),vt(e,te,D=>n(16,u=D));let{$$slots:f={},$$scope:_}=t;Rt("PaintFrame",f,[]);const p=Pe();yt(p,"myPresence"),vt(e,p,D=>n(3,h=D));const g=Ee();let{transform:y}=t,k,w={x:s.width/2-dt/2,y:s.height/2-dt/2},m,b=!0,P=!1,N=null,A=0,L=0;function j(D){k.save(),k.clearRect(0,0,dt,dt),k.globalCompositeOperation="source-over",k.drawImage(a,D.x,D.y,dt,dt,0,0,dt,dt),k.restore()}function U(D){k.save(),k.globalCompositeOperation="destination-out",k.beginPath(),k.moveTo(D.lastx,D.lasty),k.lineTo(D.x,D.y),k.lineWidth=50,k.lineCap="round",k.strokeStyle="black",k.stroke(),k.restore()}Yt(()=>{k=c.getContext("2d"),Wt(m).on("wheel",D=>{a.dispatchEvent(new WheelEvent("wheel",D))}).call(v()).call(W),Wt(c).on("wheel",D=>{a.dispatchEvent(new WheelEvent("wheel",D))}).call(G()).call(W),n(15,N=!0)});function W(D){function ut(ct){p.update({cursor:{x:y.invertX(ct.clientX),y:y.invertY(ct.clientY)}})}function _t(){p.update({cursor:null})}return D.on("pointermove",ut).on("pointerleave",_t)}function R(D){return Math.min(Math.max(D,Bt),dt-Bt)}function G(){let D,ut;function _t(ft){if(i)return;const xt=R(ft.x/y.k),Ft=R(ft.y/y.k);D=xt,ut=Ft}function ct(ft){if(i)return;const xt=R(ft.x/y.k),Ft=R(ft.y/y.k);U({x:xt,y:Ft,lastx:D,lasty:ut}),D=xt,ut=Ft}return Tr().on("start",_t).on("drag",ct)}function v(){function D(ct){if(i)return;const ft=ct.sourceEvent.target.getBoundingClientRect();typeof TouchEvent<"u"&&ct.sourceEvent instanceof TouchEvent?(A=ct.sourceEvent.targetTouches[0].pageX-ft.left,L=ct.sourceEvent.targetTouches[0].pageY-ft.top):ct.sourceEvent instanceof MouseEvent&&(A=ct.sourceEvent.pageX-ft.left,L=ct.sourceEvent.pageY-ft.top),n(5,P=!0)}function ut(ct){if(i)return;const ft=nn(y.invertX(ct.x-A),s),xt=nn(y.invertY(ct.y-L),s);n(14,w={x:ft,y:xt}),p.update({cursor:{x:y.invertX(ct.x),y:y.invertY(ct.y)}}),j({x:ft,y:xt})}function _t(ct){if(i)return;n(5,P=!1);const ft=nn(y.invertX(ct.x-A),s),xt=nn(y.invertY(ct.y-L),s);j({x:ft,y:xt}),p.update({frame:{x:ft,y:xt}})}return Tr().on("start",D).on("drag",ut).on("end",_t)}function I(){n(1,b=!0),p.update({status:ht.dragging})}function S(){n(1,b=!1),j(w),p.update({status:ht.masking})}function z(){j(w)}e.$$.on_mount.push(function(){y===void 0&&!("transform"in t||e.$$.bound[e.$$.props.transform])&&console.warn("<PaintFrame> was created without expected prop 'transform'")});const K=["transform"];Object.keys(t).forEach(D=>{!~K.indexOf(D)&&D.slice(0,2)!=="$$"&&D!=="slot"&&console.warn(`<PaintFrame> was created with unknown prop '${D}'`)});function q(D){Se[D?"unshift":"push"](()=>{c=D,Ne.set(c)})}const V=()=>I(),Y=()=>g("showModal",{showModal:!0});function Q(D){Se[D?"unshift":"push"](()=>{m=D,n(4,m)})}return e.$$set=D=>{"transform"in D&&n(0,y=D.transform)},e.$capture_state=()=>({LoadingIcon:Ae,FRAME_SIZE:dt,GRID_SIZE:Bt,drag:Tr,select:Wt,round:nn,onMount:Yt,useMyPresence:Pe,canvasEl:Qt,maskEl:Ne,loadingState:Dt,isRenderingCanvas:te,canvasSize:le,createEventDispatcher:Ee,Status:ht,myPresence:p,dispatch:g,transform:y,maskCtx:k,position:w,frameElement:m,dragEnabled:b,isDragging:P,firstLoading:N,offsetX:A,offsetY:L,cropCanvas:j,drawLine:U,cursorUpdate:W,constraintCursor:R,maskingHandler:G,dragMoveHandler:v,toggleDrag:I,toggleDrawMask:S,cleanMask:z,isLoading:i,coord:o,prompt:r,$canvasSize:s,$canvasEl:a,$maskEl:c,$loadingState:l,$isRenderingCanvas:u,$myPresence:h}),e.$inject_state=D=>{"transform"in D&&n(0,y=D.transform),"maskCtx"in D&&(k=D.maskCtx),"position"in D&&n(14,w=D.position),"frameElement"in D&&n(4,m=D.frameElement),"dragEnabled"in D&&n(1,b=D.dragEnabled),"isDragging"in D&&n(5,P=D.isDragging),"firstLoading"in D&&n(15,N=D.firstLoading),"offsetX"in D&&(A=D.offsetX),"offsetY"in D&&(L=D.offsetY),"isLoading"in D&&n(6,i=D.isLoading),"coord"in D&&n(7,o=D.coord),"prompt"in D&&n(8,r=D.prompt)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty[0]&8&&n(8,r=h==null?void 0:h.currentPrompt),e.$$.dirty[0]&8&&n(6,i=(h==null?void 0:h.status)===ht.loading||(h==null?void 0:h.status)===ht.prompting||!1),e.$$.dirty[0]&16385&&n(7,o={x:y.applyX(w.x),y:y.applyY(w.y)}),e.$$.dirty[0]&98304&&N!==null&&!u&&N&&(z(),n(15,N=!1)),e.$$.dirty[0]&6&&l==="Complete"&&!b&&(z(),I())},[y,b,l,h,m,P,i,o,r,c,p,g,I,S,w,N,u,q,V,Y,Q]}class Ua extends Tt{constructor(t){super(t),Ot(this,t,Rp,yi,Nt,{transform:0},null,[-1,-1]),$("SvelteRegisterComponent",{component:this,tagName:"PaintFrame",options:t,id:yi.name})}get transform(){throw new Error("<PaintFrame>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set transform(t){throw new Error("<PaintFrame>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function ps(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}const{Object:Mp,console:Dp}=Qe,ms="src/lib/PaintCanvas.svelte";function vi(e){let t,n,r,i;const o=e[8].default,s=Fi(o,e,e[7],null),a={c:function(){t=H("div"),n=H("canvas"),r=st(),s&&s.c(),this.h()},l:function(l){t=F(l,"DIV",{class:!0});var u=O(t);n=F(u,"CANVAS",{width:!0,height:!0,class:!0}),O(n).forEach(E),r=at(u),s&&s.l(u),u.forEach(E),this.h()},h:function(){d(n,"width",e[4]),d(n,"height",e[3]),d(n,"class","absolute top-0 left-0 bg-white shadow-2xl shadow-blue-500/20 s-qQUxWWO8GgKM"),T(n,ms,203,1,7780),d(t,"class","absolute top-0 left-0 right-0 bottom-0 overflow-hidden z-0 bg-blue-200"),T(t,ms,199,0,7663)},m:function(l,u){rt(l,t,u),C(t,n),e[9](n),C(t,r),s&&s.m(t,null),e[10](t),i=!0},p:function(l,[u]){s&&s.p&&(!i||u&128)&&Ki(s,o,l,l[7],i?qi(o,l[7],u,null):Wi(l[7]),null)},i:function(l){i||(Z(s,l),i=!0)},o:function(l){J(s,l),i=!1},d:function(l){l&&E(t),e[9](null),s&&s.d(l),e[10](null)}};return $("SvelteRegisterBlock",{block:a,id:vi.name,type:"component",source:"",ctx:e}),a}function Up(e,t,n){let r,i,o,s,a,c;yt(Oe,"currZoomTransform"),vt(e,Oe,R=>n(12,r=R)),yt(Qt,"canvasEl"),vt(e,Qt,R=>n(1,i=R)),yt(te,"isRenderingCanvas"),vt(e,te,R=>n(13,o=R)),yt(Vt,"selectedRoomID"),vt(e,Vt,R=>n(14,a=R)),yt(le,"canvasSize"),vt(e,le,R=>n(15,c=R));let{$$slots:l={},$$scope:u}=t;Rt("PaintCanvas",l,["default"]);const h=Pe(),f=ir("promptImgStorage");yt(f,"promptImgStorage"),vt(e,f,R=>n(6,s=R));const _=c.height,p=c.width;let g,y;const k=new Set;function w(R){if(R){const G=a||"",v=new Map;for(const K of Array.from(Array(p/Bt).keys()))for(const q of Array.from(Array(_/Bt).keys()))v.set(`${K*Bt}_${q*Bt}`,null);const I=Object.values(R).map(K=>K instanceof Gt?K.toObject():K).map(K=>{const q=K.imgURL.split(/-|.jpg|.webp/),V=parseInt(q[0]),Y=q[1],[Q,D]=q[2].split("_"),ut=q.slice(3).join(" ");return{id:Y,date:V,position:{x:parseInt(Q),y:parseInt(D)},imgURL:K.imgURL,prompt:ut,room:G}}).sort((K,q)=>q.date-K.date);for(const K of I){const q=K.position.x,V=K.position.y;for(const Y of[...Array(dt/Bt).keys()])for(const Q of[...Array(dt/Bt).keys()]){const D=`${q+Y*Bt}_${V+Q*Bt}`;v.get(D)||v.set(D,K.id)}}const S=new Set([...v.values()]),z=I.filter(K=>S.has(K.id));return I.filter(K=>!S.has(K.id)).map(K=>{const q=`${K.position.x}_${K.position.y}`;s.delete(q),console.log("deleted",q)}),z.reverse().filter(K=>!k.has(K.id))}return[]}let m=[];function b(R,G,v,I,S,z){const K=(R-z)/I,q=(G-z)/S,V=ps([K,q])||1,Y=R/2-v.x*V,Q=G/2-v.y*V;return wn.translate(Y,Q).scale(V)}Yt(()=>{const G=(p+100)/(g.clientHeight>g.clientWidth?g.clientWidth:g.clientHeight),v=hs().scaleExtent([1/G/2,3]).tapDistance(10).on("zoom",N),I=Wt(i.parentElement).call(v).call(v.transform,b(g.clientWidth,g.clientHeight,{x:p/2,y:_/2},p,_,50)).on("pointermove",A).on("pointerleave",L);y=i.getContext("2d");function S(){const z=(p+100)/(g.clientHeight>g.clientWidth?g.clientWidth:g.clientHeight);v.scaleExtent([1/z/2,3]),I.call(v.transform,b(g.clientWidth,g.clientHeight,{x:p/2,y:_/2},p,_,50))}return window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}});async function P(R){R.length!==0&&(Lt(te,o=!0,o),await Promise.allSettled(R.map(({imgURL:G,position:v,id:I,room:S})=>new Promise((z,K)=>{const q=new Image;q.crossOrigin="anonymous",q.onload=()=>{const V={img:q,position:v,id:I};y.drawImage(q,v.x,v.y,q.width,q.height),z(V)},q.onerror=V=>{K(V)},q.src=`${qo}/${S}/${G}`}))).then(G=>{G.filter(I=>I.status==="fulfilled").map(I=>I.value).forEach(({img:I,position:S,id:z})=>{k.add(z),y.drawImage(I,S.x,S.y,I.width,I.height)})}),Lt(te,o=!1,o))}function N(R){const G=Lt(Oe,r=R.transform,r);Lt(Qt,i.style.transform=`translate(${G.x}px, ${G.y}px) scale(${G.k})`,i)}function A(R){R.preventDefault();const G=r.invertX(R.clientX),v=r.invertY(R.clientY);h.update({cursor:{x:G,y:v}})}function L(){h.update({cursor:null})}const j=[];Mp.keys(t).forEach(R=>{!~j.indexOf(R)&&R.slice(0,2)!=="$$"&&R!=="slot"&&Dp.warn(`<PaintCanvas> was created with unknown prop '${R}'`)});function U(R){Se[R?"unshift":"push"](()=>{i=R,Qt.set(i)})}function W(R){Se[R?"unshift":"push"](()=>{g=R,n(0,g)})}return e.$$set=R=>{"$$scope"in R&&n(7,u=R.$$scope)},e.$capture_state=()=>({zoom:hs,zoomIdentity:wn,min:ps,select:Wt,onMount:Yt,PUBLIC_UPLOADS:qo,currZoomTransform:Oe,canvasEl:Qt,isRenderingCanvas:te,canvasSize:le,selectedRoomID:Vt,useMyPresence:Pe,useObject:ir,LiveObject:Gt,FRAME_SIZE:dt,GRID_SIZE:Bt,myPresence:h,promptImgStorage:f,height:_,width:p,containerEl:g,canvasCtx:y,imagesOnCanvas:k,getpromptImgList:w,promptImgList:m,to_bbox:b,renderImages:P,zoomed:N,handlePointerMove:A,handlePointerLeave:L,$currZoomTransform:r,$canvasEl:i,$isRenderingCanvas:o,$promptImgStorage:s,$selectedRoomID:a,$canvasSize:c}),e.$inject_state=R=>{"containerEl"in R&&n(0,g=R.containerEl),"canvasCtx"in R&&(y=R.canvasCtx),"promptImgList"in R&&n(5,m=R.promptImgList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&64&&n(5,m=w(s==null?void 0:s.toObject())),e.$$.dirty&32&&m&&P(m)},[g,i,f,_,p,m,s,u,l,U,W]}class ja extends Tt{constructor(t){super(t),Ot(this,t,Up,vi,Nt,{}),$("SvelteRegisterComponent",{component:this,tagName:"PaintCanvas",options:t,id:vi.name})}}const Mr="src/lib/Icons/Room.svelte";function wi(e){let t,n,r;const i={c:function(){t=it("svg"),n=it("rect"),r=it("rect"),this.h()},l:function(s){t=ot(s,"svg",{class:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var a=O(t);n=ot(a,"rect",{x:!0,y:!0,width:!0,height:!0,rx:!0,stroke:!0}),O(n).forEach(E),r=ot(a,"rect",{x:!0,y:!0,width:!0,height:!0,rx:!0,fill:!0,stroke:!0}),O(r).forEach(E),a.forEach(E),this.h()},h:function(){d(n,"x","1"),d(n,"y","1"),d(n,"width","7"),d(n,"height","7"),d(n,"rx","1"),d(n,"stroke","#2F6DCB"),T(n,Mr,4,1,163),d(r,"x","3.05566"),d(r,"y","3.05566"),d(r,"width","2.88889"),d(r,"height","2.88889"),d(r,"rx","0.5"),d(r,"fill","#2F6DCB"),d(r,"stroke","#2F6DCB"),T(r,Mr,5,1,231),d(t,"class",e[0]),d(t,"height","1em"),d(t,"viewBox","0 0 9 9"),d(t,"fill","none"),d(t,"xmlns","http://www.w3.org/2000/svg"),T(t,Mr,3,0,59)},m:function(s,a){rt(s,t,a),C(t,n),C(t,r)},p:function(s,[a]){a&1&&d(t,"class",s[0])},i:mt,o:mt,d:function(s){s&&E(t)}};return $("SvelteRegisterBlock",{block:i,id:wi.name,type:"component",source:"",ctx:e}),i}function jp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("Room",r,[]);let{classList:o=""}=t;const s=["classList"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<Room> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classList"in a&&n(0,o=a.classList)},e.$capture_state=()=>({classList:o}),e.$inject_state=a=>{"classList"in a&&n(0,o=a.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class br extends Tt{constructor(t){super(t),Ot(this,t,jp,wi,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"Room",options:t,id:wi.name})}get classList(){throw new Error("<Room>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<Room>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const gs="src/lib/Icons/Pin.svelte";function bi(e){let t,n;const r={c:function(){t=it("svg"),n=it("path"),this.h()},l:function(o){t=ot(o,"svg",{class:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var s=O(t);n=ot(s,"path",{d:!0,fill:!0}),O(n).forEach(E),s.forEach(E),this.h()},h:function(){d(n,"d","M3.5 4.58599C3.74063 4.58599 3.94669 4.4961 4.11819 4.31633C4.2894 4.13687 4.375 3.92102 4.375 3.66879C4.375 3.41656 4.2894 3.20056 4.11819 3.02079C3.94669 2.84132 3.74063 2.75159 3.5 2.75159C3.25937 2.75159 3.05346 2.84132 2.88225 3.02079C2.71075 3.20056 2.625 3.41656 2.625 3.66879C2.625 3.92102 2.71075 4.13687 2.88225 4.31633C3.05346 4.4961 3.25937 4.58599 3.5 4.58599ZM3.5 7.95669C4.38958 7.10064 5.04948 6.32285 5.47969 5.62334C5.9099 4.92413 6.125 4.30318 6.125 3.76051C6.125 2.92739 5.87154 2.24515 5.36462 1.71378C4.858 1.18273 4.23646 0.917197 3.5 0.917197C2.76354 0.917197 2.14185 1.18273 1.63494 1.71378C1.12831 2.24515 0.875 2.92739 0.875 3.76051C0.875 4.30318 1.0901 4.92413 1.52031 5.62334C1.95052 6.32285 2.61042 7.10064 3.5 7.95669ZM3.5 9C3.44167 9 3.38333 8.98853 3.325 8.9656C3.26667 8.94267 3.21562 8.9121 3.17188 8.87389C2.10729 7.8879 1.3125 6.97269 0.7875 6.12825C0.2625 5.28352 0 4.49427 0 3.76051C0 2.61401 0.351896 1.70064 1.05569 1.02038C1.75919 0.340127 2.57396 0 3.5 0C4.42604 0 5.24081 0.340127 5.94431 1.02038C6.6481 1.70064 7 2.61401 7 3.76051C7 4.49427 6.7375 5.28352 6.2125 6.12825C5.6875 6.97269 4.89271 7.8879 3.82812 8.87389C3.78438 8.9121 3.73333 8.94267 3.675 8.9656C3.61667 8.98853 3.55833 9 3.5 9Z"),d(n,"fill","white"),T(n,gs,10,1,175),d(t,"class",e[0]),d(t,"height","1em"),d(t,"viewBox","0 0 7 9"),d(t,"fill","none"),d(t,"xmlns","http://www.w3.org/2000/svg"),T(t,gs,3,0,59)},m:function(o,s){rt(o,t,s),C(t,n)},p:function(o,[s]){s&1&&d(t,"class",o[0])},i:mt,o:mt,d:function(o){o&&E(t)}};return $("SvelteRegisterBlock",{block:r,id:bi.name,type:"component",source:"",ctx:e}),r}function Bp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("Pin",r,[]);let{classList:o=""}=t;const s=["classList"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<Pin> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classList"in a&&n(0,o=a.classList)},e.$capture_state=()=>({classList:o}),e.$inject_state=a=>{"classList"in a&&n(0,o=a.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class Ba extends Tt{constructor(t){super(t),Ot(this,t,Bp,bi,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"Pin",options:t,id:bi.name})}get classList(){throw new Error("<Pin>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<Pin>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Fn="src/lib/Icons/People.svelte";function ki(e){let t,n,r,i;const o={c:function(){t=it("svg"),n=it("path"),r=it("path"),i=it("path"),this.h()},l:function(a){t=ot(a,"svg",{class:!0,height:!0,width:!0,viewBox:!0,fill:!0,xmlns:!0});var c=O(t);n=ot(c,"path",{"fill-rule":!0,"clip-rule":!0,d:!0,fill:!0}),O(n).forEach(E),r=ot(c,"path",{d:!0,fill:!0}),O(r).forEach(E),i=ot(c,"path",{"fill-rule":!0,"clip-rule":!0,d:!0,fill:!0}),O(i).forEach(E),c.forEach(E),this.h()},h:function(){d(n,"fill-rule","evenodd"),d(n,"clip-rule","evenodd"),d(n,"d","M6.41113 3.73486C6.97158 4.11531 7.3643 4.63076 7.3643 5.31801V6.54526H8.59155C8.81654 6.54526 9.00063 6.36118 9.00063 6.13618V5.31801C9.00063 4.42621 7.5402 3.8985 6.41113 3.73486Z"),d(n,"fill","currentColor"),T(n,Fn,11,1,189),d(r,"d","M3.27305 3.27266C4.17677 3.27266 4.90938 2.54005 4.90938 1.63633C4.90938 0.732611 4.17677 0 3.27305 0C2.36933 0 1.63672 0.732611 1.63672 1.63633C1.63672 2.54005 2.36933 3.27266 3.27305 3.27266Z"),d(r,"fill","currentColor"),T(r,Fn,17,1,460),d(i,"fill-rule","evenodd"),d(i,"clip-rule","evenodd"),d(i,"d","M5.72716 3.27266C6.63124 3.27266 7.36349 2.54041 7.36349 1.63633C7.36349 0.732258 6.63124 0 5.72716 0C5.53489 0 5.3549 0.0409082 5.18308 0.0981798C5.53511 0.533533 5.72715 1.07646 5.72715 1.63633C5.72715 2.1962 5.53511 2.73913 5.18308 3.17448C5.3549 3.23176 5.53489 3.27266 5.72716 3.27266ZM3.27266 3.68175C2.18041 3.68175 0 4.22992 0 5.31808V6.13624C0 6.36124 0.184087 6.54533 0.409083 6.54533H6.13625C6.36124 6.54533 6.54533 6.36124 6.54533 6.13624V5.31808C6.54533 4.22992 4.36492 3.68175 3.27266 3.68175Z"),d(i,"fill","currentColor"),T(i,Fn,21,1,697),d(t,"class",e[0]),d(t,"height","1em"),d(t,"width","1em"),d(t,"viewBox","0 0 9 7"),d(t,"fill","none"),d(t,"xmlns","http://www.w3.org/2000/svg"),T(t,Fn,3,0,59)},m:function(a,c){rt(a,t,c),C(t,n),C(t,r),C(t,i)},p:function(a,[c]){c&1&&d(t,"class",a[0])},i:mt,o:mt,d:function(a){a&&E(t)}};return $("SvelteRegisterBlock",{block:o,id:ki.name,type:"component",source:"",ctx:e}),o}function Vp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("People",r,[]);let{classList:o=""}=t;const s=["classList"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<People> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classList"in a&&n(0,o=a.classList)},e.$capture_state=()=>({classList:o}),e.$inject_state=a=>{"classList"in a&&n(0,o=a.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class kr extends Tt{constructor(t){super(t),Ot(this,t,Vp,ki,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"People",options:t,id:ki.name})}get classList(){throw new Error("<People>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<People>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Pt="src/lib/Buttons/RoomsSelector.svelte";function _s(e,t,n){const r=e.slice();return r[13]=t[n],r}function Va(e){let t,n,r,i;n=new Ae({props:{classList:"animate-spin mr-2 text-sm"},$$inline:!0});const o={c:function(){t=H("div"),wt(n.$$.fragment),r=et(" loading rooms"),this.h()},l:function(a){t=F(a,"DIV",{class:!0});var c=O(t);bt(n.$$.fragment,c),r=nt(c," loading rooms"),c.forEach(E),this.h()},h:function(){d(t,"class","bg-gradient-to-r from-transparent via-blue-900/20 to-transparent py-1.5 text-blue-700 rounded-full flex justify-center items-center"),T(t,Pt,111,2,3424)},m:function(a,c){rt(a,t,c),kt(n,t,null),C(t,r),i=!0},p:mt,i:function(a){i||(Z(n.$$.fragment,a),i=!0)},o:function(a){J(n.$$.fragment,a),i=!1},d:function(a){a&&E(t),Ct(n)}};return $("SvelteRegisterBlock",{block:o,id:Va.name,type:"else",source:"(111:1) {:else}",ctx:e}),o}function za(e){let t,n,r,i,o,s,a,c,l,u=!e[4]&&Ci(e);const h=[Fa,Ha],f=[];function _(g,y){return g[6]?0:1}i=_(e),o=f[i]=h[i](e);const p={c:function(){t=H("div"),u&&u.c(),n=st(),r=H("div"),o.c(),this.h()},l:function(y){t=F(y,"DIV",{class:!0,title:!0});var k=O(t);u&&u.l(k),n=at(k),r=F(k,"DIV",{class:!0});var w=O(r);o.l(w),w.forEach(E),k.forEach(E),this.h()},h:function(){d(r,"class",s=e[0]?"cursor-wait":"cursor-pointer"),T(r,Pt,82,3,2800),d(t,"class","text-sm rounded-2xl md:text-smtext-gray-700 py-1 font-medium tracking-tight relative ring-1 ring-blue-500 px-2"),d(t,"title","Choose a different room"),T(t,Pt,39,2,1393)},m:function(y,k){rt(y,t,k),u&&u.m(t,null),C(t,n),C(t,r),f[i].m(r,null),e[11](t),a=!0,c||(l=$t(r,"click",e[10],!1,!1,!1,!1),c=!0)},p:function(y,k){y[4]?u&&(zt(),J(u,1,1,()=>{u=null}),Ht()):u?(u.p(y,k),k&16&&Z(u,1)):(u=Ci(y),u.c(),Z(u,1),u.m(t,n));let w=i;i=_(y),i===w?f[i].p(y,k):(zt(),J(f[w],1,1,()=>{f[w]=null}),Ht(),o=f[i],o?o.p(y,k):(o=f[i]=h[i](y),o.c()),Z(o,1),o.m(r,null)),(!a||k&1&&s!==(s=y[0]?"cursor-wait":"cursor-pointer"))&&d(r,"class",s)},i:function(y){a||(Z(u),Z(o),a=!0)},o:function(y){J(u),J(o),a=!1},d:function(y){y&&E(t),u&&u.d(),f[i].d(),e[11](null),c=!1,l()}};return $("SvelteRegisterBlock",{block:p,id:za.name,type:"if",source:"(39:1) {#if loadingRooms && selectedRoom}",ctx:e}),p}function Ci(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k,w;i=new br({$$inline:!0}),h=new kr({$$inline:!0});let m=e[2];tr(m);let b=[];for(let A=0;A<m.length;A+=1)b[A]=Si(_s(e,m,A));const P=A=>J(b[A],1,1,()=>{b[A]=null}),N={c:function(){t=H("div"),n=H("ul"),r=H("li"),wt(i.$$.fragment),o=st(),s=H("span"),a=et("room"),c=st(),l=H("span"),u=st(),wt(h.$$.fragment),f=st(),_=H("span"),p=et("players"),g=st();for(let L=0;L<b.length;L+=1)b[L].c();y=st(),k=H("div"),this.h()},l:function(L){t=F(L,"DIV",{class:!0});var j=O(t);n=F(j,"UL",{class:!0});var U=O(n);r=F(U,"LI",{class:!0});var W=O(r);bt(i.$$.fragment,W),o=at(W),s=F(W,"SPAN",{class:!0});var R=O(s);a=nt(R,"room"),R.forEach(E),c=at(W),l=F(W,"SPAN",{class:!0}),O(l).forEach(E),u=at(W),bt(h.$$.fragment,W),f=at(W),_=F(W,"SPAN",{class:!0});var G=O(_);p=nt(G,"players"),G.forEach(E),W.forEach(E),g=at(U);for(let v=0;v<b.length;v+=1)b[v].l(U);U.forEach(E),y=at(j),k=F(j,"DIV",{class:!0}),O(k).forEach(E),j.forEach(E),this.h()},h:function(){d(s,"class","s-gqfKECxnxVjo"),T(s,Pt,51,7,1916),d(l,"class","s-gqfKECxnxVjo"),T(l,Pt,52,7,1944),d(_,"class","s-gqfKECxnxVjo"),T(_,Pt,54,7,1980),d(r,"class","grid-row gap-2 pb-2 sticky top-0 py-2 bg-blue-600 font-semibold s-gqfKECxnxVjo"),T(r,Pt,49,6,1814),d(n,"class","relative overflow-hidden overflow-y-scroll max-h-72 w-full x-scroll"),T(n,Pt,48,5,1726),d(k,"class","border-t-2 border-t-gray-400 border-opacity-50"),T(k,Pt,78,5,2650),d(t,"class","absolute left-0 right-0 bottom-full rounded-xl bg-blue-600 px-1 overflow-hidden z-0"),T(t,Pt,45,4,1610)},m:function(L,j){rt(L,t,j),C(t,n),C(n,r),kt(i,r,null),C(r,o),C(r,s),C(s,a),C(r,c),C(r,l),C(r,u),kt(h,r,null),C(r,f),C(r,_),C(_,p),C(n,g);for(let U=0;U<b.length;U+=1)b[U]&&b[U].m(n,null);C(t,y),C(t,k),w=!0},p:function(L,j){if(j&262){m=L[2],tr(m);let U;for(U=0;U<m.length;U+=1){const W=_s(L,m,U);b[U]?(b[U].p(W,j),Z(b[U],1)):(b[U]=Si(W),b[U].c(),Z(b[U],1),b[U].m(n,null))}for(zt(),U=m.length;U<b.length;U+=1)P(U);Ht()}},i:function(L){if(!w){Z(i.$$.fragment,L),Z(h.$$.fragment,L);for(let j=0;j<m.length;j+=1)Z(b[j]);w=!0}},o:function(L){J(i.$$.fragment,L),J(h.$$.fragment,L),b=b.filter(Boolean);for(let j=0;j<b.length;j+=1)J(b[j]);w=!1},d:function(L){L&&E(t),Ct(i),Ct(h),Ec(b,L)}};return $("SvelteRegisterBlock",{block:N,id:Ci.name,type:"if",source:"(45:3) {#if !collapsed}",ctx:e}),N}function Ei(e){let t,n;t=new Ba({$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:Ei.name,type:"if",source:"(67:10) {#if room.room_id === $selectedRoomID}",ctx:e}),r}function Si(e){let t,n,r,i,o,s=e[13].room_id+"",a,c,l,u,h,f,_,p=e[13].users_count+"",g,y,k,w,m,b,P,N,A=e[13].room_id===e[1]&&Ei(e);function L(){return e[9](e[13])}const j={c:function(){t=H("li"),n=H("a"),r=H("span"),A&&A.c(),i=st(),o=H("span"),a=et(s),c=st(),l=H("span"),u=st(),h=H("span"),f=st(),_=H("span"),g=et(p),y=et(" / "),k=et(Ce),m=st(),this.h()},l:function(W){t=F(W,"LI",{});var R=O(t);n=F(R,"A",{href:!0,class:!0});var G=O(n);r=F(G,"SPAN",{class:!0});var v=O(r);A&&A.l(v),v.forEach(E),i=at(G),o=F(G,"SPAN",{class:!0});var I=O(o);a=nt(I,s),I.forEach(E),c=at(G),l=F(G,"SPAN",{class:!0}),O(l).forEach(E),u=at(G),h=F(G,"SPAN",{class:!0}),O(h).forEach(E),f=at(G),_=F(G,"SPAN",{class:!0});var S=O(_);g=nt(S,p),y=nt(S," / "),k=nt(S,Ce),S.forEach(E),G.forEach(E),m=at(R),R.forEach(E),this.h()},h:function(){d(r,"class","s-gqfKECxnxVjo"),T(r,Pt,65,9,2341),d(o,"class","s-gqfKECxnxVjo"),T(o,Pt,70,9,2463),d(l,"class","s-gqfKECxnxVjo"),T(l,Pt,71,9,2502),d(h,"class","s-gqfKECxnxVjo"),T(h,Pt,72,9,2521),d(_,"class","s-gqfKECxnxVjo"),T(_,Pt,73,9,2540),d(n,"href","#"),d(n,"class",w="grid-row gap-2 hover:bg-gray-300 "+(e[13].room_id===e[1]?"text-black":"")+" s-gqfKECxnxVjo"),T(n,Pt,59,8,2123),T(t,Pt,57,7,2054)},m:function(W,R){rt(W,t,R),C(t,n),C(n,r),A&&A.m(r,null),C(n,i),C(n,o),C(o,a),C(n,c),C(n,l),C(n,u),C(n,h),C(n,f),C(n,_),C(_,g),C(_,y),C(_,k),C(t,m),b=!0,P||(N=$t(n,"click",Sc(L),!1,!0,!1,!1),P=!0)},p:function(W,R){e=W,e[13].room_id===e[1]?A?R&6&&Z(A,1):(A=Ei(e),A.c(),Z(A,1),A.m(r,null)):A&&(zt(),J(A,1,1,()=>{A=null}),Ht()),(!b||R&4)&&s!==(s=e[13].room_id+"")&&ye(a,s),(!b||R&4)&&p!==(p=e[13].users_count+"")&&ye(g,p),(!b||R&6&&w!==(w="grid-row gap-2 hover:bg-gray-300 "+(e[13].room_id===e[1]?"text-black":"")+" s-gqfKECxnxVjo"))&&d(n,"class",w)},i:function(W){b||(Z(A),b=!0)},o:function(W){J(A),b=!1},d:function(W){W&&E(t),A&&A.d(),P=!1,N()}};return $("SvelteRegisterBlock",{block:j,id:Si.name,type:"each",source:"(57:6) {#each $rooms as room}",ctx:e}),j}function Ha(e){let t,n,r,i,o,s,a,c,l,u;n=new br({$$inline:!0}),s=new kr({$$inline:!0});const h={c:function(){t=H("div"),wt(n.$$.fragment),r=st(),i=H("span"),o=et(`Loading...\r
							`),wt(s.$$.fragment),a=st(),c=H("span"),l=et("... / ..."),this.h()},l:function(_){t=F(_,"DIV",{class:!0});var p=O(t);bt(n.$$.fragment,p),r=at(p),i=F(p,"SPAN",{class:!0});var g=O(i);o=nt(g,`Loading...\r
							`),bt(s.$$.fragment,g),a=at(g),c=F(g,"SPAN",{class:!0});var y=O(c);l=nt(y,"... / ..."),y.forEach(E),g.forEach(E),p.forEach(E),this.h()},h:function(){d(c,"class","s-gqfKECxnxVjo"),T(c,Pt,104,7,3326),d(i,"class","s-gqfKECxnxVjo"),T(i,Pt,101,6,3273),d(t,"class","grid-row gap-2 s-gqfKECxnxVjo"),T(t,Pt,99,5,3221)},m:function(_,p){rt(_,t,p),kt(n,t,null),C(t,r),C(t,i),C(i,o),kt(s,i,null),C(i,a),C(i,c),C(c,l),u=!0},p:mt,i:function(_){u||(Z(n.$$.fragment,_),Z(s.$$.fragment,_),u=!0)},o:function(_){J(n.$$.fragment,_),J(s.$$.fragment,_),u=!1},d:function(_){_&&E(t),Ct(n),Ct(s)}};return $("SvelteRegisterBlock",{block:h,id:Ha.name,type:"else",source:"(99:4) {:else}",ctx:e}),h}function Fa(e){var m,b;let t,n,r,i,o=((m=e[6])==null?void 0:m.room_id)+"",s,a,c,l,u,h,f,_=((b=e[6])==null?void 0:b.users_count)+"",p,g,y,k;n=new br({$$inline:!0}),u=new kr({$$inline:!0});const w={c:function(){t=H("div"),wt(n.$$.fragment),r=st(),i=H("span"),s=et(o),a=st(),c=H("span"),l=st(),wt(u.$$.fragment),h=st(),f=H("span"),p=et(_),g=et(" / "),y=et(Ce),this.h()},l:function(N){t=F(N,"DIV",{class:!0});var A=O(t);bt(n.$$.fragment,A),r=at(A),i=F(A,"SPAN",{class:!0});var L=O(i);s=nt(L,o),L.forEach(E),a=at(A),c=F(A,"SPAN",{class:!0}),O(c).forEach(E),l=at(A),bt(u.$$.fragment,A),h=at(A),f=F(A,"SPAN",{class:!0});var j=O(f);p=nt(j,_),g=nt(j," / "),y=nt(j,Ce),j.forEach(E),A.forEach(E),this.h()},h:function(){d(i,"class","s-gqfKECxnxVjo"),T(i,Pt,89,6,3019),d(c,"class","s-gqfKECxnxVjo"),T(c,Pt,92,6,3080),d(f,"class","s-gqfKECxnxVjo"),T(f,Pt,94,6,3114),d(t,"class","grid-row gap-2 s-gqfKECxnxVjo"),T(t,Pt,87,5,2967)},m:function(N,A){rt(N,t,A),kt(n,t,null),C(t,r),C(t,i),C(i,s),C(t,a),C(t,c),C(t,l),kt(u,t,null),C(t,h),C(t,f),C(f,p),C(f,g),C(f,y),k=!0},p:function(N,A){var L,j;(!k||A&64)&&o!==(o=((L=N[6])==null?void 0:L.room_id)+"")&&ye(s,o),(!k||A&64)&&_!==(_=((j=N[6])==null?void 0:j.users_count)+"")&&ye(p,_)},i:function(N){k||(Z(n.$$.fragment,N),Z(u.$$.fragment,N),k=!0)},o:function(N){J(n.$$.fragment,N),J(u.$$.fragment,N),k=!1},d:function(N){N&&E(t),Ct(n),Ct(u)}};return $("SvelteRegisterBlock",{block:w,id:Fa.name,type:"if",source:"(87:4) {#if selectedRoom}",ctx:e}),w}function xi(e){let t,n,r,i;const o=[za,Va],s=[];function a(l,u){return l[5]&&l[6]?0:1}n=a(e),r=s[n]=o[n](e);const c={c:function(){t=H("div"),r.c(),this.h()},l:function(u){t=F(u,"DIV",{class:!0});var h=O(t);r.l(h),h.forEach(E),this.h()},h:function(){d(t,"class","min-w-[20ch]"),T(t,Pt,37,0,1326)},m:function(u,h){rt(u,t,h),s[n].m(t,null),i=!0},p:function(u,[h]){let f=n;n=a(u),n===f?s[n].p(u,h):(zt(),J(s[f],1,1,()=>{s[f]=null}),Ht(),r=s[n],r?r.p(u,h):(r=s[n]=o[n](u),r.c()),Z(r,1),r.m(t,null))},i:function(u){i||(Z(r),i=!0)},o:function(u){J(r),i=!1},d:function(u){u&&E(t),s[n].d()}};return $("SvelteRegisterBlock",{block:c,id:xi.name,type:"component",source:"",ctx:e}),c}function zp(e,t,n){let r,i,o,s;yt(Vt,"selectedRoomID"),vt(e,Vt,m=>n(1,o=m));let{$$slots:a={},$$scope:c}=t;Rt("RoomsSelector",a,[]);let{isLoading:l=!1}=t,u;const h=Zo();yt(h,"rooms"),vt(e,h,m=>n(2,s=m));let f=!0;function _(m){u&&!u.contains(m.target)&&n(4,f=!0)}Yt(()=>(window.addEventListener("pointerdown",_,!0),()=>{window.removeEventListener("pointerdown",_,!0)}));function p(m){Lt(Vt,o=m.room_id,o),n(4,f=!0);const b=new URLSearchParams(window.location.search);b.set("roomid",m.room_id),window.location.search=b.toString(),window.parent.postMessage({queryString:b.toString()},"*")}const g=["isLoading"];Object.keys(t).forEach(m=>{!~g.indexOf(m)&&m.slice(0,2)!=="$$"&&m!=="slot"&&console.warn(`<RoomsSelector> was created with unknown prop '${m}'`)});const y=m=>p(m),k=()=>l?null:n(4,f=!f);function w(m){Se[m?"unshift":"push"](()=>{u=m,n(3,u)})}return e.$$set=m=>{"isLoading"in m&&n(0,l=m.isLoading)},e.$capture_state=()=>({page:Ac,Room:br,Pin:Ba,People:kr,LoadingIcon:Ae,onMount:Yt,selectedRoomID:Vt,MAX_CAPACITY:Ce,useRooms:Zo,isLoading:l,boxEl:u,rooms:h,collapsed:f,clickHandler:_,changeRoom:p,loadingRooms:i,selectedRoom:r,$selectedRoomID:o,$rooms:s}),e.$inject_state=m=>{"isLoading"in m&&n(0,l=m.isLoading),"boxEl"in m&&n(3,u=m.boxEl),"collapsed"in m&&n(4,f=m.collapsed),"loadingRooms"in m&&n(5,i=m.loadingRooms),"selectedRoom"in m&&n(6,r=m.selectedRoom)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&6&&n(6,r=s.find(m=>m.room_id===o)),e.$$.dirty&4&&n(5,i=s.length>0)},[l,o,s,u,f,i,r,h,p,y,k,w]}class Ka extends Tt{constructor(t){super(t),Ot(this,t,zp,xi,Nt,{isLoading:0}),$("SvelteRegisterComponent",{component:this,tagName:"RoomsSelector",options:t,id:xi.name})}get isLoading(){throw new Error("<RoomsSelector>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isLoading(t){throw new Error("<RoomsSelector>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Dr="src/lib/Icons/IconCommunity.svelte";function Ii(e){let t,n,r;const i={c:function(){t=it("svg"),n=it("path"),r=it("path"),this.h()},l:function(s){t=ot(s,"svg",{class:!0,xmlns:!0,"xmlns:xlink":!0,"aria-hidden":!0,focusable:!0,role:!0,width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var a=O(t);n=ot(a,"path",{d:!0,fill:!0}),O(n).forEach(E),r=ot(a,"path",{d:!0,fill:!0}),O(r).forEach(E),a.forEach(E),this.h()},h:function(){d(n,"d","M20.6081 3C21.7684 3 22.8053 3.49196 23.5284 4.38415C23.9756 4.93678 24.4428 5.82749 24.4808 7.16133C24.9674 7.01707 25.4353 6.93643 25.8725 6.93643C26.9833 6.93643 27.9865 7.37587 28.696 8.17411C29.6075 9.19872 30.0124 10.4579 29.8361 11.7177C29.7523 12.3177 29.5581 12.8555 29.2678 13.3534C29.8798 13.8646 30.3306 14.5763 30.5485 15.4322C30.719 16.1032 30.8939 17.5006 29.9808 18.9403C30.0389 19.0342 30.0934 19.1319 30.1442 19.2318C30.6932 20.3074 30.7283 21.5229 30.2439 22.6548C29.5093 24.3704 27.6841 25.7219 24.1397 27.1727C21.9347 28.0753 19.9174 28.6523 19.8994 28.6575C16.9842 29.4379 14.3477 29.8345 12.0653 29.8345C7.87017 29.8345 4.8668 28.508 3.13831 25.8921C0.356375 21.6797 0.754104 17.8269 4.35369 14.1131C6.34591 12.058 7.67023 9.02782 7.94613 8.36275C8.50224 6.39343 9.97271 4.20438 12.4172 4.20438H12.4179C12.6236 4.20438 12.8314 4.2214 13.0364 4.25468C14.107 4.42854 15.0428 5.06476 15.7115 6.02205C16.4331 5.09583 17.134 4.359 17.7682 3.94323C18.7242 3.31737 19.6794 3 20.6081 3ZM20.6081 5.95917C20.2427 5.95917 19.7963 6.1197 19.3039 6.44225C17.7754 7.44319 14.8258 12.6772 13.7458 14.7131C13.3839 15.3952 12.7655 15.6837 12.2086 15.6837C11.1036 15.6837 10.2408 14.5497 12.1076 13.1085C14.9146 10.9402 13.9299 7.39584 12.5898 7.1776C12.5311 7.16799 12.4731 7.16355 12.4172 7.16355C11.1989 7.16355 10.6615 9.33114 10.6615 9.33114C10.6615 9.33114 9.0863 13.4148 6.38031 16.206C3.67434 18.998 3.5346 21.2388 5.50675 24.2246C6.85185 26.2606 9.42666 26.8753 12.0653 26.8753C14.8021 26.8753 17.6077 26.2139 19.1799 25.793C19.2574 25.7723 28.8193 22.984 27.6081 20.6107C27.4046 20.212 27.0693 20.0522 26.6471 20.0522C24.9416 20.0522 21.8393 22.6726 20.5057 22.6726C20.2076 22.6726 19.9976 22.5416 19.9116 22.222C19.3433 20.1173 28.552 19.2325 27.7758 16.1839C27.639 15.6445 27.2677 15.4256 26.746 15.4263C24.4923 15.4263 19.4358 19.5181 18.3759 19.5181C18.2949 19.5181 18.2368 19.4937 18.2053 19.4419C17.6743 18.557 17.9653 17.9394 21.7082 15.6009C25.4511 13.2617 28.0783 11.8545 26.5841 10.1752C26.4121 9.98141 26.1684 9.8956 25.8725 9.8956C23.6001 9.89634 18.2311 14.9403 18.2311 14.9403C18.2311 14.9403 16.7821 16.496 15.9057 16.496C15.7043 16.496 15.533 16.4139 15.4169 16.2112C14.7956 15.1296 21.1879 10.1286 21.5484 8.06535C21.7928 6.66715 21.3771 5.95917 20.6081 5.95917Z"),d(n,"fill","#FF9D00"),T(n,Dr,15,1,316),d(r,"d","M5.50686 24.2246C3.53472 21.2387 3.67446 18.9979 6.38043 16.206C9.08641 13.4147 10.6615 9.33111 10.6615 9.33111C10.6615 9.33111 11.2499 6.95933 12.59 7.17757C13.93 7.39581 14.9139 10.9401 12.1069 13.1084C9.29997 15.276 12.6659 16.7489 13.7459 14.713C14.8258 12.6772 17.7747 7.44316 19.304 6.44221C20.8326 5.44128 21.9089 6.00204 21.5484 8.06532C21.188 10.1286 14.795 15.1295 15.4171 16.2118C16.0391 17.2934 18.2312 14.9402 18.2312 14.9402C18.2312 14.9402 25.0907 8.49588 26.5842 10.1752C28.0776 11.8545 25.4512 13.2616 21.7082 15.6008C17.9646 17.9393 17.6744 18.557 18.2054 19.4418C18.7372 20.3266 26.9998 13.1351 27.7759 16.1838C28.5513 19.2324 19.3434 20.1173 19.9117 22.2219C20.48 24.3274 26.3979 18.2382 27.6082 20.6107C28.8193 22.9839 19.2574 25.7722 19.18 25.7929C16.0914 26.62 8.24723 28.3726 5.50686 24.2246Z"),d(r,"fill","#FFD21E"),T(r,Dr,19,1,2649),d(t,"class",e[0]),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),d(t,"aria-hidden","true"),d(t,"focusable","false"),d(t,"role","img"),d(t,"width","1em"),d(t,"height","1em"),d(t,"preserveAspectRatio","xMidYMid meet"),d(t,"viewBox","0 0 32 32"),T(t,Dr,3,0,60)},m:function(s,a){rt(s,t,a),C(t,n),C(t,r)},p:function(s,[a]){a&1&&d(t,"class",s[0])},i:mt,o:mt,d:function(s){s&&E(t)}};return $("SvelteRegisterBlock",{block:i,id:Ii.name,type:"component",source:"",ctx:e}),i}function Hp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("IconCommunity",r,[]);let{classNames:o=""}=t;const s=["classNames"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<IconCommunity> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classNames"in a&&n(0,o=a.classNames)},e.$capture_state=()=>({classNames:o}),e.$inject_state=a=>{"classNames"in a&&n(0,o=a.classNames)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class Wa extends Tt{constructor(t){super(t),Ot(this,t,Hp,Ii,Nt,{classNames:0}),$("SvelteRegisterComponent",{component:this,tagName:"IconCommunity",options:t,id:Ii.name})}get classNames(){throw new Error("<IconCommunity>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classNames(t){throw new Error("<IconCommunity>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}let ys=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const{console:Fp}=Qe,vs="src/lib/Buttons/ShareWithCommunity.svelte";function qa(e){let t,n;t=new Wa({$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:qa.name,type:"else",source:"(64:1) {:else}",ctx:e}),r}function $a(e){let t,n;t=new Ae({props:{classList:"animate-spin max-w-[25px] text-white"},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:$a.name,type:"if",source:"(62:1) {#if isUploading}",ctx:e}),r}function Pi(e){let t,n,r,i,o,s,a,c,l,u,h;const f=[$a,qa],_=[];function p(y,k){return y[1]?0:1}n=p(e),r=_[n]=f[n](e);const g={c:function(){t=H("button"),r.c(),i=st(),o=H("p"),s=et("Share to community"),this.h()},l:function(k){t=F(k,"BUTTON",{class:!0,title:!0});var w=O(t);r.l(w),i=at(w),o=F(w,"P",{class:!0});var m=O(o);s=nt(m,"Share to community"),m.forEach(E),w.forEach(E),this.h()},h:function(){d(o,"class","text-white font-semibold"),T(o,vs,66,1,2320),d(t,"class",a=(e[0]||e[1]?"cursor-wait":"cursor-pointer")+" text-xs font-mono flex items-center justify-center bg-black gap-x-1 rounded-xl px-2 py-1 whitespace-nowrap"),t.disabled=c=e[1]||e[0],d(t,"title","Share with community"),T(t,vs,53,0,1899)},m:function(k,w){rt(k,t,w),_[n].m(t,null),C(t,i),C(t,o),C(o,s),l=!0,u||(h=$t(t,"click",e[2],!1,!1,!1,!1),u=!0)},p:function(k,[w]){let m=n;n=p(k),n!==m&&(zt(),J(_[m],1,1,()=>{_[m]=null}),Ht(),r=_[n],r||(r=_[n]=f[n](k),r.c()),Z(r,1),r.m(t,i)),(!l||w&3&&a!==(a=(k[0]||k[1]?"cursor-wait":"cursor-pointer")+" text-xs font-mono flex items-center justify-center bg-black gap-x-1 rounded-xl px-2 py-1 whitespace-nowrap"))&&d(t,"class",a),(!l||w&3&&c!==(c=k[1]||k[0]))&&ur(t,"disabled",c)},i:function(k){l||(Z(r),l=!0)},o:function(k){J(r),l=!1},d:function(k){k&&E(t),_[n].d(),u=!1,h()}};return $("SvelteRegisterBlock",{block:g,id:Pi.name,type:"component",source:"",ctx:e}),g}function Kp(e,t,n){let r,i;yt(Vt,"selectedRoomID"),vt(e,Vt,f=>n(3,r=f)),yt(Qt,"canvasEl"),vt(e,Qt,f=>n(4,i=f));let{$$slots:o={},$$scope:s}=t;Rt("ShareWithCommunity",o,[]);let{isLoading:a=!1}=t,c=!1;async function l(){if(c)return;const f=await new Promise(_=>{i.toBlob(_,"image/jpeg",.95)});n(1,c=!0),await u(f),n(1,c=!1)}async function u(f){let _=null;try{_=await $o(f,{prompt:"canvas",position:{x:0,y:0},date:new Date().getTime(),id:ys(),room:r||"default"})}catch(w){console.error(w)}if(!_){console.error("Failed to upload image");return}const p=`<img src="${_.url}" style="width:100%" width="1000" height="1000">`,g=`#### Stable Diffusion Multiplayer:
### [${r}](https://huggingface.co/spaces/huggingface-projects/stable-diffusion-multiplayer?roomid=${r})
		
<div style="display: flex; overflow: scroll; column-gap: 0.75rem;">
${p}
</div>`,k=new URLSearchParams({title:`Room ${r}`,description:g}).toString();window.open(`https://huggingface.co/spaces/huggingface-projects/stable-diffusion-multiplayer/discussions/new?${k}`,"_blank")}const h=["isLoading"];return Object.keys(t).forEach(f=>{!~h.indexOf(f)&&f.slice(0,2)!=="$$"&&f!=="slot"&&Fp.warn(`<ShareWithCommunity> was created with unknown prop '${f}'`)}),e.$$set=f=>{"isLoading"in f&&n(0,a=f.isLoading)},e.$capture_state=()=>({IconCommunity:Wa,LoadingIcon:Ae,uploadImage:$o,canvasEl:Qt,selectedRoomID:Vt,nanoid:ys,isLoading:a,isUploading:c,handleClick:l,createCommunityPost:u,$selectedRoomID:r,$canvasEl:i}),e.$inject_state=f=>{"isLoading"in f&&n(0,a=f.isLoading),"isUploading"in f&&n(1,c=f.isUploading)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[a,c,l]}class Ya extends Tt{constructor(t){super(t),Ot(this,t,Kp,Pi,Nt,{isLoading:0}),$("SvelteRegisterComponent",{component:this,tagName:"ShareWithCommunity",options:t,id:Pi.name})}get isLoading(){throw new Error("<ShareWithCommunity>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isLoading(t){throw new Error("<ShareWithCommunity>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const pe="src/lib/Buttons/AboutButton.svelte";function Ai(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k,w,m,b,P;w=new Ya({props:{isLoading:e[0]},$$inline:!0});const N={c:function(){t=H("div"),n=H("details"),r=H("summary"),i=et("More"),o=st(),s=H("p"),a=et("Instructions: move the "),c=H("span"),l=et("blue square"),u=et(`,\r
			click "\u{1F58D} Paint".`),h=st(),f=H("div"),_=H("button"),p=it("svg"),g=it("path"),y=et(`\r
				About`),k=st(),wt(w.$$.fragment),this.h()},l:function(L){t=F(L,"DIV",{class:!0});var j=O(t);n=F(j,"DETAILS",{});var U=O(n);r=F(U,"SUMMARY",{class:!0});var W=O(r);i=nt(W,"More"),W.forEach(E),o=at(U),s=F(U,"P",{class:!0});var R=O(s);a=nt(R,"Instructions: move the "),c=F(R,"SPAN",{class:!0});var G=O(c);l=nt(G,"blue square"),G.forEach(E),u=nt(R,`,\r
			click "\u{1F58D} Paint".`),R.forEach(E),h=at(U),f=F(U,"DIV",{class:!0});var v=O(f);_=F(v,"BUTTON",{class:!0});var I=O(_);p=ot(I,"svg",{width:!0,height:!0,viewBox:!0,class:!0});var S=O(p);g=ot(S,"path",{fill:!0,"fill-rule":!0,d:!0,"clip-rule":!0}),O(g).forEach(E),S.forEach(E),y=nt(I,`\r
				About`),I.forEach(E),k=at(v),bt(w.$$.fragment,v),v.forEach(E),U.forEach(E),j.forEach(E),this.h()},h:function(){d(r,"class","md:hidden"),T(r,pe,18,2,514),d(c,"class","text-blue-700 bg-blue-300/60 px-0.5"),T(c,pe,20,26,605),d(s,"class","inline"),T(s,pe,19,2,559),d(g,"fill","currentColor"),d(g,"fill-rule","evenodd"),d(g,"d","M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10s10-4.477 10-10S17.523 2 12 2zm0 7a1 1 0 0 0-1 1a1 1 0 1 1-2 0a3 3 0 1 1 4.44 2.633a1.404 1.404 0 0 0-.383.288a.303.303 0 0 0-.057.085v.494a1 1 0 1 1-2 0V13c0-.58.253-1.047.539-1.38c.281-.33.63-.572.94-.742A1 1 0 0 0 12 9zm.999 4.011v-.004v.005zM12 15a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2H12z"),d(g,"clip-rule","evenodd"),T(g,pe,26,6,886),d(p,"width",".9em"),d(p,"height",".9em"),d(p,"viewBox","0 0 24 24"),d(p,"class","mr-1"),T(p,pe,25,4,814),d(_,"class","items-center inline-flex"),T(_,pe,24,3,758),d(f,"class","flex justify-between py-2 gap-3"),T(f,pe,23,2,708),n.open=e[1],T(n,pe,17,1,494),d(t,"class","md:w-[210px] text-sm md:flex flex-col order-last md:order-none"),T(t,pe,16,0,415)},m:function(L,j){rt(L,t,j),C(t,n),C(n,r),C(r,i),C(n,o),C(n,s),C(s,a),C(s,c),C(c,l),C(s,u),C(n,h),C(n,f),C(f,_),C(_,p),C(p,g),C(_,y),C(f,k),kt(w,f,null),m=!0,b||(P=$t(_,"click",e[2],!1,!1,!1,!1),b=!0)},p:function(L,[j]){const U={};j&1&&(U.isLoading=L[0]),w.$set(U),(!m||j&2)&&ur(n,"open",L[1])},i:function(L){m||(Z(w.$$.fragment,L),m=!0)},o:function(L){J(w.$$.fragment,L),m=!1},d:function(L){L&&E(t),Ct(w),b=!1,P()}};return $("SvelteRegisterBlock",{block:N,id:Ai.name,type:"component",source:"",ctx:e}),N}function Wp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("AboutButton",r,[]);let{isLoading:o=!1}=t,s=!0;Yt(()=>(a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}));function a(){n(1,s=window.innerWidth>768)}const c=["isLoading"];Object.keys(t).forEach(u=>{!~c.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<AboutButton> was created with unknown prop '${u}'`)});function l(u){Yi.call(this,e,u)}return e.$$set=u=>{"isLoading"in u&&n(0,o=u.isLoading)},e.$capture_state=()=>({onMount:Yt,ShareWithCommunity:Ya,isLoading:o,open:s,autoOpen:a}),e.$inject_state=u=>{"isLoading"in u&&n(0,o=u.isLoading),"open"in u&&n(1,s=u.open)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o,s,l]}class Za extends Tt{constructor(t){super(t),Ot(this,t,Wp,Ai,Nt,{isLoading:0}),$("SvelteRegisterComponent",{component:this,tagName:"AboutButton",options:t,id:Ai.name})}get isLoading(){throw new Error("<AboutButton>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isLoading(t){throw new Error("<AboutButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Fe="src/lib/Menu.svelte";function Li(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k;n=new Za({props:{isLoading:e[0]},$$inline:!0}),n.$on("click",e[4]),p=new Ka({props:{isLoading:e[0]},$$inline:!0});const w={c:function(){t=H("div"),wt(n.$$.fragment),r=st(),i=H("button"),o=H("span"),s=et("\u{1F58D}"),a=et(`Paint\r
		`),c=H("span"),l=it("svg"),u=it("path"),h=et(`\r
			Enter`),_=st(),wt(p.$$.fragment),this.h()},l:function(b){t=F(b,"DIV",{class:!0});var P=O(t);bt(n.$$.fragment,P),r=at(P),i=F(P,"BUTTON",{title:!0,class:!0});var N=O(i);o=F(N,"SPAN",{class:!0});var A=O(o);s=nt(A,"\u{1F58D}"),A.forEach(E),a=nt(N,`Paint\r
		`),c=F(N,"SPAN",{class:!0});var L=O(c);l=ot(L,"svg",{class:!0,width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var j=O(l);u=ot(j,"path",{"fill-rule":!0,"clip-rule":!0,d:!0,fill:!0}),O(u).forEach(E),j.forEach(E),h=nt(L,`\r
			Enter`),L.forEach(E),N.forEach(E),_=at(P),bt(p.$$.fragment,P),P.forEach(E),this.h()},h:function(){d(o,"class","mr-3"),T(o,Fe,31,3,1159),d(u,"fill-rule","evenodd"),d(u,"clip-rule","evenodd"),d(u,"d","M8.5 8.5V0H9.5V9.5H1.70711L4.03553 11.8284C4.2308 12.0237 4.2308 12.3403 4.03553 12.5355C3.84027 12.7308 3.52369 12.7308 3.32843 12.5355L0.146447 9.35355C-0.0488155 9.15829 -0.0488155 8.84171 0.146447 8.64645L3.32843 5.46447C3.52369 5.2692 3.84027 5.2692 4.03553 5.46447C4.2308 5.65973 4.2308 5.97631 4.03553 6.17157L1.70711 8.5H8.5Z"),d(u,"fill","currentColor"),T(u,Fe,42,4,1498),d(l,"class","text-sm mr-1.5"),d(l,"width","1em"),d(l,"height","1em"),d(l,"viewBox","0 0 10 13"),d(l,"fill","currentColor"),d(l,"xmlns","http://www.w3.org/2000/svg"),T(l,Fe,34,4,1329),d(c,"class","bg-blue-800 text-gray-300 rounded-lg px-2 py-0.5 text-base ml-4 hidden sm:flex items-center translate-y-[2px]"),T(c,Fe,32,2,1196),d(i,"title","Click to prompt, and paint. The generated image will show up in the frame."),i.disabled=e[0],d(i,"class",f=(e[0]?"cursor-wait":"cursor-pointer")+" order-first md:order-none text-xl md:text-3xl bg-blue-600 text-white px-4 py-1 md:px-6 md:py-2 rounded-2xl ring ring-blue-500 font-semibold shadow-2xl shadow-blue-500 self-center flex items-center hover:saturate-150"),T(i,Fe,24,1,692),d(t,"class","flex flex-col md:flex-row items-center justify-between px-4 md:px-12 gap-3 md:gap-0"),T(t,Fe,16,0,494)},m:function(b,P){rt(b,t,P),kt(n,t,null),C(t,r),C(t,i),C(i,o),C(o,s),C(i,a),C(i,c),C(c,l),C(l,u),C(c,h),C(t,_),kt(p,t,null),g=!0,y||(k=[$t(window,"keypress",e[3],!1,!1,!1,!1),$t(i,"click",e[5],!1,!1,!1,!1)],y=!0)},p:function(b,[P]){const N={};P&1&&(N.isLoading=b[0]),n.$set(N),(!g||P&1)&&ur(i,"disabled",b[0]),(!g||P&1&&f!==(f=(b[0]?"cursor-wait":"cursor-pointer")+" order-first md:order-none text-xl md:text-3xl bg-blue-600 text-white px-4 py-1 md:px-6 md:py-2 rounded-2xl ring ring-blue-500 font-semibold shadow-2xl shadow-blue-500 self-center flex items-center hover:saturate-150"))&&d(i,"class",f);const A={};P&1&&(A.isLoading=b[0]),p.$set(A)},i:function(b){g||(Z(n.$$.fragment,b),Z(p.$$.fragment,b),g=!0)},o:function(b){J(n.$$.fragment,b),J(p.$$.fragment,b),g=!1},d:function(b){b&&E(t),Ct(n),Ct(p),y=!1,$i(k)}};return $("SvelteRegisterBlock",{block:w,id:Li.name,type:"component",source:"",ctx:e}),w}function qp(e,t,n){let r;yt(ke,"toggleAbout"),vt(e,ke,f=>n(1,r=f));let{$$slots:i={},$$scope:o}=t;Rt("Menu",i,[]);const s=Ee();let{isLoading:a=!1}=t;const c=["isLoading"];Object.keys(t).forEach(f=>{!~c.indexOf(f)&&f.slice(0,2)!=="$$"&&f!=="slot"&&console.warn(`<Menu> was created with unknown prop '${f}'`)});const l=f=>{f.key==="Enter"&&s("showModal",{showModal:!0})},u=()=>{Lt(ke,r=!r,r)},h=()=>s("showModal",{showModal:!0});return e.$$set=f=>{"isLoading"in f&&n(0,a=f.isLoading)},e.$capture_state=()=>({RoomsSelector:Ka,AboutButton:Za,toggleAbout:ke,createEventDispatcher:Ee,dispatch:s,isLoading:a,$toggleAbout:r}),e.$inject_state=f=>{"isLoading"in f&&n(0,a=f.isLoading)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[a,r,s,l,u,h]}class Xa extends Tt{constructor(t){super(t),Ot(this,t,qp,Li,Nt,{isLoading:0}),$("SvelteRegisterComponent",{component:this,tagName:"Menu",options:t,id:Li.name})}get isLoading(){throw new Error("<Menu>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isLoading(t){throw new Error("<Menu>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const sn="src/lib/PromptModal.svelte";function Ti(e){let t,n,r,i,o,s,a,c,l,u;const h={c:function(){t=H("form"),n=H("div"),r=H("input"),i=st(),o=H("button"),s=H("span"),a=et("\u{1F58D}"),c=et(" Paint"),this.h()},l:function(_){t=F(_,"FORM",{class:!0});var p=O(t);n=F(p,"DIV",{class:!0});var g=O(n);r=F(g,"INPUT",{class:!0,placeholder:!0,title:!0,type:!0,name:!0}),i=at(g),o=F(g,"BUTTON",{class:!0,type:!0,title:!0});var y=O(o);s=F(y,"SPAN",{class:!0});var k=O(s);a=nt(k,"\u{1F58D}"),k.forEach(E),c=nt(y," Paint"),y.forEach(E),g.forEach(E),p.forEach(E),this.h()},h:function(){r.value=e[0],d(r,"class","flex-1 outline-none ring-0 border-none text-xl 2xl:text-2xl py-3 px-3"),d(r,"placeholder","Prompt and <Negative Prompt> between < >"),d(r,"title","Input prompt to generate image and  negative prompt inside brackets <NEGATIVE PROMPT>"),d(r,"type","text"),d(r,"name","prompt"),T(r,sn,66,2,1828),d(s,"class","mr-2"),T(s,sn,81,4,2468),d(o,"class","font-semibold bg-blue-700 text-white border-l-2 px-5 text-xl 2xl:text-2xl spacing tracking-wide hover:saturate-150"),d(o,"type","submit"),d(o,"title","Input prompt to generate image and  negative prompt inside brackets <NEGATIVE PROMPT>"),T(o,sn,77,2,2212),d(n,"class","flex bg-white overflow-hidden rounded-2xl w-full max-w-lg 2xl:max-w-xl"),T(n,sn,62,1,1713),d(t,"class","fixed w-screen top-0 left-0 bottom-0 right-0 h-screen z-50 flex items-center justify-center bg-black bg-opacity-80"),T(t,sn,58,0,1554)},m:function(_,p){rt(_,t,p),C(t,n),C(n,r),e[7](r),C(n,i),C(n,o),C(o,s),C(s,a),C(o,c),e[8](n),l||(u=[$t(r,"click",xc(e[6]),!1,!1,!0,!1),$t(r,"input",e[4],!1,!1,!1,!1),$t(t,"submit",e[3],!1,!1,!1,!1)],l=!0)},p:function(_,[p]){p&1&&r.value!==_[0]&&ur(r,"value",_[0])},i:mt,o:mt,d:function(_){_&&E(t),e[7](null),e[8](null),l=!1,$i(u)}};return $("SvelteRegisterBlock",{block:h,id:Ti.name,type:"component",source:"",ctx:e}),h}function $p(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("PromptModal",r,[]);const o=Ee();let{initPrompt:s=""}=t,a,c,l;const u=Pe(),h=P=>{P.key==="Escape"&&o("showModal",{showModal:!1})};Yt(()=>(c.focus(),n(0,a=s),window.addEventListener("keyup",h),window.addEventListener("pointerdown",y,!0),()=>{window.removeEventListener("keyup",h),window.removeEventListener("pointerdown",y,!0)}));let f;function _(P){clearTimeout(f),f=setTimeout(()=>{n(0,a=P),u.update({currentPrompt:a,status:ht.prompting})},100)}function p(P){P.stopPropagation(),P.preventDefault(),P.stopImmediatePropagation(),a.trim()!==""&&o("paint")}function g(P){const N=P.target;_(N.value)}function y(P){l.contains(P.target)||(u.update({status:ht.ready}),o("showModal",{showModal:!1}))}const k=["initPrompt"];Object.keys(t).forEach(P=>{!~k.indexOf(P)&&P.slice(0,2)!=="$$"&&P!=="slot"&&console.warn(`<PromptModal> was created with unknown prop '${P}'`)});function w(P){Yi.call(this,e,P)}function m(P){Se[P?"unshift":"push"](()=>{c=P,n(1,c)})}function b(P){Se[P?"unshift":"push"](()=>{l=P,n(2,l)})}return e.$$set=P=>{"initPrompt"in P&&n(5,s=P.initPrompt)},e.$capture_state=()=>({createEventDispatcher:Ee,onMount:Yt,useMyPresence:Pe,Status:ht,dispatch:o,initPrompt:s,prompt:a,inputEl:c,boxEl:l,myPresence:u,onKeyup:h,timer:f,debouce:_,onPrompt:p,onInput:g,cancelHandler:y}),e.$inject_state=P=>{"initPrompt"in P&&n(5,s=P.initPrompt),"prompt"in P&&n(0,a=P.prompt),"inputEl"in P&&n(1,c=P.inputEl),"boxEl"in P&&n(2,l=P.boxEl),"timer"in P&&(f=P.timer)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[a,c,l,p,g,s,w,m,b]}class Ga extends Tt{constructor(t){super(t),Ot(this,t,$p,Ti,Nt,{initPrompt:5}),$("SvelteRegisterComponent",{component:this,tagName:"PromptModal",options:t,id:Ti.name})}get initPrompt(){throw new Error("<PromptModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set initPrompt(t){throw new Error("<PromptModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{console:Yp}=Qe,Kn="src/lib/App.svelte";function Wn(e,t,n){const r=e.slice();return r[18]=t[n].connectionId,r[19]=t[n].presence,r}function Oi(e){var i;let t,n;t=new Ga({props:{initPrompt:(i=e[0])==null?void 0:i.currentPrompt},$$inline:!0}),t.$on("paint",e[10]),t.$on("showModal",e[9]);const r={c:function(){wt(t.$$.fragment)},l:function(s){bt(t.$$.fragment,s)},m:function(s,a){kt(t,s,a),n=!0},p:function(s,a){var l;const c={};a&1&&(c.initPrompt=(l=s[0])==null?void 0:l.currentPrompt),t.$set(c)},i:function(s){n||(Z(t.$$.fragment,s),n=!0)},o:function(s){J(t.$$.fragment,s),n=!1},d:function(s){Ct(t,s)}};return $("SvelteRegisterBlock",{block:r,id:Oi.name,type:"if",source:"(181:0) {#if showModal}",ctx:e}),r}function Ni(e){let t=[],n=new Map,r,i,o=[...e[4]];tr(o);const s=c=>c[18];go(e,o,Wn,s);for(let c=0;c<o.length;c+=1){let l=Wn(e,o,c),u=s(l);n.set(u,t[c]=Di(u,l))}const a={c:function(){for(let l=0;l<t.length;l+=1)t[l].c();r=ce()},l:function(l){for(let u=0;u<t.length;u+=1)t[u].l(l);r=ce()},m:function(l,u){for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(l,u);rt(l,r,u),i=!0},p:function(l,u){u&48&&(o=[...l[4]],tr(o),zt(),go(l,o,Wn,s),t=Ic(t,u,s,1,l,o,n,r.parentNode,Pc,Di,r,Wn),Ht())},i:function(l){if(!i){for(let u=0;u<o.length;u+=1)Z(t[u]);i=!0}},o:function(l){for(let u=0;u<t.length;u+=1)J(t[u]);i=!1},d:function(l){for(let u=0;u<t.length;u+=1)t[u].d(l);l&&E(r)}};return $("SvelteRegisterBlock",{block:a,id:Ni.name,type:"if",source:"(193:2) {#if $others}",ctx:e}),a}function Ri(e){var i,o;let t,n;t=new aa({props:{status:e[19].status,position:(i=e[19])==null?void 0:i.frame,prompt:(o=e[19])==null?void 0:o.currentPrompt,transform:e[5]},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(a){bt(t.$$.fragment,a)},m:function(a,c){kt(t,a,c),n=!0},p:function(a,c){var u,h;const l={};c&16&&(l.status=a[19].status),c&16&&(l.position=(u=a[19])==null?void 0:u.frame),c&16&&(l.prompt=(h=a[19])==null?void 0:h.currentPrompt),c&32&&(l.transform=a[5]),t.$set(l)},i:function(a){n||(Z(t.$$.fragment,a),n=!0)},o:function(a){J(t.$$.fragment,a),n=!1},d:function(a){Ct(t,a)}};return $("SvelteRegisterBlock",{block:r,id:Ri.name,type:"if",source:"(195:4) {#if (presence?.status === Status.loading || presence?.status === Status.prompting || presence?.status === Status.masking) && presence?.frame}",ctx:e}),r}function Mi(e){var i;let t,n;t=new ra({props:{color:ln[1+e[18]%(ln.length-1)],position:(i=e[19])==null?void 0:i.cursor,transform:e[5]},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(s){bt(t.$$.fragment,s)},m:function(s,a){kt(t,s,a),n=!0},p:function(s,a){var l;const c={};a&16&&(c.color=ln[1+s[18]%(ln.length-1)]),a&16&&(c.position=(l=s[19])==null?void 0:l.cursor),a&32&&(c.transform=s[5]),t.$set(c)},i:function(s){n||(Z(t.$$.fragment,s),n=!0)},o:function(s){J(t.$$.fragment,s),n=!1},d:function(s){Ct(t,s)}};return $("SvelteRegisterBlock",{block:r,id:Mi.name,type:"if",source:"(203:4) {#if presence?.cursor}",ctx:e}),r}function Di(e,t){var l,u,h,f,_;let n,r,i,o,s=(((l=t[19])==null?void 0:l.status)===ht.loading||((u=t[19])==null?void 0:u.status)===ht.prompting||((h=t[19])==null?void 0:h.status)===ht.masking)&&((f=t[19])==null?void 0:f.frame)&&Ri(t),a=((_=t[19])==null?void 0:_.cursor)&&Mi(t);const c={key:e,first:null,c:function(){n=ce(),s&&s.c(),r=st(),a&&a.c(),i=ce(),this.h()},l:function(g){n=ce(),s&&s.l(g),r=at(g),a&&a.l(g),i=ce(),this.h()},h:function(){this.first=n},m:function(g,y){rt(g,n,y),s&&s.m(g,y),rt(g,r,y),a&&a.m(g,y),rt(g,i,y),o=!0},p:function(g,y){var k,w,m,b,P;t=g,(((k=t[19])==null?void 0:k.status)===ht.loading||((w=t[19])==null?void 0:w.status)===ht.prompting||((m=t[19])==null?void 0:m.status)===ht.masking)&&((b=t[19])==null?void 0:b.frame)?s?(s.p(t,y),y&16&&Z(s,1)):(s=Ri(t),s.c(),Z(s,1),s.m(r.parentNode,r)):s&&(zt(),J(s,1,1,()=>{s=null}),Ht()),(P=t[19])!=null&&P.cursor?a?(a.p(t,y),y&16&&Z(a,1)):(a=Mi(t),a.c(),Z(a,1),a.m(i.parentNode,i)):a&&(zt(),J(a,1,1,()=>{a=null}),Ht())},i:function(g){o||(Z(s),Z(a),o=!0)},o:function(g){J(s),J(a),o=!1},d:function(g){g&&E(n),s&&s.d(g),g&&E(r),a&&a.d(g),g&&E(i)}};return $("SvelteRegisterBlock",{block:c,id:Di.name,type:"each",source:"(194:3) {#each [...$others] as { connectionId, presence }",ctx:t}),c}function Ui(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g=e[1]&&Oi(e);s=new ja({$$inline:!0});let y=e[4]&&Ni(e);u=new Ua({props:{transform:e[5]},$$inline:!0}),u.$on("showModal",e[9]),_=new Xa({props:{isLoading:e[2]},$$inline:!0}),_.$on("showModal",e[9]);const k={c:function(){t=H("div"),n=et(e[3]),r=st(),g&&g.c(),i=st(),o=H("div"),wt(s.$$.fragment),a=st(),c=H("main"),y&&y.c(),l=st(),wt(u.$$.fragment),h=st(),f=H("div"),wt(_.$$.fragment),this.h()},l:function(m){t=F(m,"DIV",{class:!0});var b=O(t);n=nt(b,e[3]),b.forEach(E),r=at(m),g&&g.l(m),i=at(m),o=F(m,"DIV",{class:!0});var P=O(o);bt(s.$$.fragment,P),a=at(P),c=F(P,"MAIN",{class:!0});var N=O(c);y&&y.l(N),l=at(N),bt(u.$$.fragment,N),N.forEach(E),P.forEach(E),h=at(m),f=F(m,"DIV",{class:!0});var A=O(f);bt(_.$$.fragment,A),A.forEach(E),this.h()},h:function(){d(t,"class","text touch-none pointer-events-none"),T(t,Kn,177,0,6478),d(c,"class","z-10 relative"),T(c,Kn,190,1,6785),d(o,"class","fixed top-0 left-0 z-0 w-screen h-screen min-h-[600px]"),T(o,Kn,187,0,6694),d(f,"class","fixed bottom-0 md:bottom-16 left-0 right-0 z-10 my-2"),T(f,Kn,214,0,7622)},m:function(m,b){rt(m,t,b),C(t,n),rt(m,r,b),g&&g.m(m,b),rt(m,i,b),rt(m,o,b),kt(s,o,null),C(o,a),C(o,c),y&&y.m(c,null),C(c,l),kt(u,c,null),rt(m,h,b),rt(m,f,b),kt(_,f,null),p=!0},p:function(m,[b]){(!p||b&8)&&ye(n,m[3]),m[1]?g?(g.p(m,b),b&2&&Z(g,1)):(g=Oi(m),g.c(),Z(g,1),g.m(i.parentNode,i)):g&&(zt(),J(g,1,1,()=>{g=null}),Ht()),m[4]?y?(y.p(m,b),b&16&&Z(y,1)):(y=Ni(m),y.c(),Z(y,1),y.m(c,l)):y&&(zt(),J(y,1,1,()=>{y=null}),Ht());const P={};b&32&&(P.transform=m[5]),u.$set(P);const N={};b&4&&(N.isLoading=m[2]),_.$set(N)},i:function(m){p||(Z(g),Z(s.$$.fragment,m),Z(y),Z(u.$$.fragment,m),Z(_.$$.fragment,m),p=!0)},o:function(m){J(g),J(s.$$.fragment,m),J(y),J(u.$$.fragment,m),J(_.$$.fragment,m),p=!1},d:function(m){m&&E(t),m&&E(r),g&&g.d(m),m&&E(i),m&&E(o),Ct(s),y&&y.d(),Ct(u),m&&E(h),m&&E(f),Ct(_)}};return $("SvelteRegisterBlock",{block:k,id:Ui.name,type:"component",source:"",ctx:e}),k}function ws(e){return`${e.x}_${e.y}`}function Zp(e,t,n){let r,i,o,s,a,c,l,u,h;yt(Dt,"loadingState"),vt(e,Dt,L=>n(3,i=L)),yt(Ne,"maskEl"),vt(e,Ne,L=>n(13,s=L)),yt(Vt,"selectedRoomID"),vt(e,Vt,L=>n(14,a=L)),yt(te,"isRenderingCanvas"),vt(e,te,L=>n(11,u=L)),yt(Oe,"currZoomTransform"),vt(e,Oe,L=>n(5,h=L));let{$$slots:f={},$$scope:_}=t;Rt("App",f,[]);const p=Pe();yt(p,"myPresence"),vt(e,p,L=>n(0,c=L));const g=Yo();yt(g,"others"),vt(e,g,L=>n(4,l=L));let y=!1;const k=ir("promptImgStorage");yt(k,"promptImgStorage"),vt(e,k,L=>n(12,o=L));function w(L){r||(n(1,y=L.detail.showModal),y?p.update({status:ht.prompting}):p.update({status:ht.ready}))}function m(){n(1,y=!1),N()}function b(L){if(!l)return!0;let j=!0;for(const{presence:U}of l)if(L.x<U.frame.x+dt&&L.x+dt>U.frame.x&&L.y<U.frame.y+dt&&L.y+dt>U.frame.y){if(U.status===ht.ready||U.status===ht.dragging){j=!0;continue}j=!1;break}return j}function P(L=5e3){setTimeout(()=>{Lt(Dt,i="",i)},L)}async function N(){if(r)return;const L=c.currentPrompt,j=c.frame;if(Lt(Dt,i="Pending",i),!b(j)){Lt(Dt,i="Someone is already painting here",i),p.update({status:ht.ready}),P();return}const U=ws(j),W=a||"default";console.log("Generating...",L,j),p.update({status:ht.loading});const R=crypto.randomUUID(),G=s.toDataURL("image/webp"),v={fn_index:0,session_hash:R},I={data:[G,L,.75,7.5,25,"patchmatch",W,U]},S=new WebSocket(Wo);S.onclose=z=>{z.wasClean||(Lt(Dt,i="Error",i),p.update({status:ht.ready}))},S.onmessage=async function(z){try{const K=JSON.parse(z.data);switch(Lt(Dt,i="",i),K.msg){case"send_hash":S.send(JSON.stringify(v));break;case"send_data":Lt(Dt,i="Sending Data",i),S.send(JSON.stringify({...v,...I}));break;case"queue_full":Lt(Dt,i="Queue full",i),S.close(),p.update({status:ht.ready});return;case"estimation":const{rank:q,queue_size:V}=K;Lt(Dt,i=`On queue ${q}/${V}`,i);break;case"process_generating":Lt(Dt,i=K.success?"Generating":"Error",i);break;case"process_completed":try{const Y=K.output.data[0];if(Y.is_nsfw)throw new Error("NFSW");const D={imgURL:Y.image.filename};o.set(U,new Gt(D)),console.log(Y.image.url),Lt(Dt,i=K.success?"Complete":"Error",i),P(),p.update({status:ht.ready,currentPrompt:""})}catch(Y){const Q=Y;Lt(Dt,i=Q==null?void 0:Q.message,i),p.update({status:ht.ready}),P(1e4)}S.close();return;case"process_starts":Lt(Dt,i="Processing",i);break}}catch(K){console.error(K),Lt(Dt,i="Error",i)}}}const A=[];return Object.keys(t).forEach(L=>{!~A.indexOf(L)&&L.slice(0,2)!=="$$"&&L!=="slot"&&Yp.warn(`<App> was created with unknown prop '${L}'`)}),e.$capture_state=()=>({Cursor:ra,Frame:aa,PaintFrame:Ua,PaintCanvas:ja,Menu:Xa,PromptModal:Ga,COLORS:ln,FRAME_SIZE:dt,PUBLIC_WS_INPAINTING:Wo,Status:ht,LiveObject:Gt,loadingState:Dt,currZoomTransform:Oe,maskEl:Ne,selectedRoomID:Vt,isRenderingCanvas:te,useMyPresence:Pe,useObject:ir,useOthers:Yo,myPresence:p,others:g,showModal:y,getKey:ws,promptImgStorage:k,onShowModal:w,onPaint:m,canPaint:b,clearStateMsg:P,generateImage:N,isLoading:r,$loadingState:i,$promptImgStorage:o,$maskEl:s,$selectedRoomID:a,$myPresence:c,$others:l,$isRenderingCanvas:u,$currZoomTransform:h}),e.$inject_state=L=>{"showModal"in L&&n(1,y=L.showModal),"isLoading"in L&&n(2,r=L.isLoading)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&2049&&n(2,r=(c==null?void 0:c.status)===ht.loading||u||!1)},[c,y,r,i,l,h,p,g,k,w,m,u]}class Ja extends Tt{constructor(t){super(t),Ot(this,t,Zp,Ui,Nt,{}),$("SvelteRegisterComponent",{component:this,tagName:"App",options:t,id:Ui.name})}}const Et="src/lib/Icons/LiveBlocks.svelte";function ji(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k,w,m,b,P,N,A,L,j,U,W;const R={c:function(){t=it("svg"),n=it("rect"),r=it("path"),i=it("path"),o=it("path"),s=it("path"),a=it("path"),c=it("path"),l=it("path"),u=it("path"),h=it("path"),f=it("path"),_=it("path"),p=it("path"),g=it("path"),y=it("path"),k=it("path"),w=it("path"),m=it("path"),b=it("path"),P=it("path"),N=it("path"),A=it("path"),L=it("defs"),j=it("radialGradient"),U=it("stop"),W=it("stop"),this.h()},l:function(v){t=ot(v,"svg",{class:!0,width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var I=O(t);n=ot(I,"rect",{opacity:!0,x:!0,y:!0,width:!0,height:!0,rx:!0,fill:!0,stroke:!0,"stroke-width":!0}),O(n).forEach(E),r=ot(I,"path",{d:!0,fill:!0}),O(r).forEach(E),i=ot(I,"path",{d:!0,fill:!0}),O(i).forEach(E),o=ot(I,"path",{d:!0,fill:!0}),O(o).forEach(E),s=ot(I,"path",{d:!0,fill:!0}),O(s).forEach(E),a=ot(I,"path",{d:!0,fill:!0}),O(a).forEach(E),c=ot(I,"path",{d:!0,fill:!0}),O(c).forEach(E),l=ot(I,"path",{d:!0,fill:!0}),O(l).forEach(E),u=ot(I,"path",{d:!0,fill:!0}),O(u).forEach(E),h=ot(I,"path",{d:!0,fill:!0}),O(h).forEach(E),f=ot(I,"path",{d:!0,fill:!0}),O(f).forEach(E),_=ot(I,"path",{d:!0,fill:!0}),O(_).forEach(E),p=ot(I,"path",{d:!0,fill:!0}),O(p).forEach(E),g=ot(I,"path",{d:!0,fill:!0}),O(g).forEach(E),y=ot(I,"path",{d:!0,fill:!0}),O(y).forEach(E),k=ot(I,"path",{d:!0,fill:!0}),O(k).forEach(E),w=ot(I,"path",{d:!0,fill:!0}),O(w).forEach(E),m=ot(I,"path",{d:!0,fill:!0}),O(m).forEach(E),b=ot(I,"path",{d:!0,fill:!0}),O(b).forEach(E),P=ot(I,"path",{d:!0,fill:!0}),O(P).forEach(E),N=ot(I,"path",{d:!0,fill:!0}),O(N).forEach(E),A=ot(I,"path",{"fill-rule":!0,"clip-rule":!0,d:!0,fill:!0}),O(A).forEach(E),L=ot(I,"defs",{});var S=O(L);j=ot(S,"radialGradient",{id:!0,cx:!0,cy:!0,r:!0,gradientUnits:!0,gradientTransform:!0});var z=O(j);U=ot(z,"stop",{"stop-color":!0}),O(U).forEach(E),W=ot(z,"stop",{offset:!0,"stop-color":!0}),O(W).forEach(E),z.forEach(E),S.forEach(E),I.forEach(E),this.h()},h:function(){d(n,"opacity","0.5"),d(n,"x","0.25"),d(n,"y","0.25"),d(n,"width","122.5"),d(n,"height","43.5"),d(n,"rx","6.75"),d(n,"fill","#1F2937"),d(n,"stroke","#3A4C64"),d(n,"stroke-width","0.5"),T(n,Et,11,1,191),d(r,"d","M44.9102 16.8569H45.8514V14.778H47.1691C48.364 14.778 49.1497 14.0577 49.1497 12.9528C49.1497 11.8397 48.364 11.1277 47.1691 11.1277H44.9102V16.8569ZM47.0954 11.9461C47.7666 11.9461 48.1921 12.3308 48.1921 12.9528C48.1921 13.5667 47.7584 13.9595 47.0872 13.9595H45.8514V11.9461H47.0954Z"),d(r,"fill","#A3BAD9"),T(r,Et,22,1,352),d(i,"d","M51.5649 16.9059C52.8417 16.9059 53.701 16.0465 53.701 14.7615C53.701 13.4847 52.8417 12.6172 51.5649 12.6172C50.2881 12.6172 49.4287 13.4847 49.4287 14.7615C49.4287 16.0465 50.2881 16.9059 51.5649 16.9059ZM51.5649 16.1529C50.8201 16.1529 50.3372 15.5718 50.3372 14.7615C50.3372 13.9513 50.8201 13.3702 51.5649 13.3702C52.3097 13.3702 52.8007 13.9513 52.8007 14.7615C52.8007 15.5718 52.3097 16.1529 51.5649 16.1529Z"),d(i,"fill","#A3BAD9"),T(i,Et,26,1,677),d(o,"d","M55.233 16.857H56.1906L57.1073 14.0088L57.9912 16.857H58.9406L60.332 12.6665H59.4317L58.4414 15.8748L57.5247 12.6665H56.7144L55.7568 15.8748L54.7992 12.6665H53.8662L55.233 16.857Z"),d(o,"fill","#A3BAD9"),T(o,Et,30,1,1131),d(s,"d","M62.6424 16.9059C63.6818 16.9059 64.3857 16.2757 64.533 15.449H63.6491C63.5263 15.9156 63.1335 16.1856 62.5933 16.1856C61.8976 16.1856 61.4475 15.7191 61.4229 15.0071V14.9498H64.5821C64.5985 14.8352 64.6067 14.7206 64.6067 14.6142C64.5821 13.3865 63.7719 12.6172 62.5605 12.6172C61.3247 12.6172 60.498 13.4766 60.498 14.7697C60.498 16.0547 61.3247 16.9059 62.6424 16.9059ZM61.4556 14.3032C61.5211 13.7057 62.004 13.3292 62.5687 13.3292C63.1826 13.3292 63.6164 13.6812 63.69 14.3032H61.4556Z"),d(s,"fill","#A3BAD9"),T(s,Et,34,1,1349),d(a,"d","M67.4411 12.6665C66.7536 12.6665 66.418 12.9448 66.2052 13.2967L66.107 12.6665H65.3213V16.857H66.2052V14.7536C66.2052 14.107 66.4589 13.4931 67.2447 13.4931H67.6375V12.6665H67.4411Z"),d(a,"fill","#A3BAD9"),T(a,Et,38,1,1878),d(c,"d","M69.9725 16.9059C71.0119 16.9059 71.7158 16.2757 71.8631 15.449H70.9792C70.8564 15.9156 70.4635 16.1856 69.9234 16.1856C69.2277 16.1856 68.7775 15.7191 68.753 15.0071V14.9498H71.9122C71.9286 14.8352 71.9368 14.7206 71.9368 14.6142C71.9122 13.3865 71.1019 12.6172 69.8906 12.6172C68.6548 12.6172 67.8281 13.4766 67.8281 14.7697C67.8281 16.0547 68.6548 16.9059 69.9725 16.9059ZM68.7857 14.3032C68.8512 13.7057 69.3341 13.3292 69.8988 13.3292C70.5127 13.3292 70.9464 13.6812 71.0201 14.3032H68.7857Z"),d(c,"fill","#A3BAD9"),T(c,Et,42,1,2098),d(l,"d","M75.8352 13.2475C75.5651 12.8792 75.1149 12.6173 74.4765 12.6173C73.3391 12.6173 72.4961 13.4685 72.4961 14.7616C72.4961 16.1039 73.3391 16.906 74.4765 16.906C75.1395 16.906 75.5733 16.5949 75.8433 16.2266L75.9497 16.8569H76.7191V11.1277H75.8352V13.2475ZM74.6238 16.1612C73.8875 16.1612 73.4046 15.5883 73.4046 14.7616C73.4046 13.9432 73.8875 13.3702 74.6238 13.3702C75.3605 13.3702 75.8433 13.9432 75.8433 14.778C75.8433 15.5883 75.3605 16.1612 74.6238 16.1612Z"),d(l,"fill","#A3BAD9"),T(l,Et,46,1,2633),d(u,"d","M81.9193 12.6173C81.2727 12.6173 80.839 12.9119 80.5607 13.2884V11.1277H79.6768V16.8569H80.4461L80.5525 16.2512C80.8144 16.6277 81.2646 16.906 81.9193 16.906C83.0652 16.906 83.9 16.0466 83.9 14.7616C83.9 13.4112 83.0652 12.6173 81.9193 12.6173ZM81.772 16.1612C81.0354 16.1612 80.5525 15.5801 80.5525 14.7534C80.5525 13.9432 81.0354 13.3702 81.772 13.3702C82.5086 13.3702 82.9997 13.9432 82.9997 14.7616C82.9997 15.5883 82.5086 16.1612 81.772 16.1612Z"),d(u,"fill","#A3BAD9"),T(u,Et,50,1,3134),d(h,"d","M85.6277 16.8815L85.4641 17.2908C85.3331 17.6345 85.2513 17.7164 84.9075 17.7164H84.2855V18.4939H85.2349C85.8487 18.4939 86.0288 18.1911 86.2907 17.5117L88.1895 12.6665H87.2483L86.1106 15.8503L84.9402 12.6665H83.999L85.6277 16.8815Z"),d(h,"fill","#A3BAD9"),T(h,Et,54,1,3623),d(f,"d","M45.1162 32.4821H47.2144V22.0654H45.1162V32.4821Z"),d(f,"fill","#A3BAD9"),T(f,Et,58,1,3894),d(_,"d","M49.7329 24.0148C50.4175 24.0148 50.9532 23.5088 50.9532 22.8392C50.9532 22.1546 50.4175 21.6487 49.7329 21.6487C49.0484 21.6487 48.5127 22.1546 48.5127 22.8392C48.5127 23.5088 49.0484 24.0148 49.7329 24.0148ZM48.6764 32.482H50.7895V24.8332H48.6764V32.482Z"),d(_,"fill","#A3BAD9"),T(_,Et,59,1,3974),d(p,"d","M54.2461 32.4823H56.8503L59.6033 24.8335H57.4009L55.5854 30.3394L53.7402 24.8335H51.4932L54.2461 32.4823Z"),d(p,"fill","#A3BAD9"),T(p,Et,63,1,4269),d(g,"d","M63.718 32.5713C65.7567 32.5713 67.0811 31.3808 67.3192 29.8927H65.2507C65.0722 30.607 64.4769 30.979 63.6287 30.979C62.5722 30.979 61.8728 30.3243 61.8281 29.2379V29.1338H67.3787C67.4234 28.8957 67.4382 28.6427 67.4382 28.4195C67.4085 26.1725 65.8609 24.7439 63.5692 24.7439C61.2031 24.7439 59.6406 26.2915 59.6406 28.6725C59.6406 31.0385 61.1734 32.5713 63.718 32.5713ZM61.8728 27.7647C61.9918 26.857 62.6763 26.3064 63.5841 26.3064C64.5365 26.3064 65.1763 26.8272 65.3251 27.7647H61.8728Z"),d(g,"fill","#A3BAD9"),T(g,Et,67,1,4413),d(y,"d","M72.9898 24.744C71.9332 24.744 71.1891 25.1904 70.6832 25.8005V22.0654H68.585V32.4821H70.4153L70.6237 31.4404C71.1148 32.0952 71.8737 32.5714 72.9749 32.5714C75.0434 32.5714 76.5315 31.0089 76.5315 28.6428C76.5315 26.2172 75.0434 24.744 72.9898 24.744ZM72.5136 30.8601C71.3678 30.8601 70.6534 29.9523 70.6534 28.6428C70.6534 27.3482 71.3678 26.4553 72.5136 26.4553C73.6594 26.4553 74.4035 27.3482 74.4035 28.6577C74.4035 29.9672 73.6594 30.8601 72.5136 30.8601Z"),d(y,"fill","#A3BAD9"),T(y,Et,71,1,4943),d(k,"d","M77.6973 32.4821H79.7955V22.0654H77.6973V32.4821Z"),d(k,"fill","#A3BAD9"),T(k,Et,75,1,5443),d(w,"d","M84.9927 32.5713C87.4332 32.5713 89.0254 31.0237 89.0254 28.6576C89.0254 26.3064 87.4332 24.7439 84.9927 24.7439C82.5522 24.7439 80.96 26.3064 80.96 28.6576C80.96 31.0088 82.5522 32.5713 84.9927 32.5713ZM84.9927 30.86C83.8171 30.86 83.1028 29.9522 83.1028 28.6576C83.1028 27.3629 83.8171 26.4552 84.9927 26.4552C86.1683 26.4552 86.8975 27.3629 86.8975 28.6576C86.8975 29.9522 86.1683 30.86 84.9927 30.86Z"),d(w,"fill","#A3BAD9"),T(w,Et,76,1,5523),d(m,"d","M93.7816 32.5713C95.865 32.5713 97.2489 31.4254 97.5465 29.5951H95.3441C95.1953 30.3689 94.6447 30.86 93.8263 30.86C92.7251 30.86 92.0257 29.9671 92.0257 28.6576C92.0257 27.3629 92.7251 26.4552 93.8263 26.4552C94.6447 26.4552 95.1655 26.9314 95.3441 27.6903H97.5316C97.234 25.8748 95.9394 24.7439 93.856 24.7439C91.4304 24.7439 89.8828 26.2915 89.8828 28.6576C89.8828 31.0683 91.356 32.5713 93.7816 32.5713Z"),d(m,"fill","#A3BAD9"),T(m,Et,80,1,5966),d(b,"d","M98.6514 32.4821H100.75V30.622L101.895 29.3869L103.83 32.4821H106.256L103.354 27.8392L106.107 24.8333H103.741L100.75 28.0773V22.0654H98.6514V32.4821Z"),d(b,"fill","#A3BAD9"),T(b,Et,84,1,6412),d(P,"d","M106.188 29.9375C106.277 31.5744 107.72 32.5714 109.848 32.5714C111.902 32.5714 113.33 31.6042 113.33 30.0863C113.33 28.3601 111.872 27.9583 110.116 27.7798C109.015 27.6458 108.36 27.5863 108.36 27.006C108.36 26.5149 108.896 26.2173 109.714 26.2173C110.562 26.2173 111.143 26.5893 111.202 27.1994H113.211C113.107 25.6369 111.693 24.7292 109.64 24.7292C107.676 24.7143 106.351 25.7113 106.351 27.2292C106.351 28.8065 107.735 29.2083 109.521 29.4167C110.756 29.5804 111.277 29.625 111.277 30.25C111.277 30.7857 110.741 31.0685 109.863 31.0685C108.836 31.0685 108.256 30.6071 108.182 29.9375H106.188Z"),d(P,"fill","#A3BAD9"),T(P,Et,88,1,6600),d(N,"d","M32.4824 8.67236H11.649C10.0053 8.67236 8.67285 10.0048 8.67285 11.6486V32.4819C8.67285 34.1256 10.0053 35.4581 11.649 35.4581H32.4824C34.1261 35.4581 35.4586 34.1256 35.4586 32.4819V11.6486C35.4586 10.0048 34.1261 8.67236 32.4824 8.67236Z"),d(N,"fill","url(#paint0_radial_253_107)"),T(N,Et,92,1,7236),d(A,"fill-rule","evenodd"),d(A,"clip-rule","evenodd"),d(A,"d","M24.8953 17.78H15.0332L17.8712 20.7599V24.875L24.8953 17.78ZM19.2193 26.294H29.0814L26.2434 23.3141V19.199L19.2193 26.294Z"),d(A,"fill","white"),T(A,Et,96,1,7534),d(U,"stop-color","#FF0099"),T(U,Et,111,3,7961),d(W,"offset","1"),d(W,"stop-color","#FF7A00"),T(W,Et,112,3,7995),d(j,"id","paint0_radial_253_107"),d(j,"cx","0"),d(j,"cy","0"),d(j,"r","1"),d(j,"gradientUnits","userSpaceOnUse"),d(j,"gradientTransform","translate(4.7524 1.97593) rotate(45.3703) scale(40.7748 35.4976)"),T(j,Et,103,2,7749),T(L,Et,102,1,7739),d(t,"class",e[0]),d(t,"width","123"),d(t,"height","44"),d(t,"viewBox","0 0 123 44"),d(t,"fill","none"),d(t,"xmlns","http://www.w3.org/2000/svg"),T(t,Et,3,0,59)},m:function(v,I){rt(v,t,I),C(t,n),C(t,r),C(t,i),C(t,o),C(t,s),C(t,a),C(t,c),C(t,l),C(t,u),C(t,h),C(t,f),C(t,_),C(t,p),C(t,g),C(t,y),C(t,k),C(t,w),C(t,m),C(t,b),C(t,P),C(t,N),C(t,A),C(t,L),C(L,j),C(j,U),C(j,W)},p:function(v,[I]){I&1&&d(t,"class",v[0])},i:mt,o:mt,d:function(v){v&&E(t)}};return $("SvelteRegisterBlock",{block:R,id:ji.name,type:"component",source:"",ctx:e}),R}function Xp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("LiveBlocks",r,[]);let{classList:o=""}=t;const s=["classList"];return Object.keys(t).forEach(a=>{!~s.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<LiveBlocks> was created with unknown prop '${a}'`)}),e.$$set=a=>{"classList"in a&&n(0,o=a.classList)},e.$capture_state=()=>({classList:o}),e.$inject_state=a=>{"classList"in a&&n(0,o=a.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o]}class Qa extends Tt{constructor(t){super(t),Ot(this,t,Xp,ji,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"LiveBlocks",options:t,id:ji.name})}get classList(){throw new Error("<LiveBlocks>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<LiveBlocks>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Kt="src/lib/About.svelte";function Bi(e){let t,n,r,i,o,s,a,c,l,u,h,f,_,p,g,y,k,w,m,b,P,N,A,L,j,U,W,R,G,v,I,S,z,K,q;I=new Qa({props:{classList:"ml-2"},$$inline:!0});const V={c:function(){t=H("div"),n=H("div"),r=H("h2"),i=et("Stable Difussion Multiplayer"),o=st(),s=H("ul"),a=H("li"),c=et("Powered by "),l=H("a"),u=et("Hugging Face GPU Spaces"),h=st(),f=H("li"),_=H("a"),p=et("Diffusers"),g=et(`\r
				and\r
				`),y=H("a"),k=et("Runwayml Inpainting Stable Diffusion"),w=st(),m=H("li"),b=et("Thanks to "),P=H("a"),N=et("Lnyan"),A=et(`\r
				for the original outpainting technique implemented on\r
				`),L=H("a"),j=et("Stable Diffusion Infinity"),U=st(),W=H("li"),R=H("p"),G=et(`Multiplayer API by\r
					`),v=H("a"),wt(I.$$.fragment),this.h()},l:function(Q){t=F(Q,"DIV",{class:!0});var D=O(t);n=F(D,"DIV",{class:!0});var ut=O(n);r=F(ut,"H2",{class:!0});var _t=O(r);i=nt(_t,"Stable Difussion Multiplayer"),_t.forEach(E),o=at(ut),s=F(ut,"UL",{});var ct=O(s);a=F(ct,"LI",{class:!0});var ft=O(a);c=nt(ft,"Powered by "),l=F(ft,"A",{href:!0,class:!0});var xt=O(l);u=nt(xt,"Hugging Face GPU Spaces"),xt.forEach(E),ft.forEach(E),h=at(ct),f=F(ct,"LI",{class:!0});var Ft=O(f);_=F(Ft,"A",{href:!0,class:!0});var Cn=O(_);p=nt(Cn,"Diffusers"),Cn.forEach(E),g=nt(Ft,`\r
				and\r
				`),y=F(Ft,"A",{href:!0,target:!0,class:!0,rel:!0});var En=O(y);k=nt(En,"Runwayml Inpainting Stable Diffusion"),En.forEach(E),Ft.forEach(E),w=at(ct),m=F(ct,"LI",{class:!0});var Ut=O(m);b=nt(Ut,"Thanks to "),P=F(Ut,"A",{href:!0,target:!0,rel:!0,class:!0});var Sn=O(P);N=nt(Sn,"Lnyan"),Sn.forEach(E),A=nt(Ut,`\r
				for the original outpainting technique implemented on\r
				`),L=F(Ut,"A",{href:!0,target:!0,rel:!0,class:!0});var xn=O(L);j=nt(xn,"Stable Diffusion Infinity"),xn.forEach(E),Ut.forEach(E),U=at(ct),W=F(ct,"LI",{class:!0});var In=O(W);R=F(In,"P",{class:!0});var Ve=O(R);G=nt(Ve,`Multiplayer API by\r
					`),v=F(Ve,"A",{href:!0,target:!0,rel:!0});var we=O(v);bt(I.$$.fragment,we),we.forEach(E),Ve.forEach(E),In.forEach(E),ct.forEach(E),ut.forEach(E),D.forEach(E),this.h()},h:function(){d(r,"class","font-bold text-xl font-mono mb-8"),T(r,Kt,10,2,368),d(l,"href","https://huggingface.co/docs/hub/spaces-gpus"),d(l,"class","text-blue-400 hover:text-blue-600 underline"),T(l,Kt,13,15,493),d(a,"class","mb-2"),T(a,Kt,12,3,459),d(_,"href","https://huggingface.co/docs/diffusers/index"),d(_,"class","text-blue-400 hover:text-blue-600 underline"),T(_,Kt,20,4,689),d(y,"href","https://github.com/runwayml/stable-diffusion"),d(y,"target","_blank"),d(y,"class","text-blue-400 hover:text-blue-600 underline"),d(y,"rel","noopener noreferrer"),T(y,Kt,27,4,854),d(f,"class","mb-2"),T(f,Kt,19,3,666),d(P,"href","https://twitter.com/lkwq007"),d(P,"target","_blank"),d(P,"rel","noopener noreferrer"),d(P,"class","text-blue-400 hover:text-blue-600 underline"),T(P,Kt,37,14,1134),d(L,"href","https://github.com/lkwq007/stablediffusion-infinity"),d(L,"target","_blank"),d(L,"rel","noopener noreferrer"),d(L,"class","text-blue-400 hover:text-blue-600 underline"),T(L,Kt,46,4,1383),d(m,"class","mb-2"),T(m,Kt,36,3,1101),d(v,"href","https://liveblocks.io"),d(v,"target","_blank"),d(v,"rel","noopener noreferrer"),T(v,Kt,58,5,1716),d(R,"class","text-base flex items-center"),T(R,Kt,56,4,1645),d(W,"class","mb-2"),T(W,Kt,55,3,1622),T(s,Kt,11,2,450),d(n,"class","max-w-md"),T(n,Kt,9,1,342),d(t,"class",S="fixed "+e[0]+" w-screen h-screen top-0 left-0 bottom-0 right-0 z-50 items-center justify-center bg-black text-white bg-opacity-90 px-3"),T(t,Kt,5,0,173)},m:function(Q,D){rt(Q,t,D),C(t,n),C(n,r),C(r,i),C(n,o),C(n,s),C(s,a),C(a,c),C(a,l),C(l,u),C(s,h),C(s,f),C(f,_),C(_,p),C(f,g),C(f,y),C(y,k),C(s,w),C(s,m),C(m,b),C(m,P),C(P,N),C(m,A),C(m,L),C(L,j),C(s,U),C(s,W),C(W,R),C(R,G),C(R,v),kt(I,v,null),z=!0,K||(q=$t(t,"click",e[1],!1,!1,!1,!1),K=!0)},p:function(Q,[D]){(!z||D&1&&S!==(S="fixed "+Q[0]+" w-screen h-screen top-0 left-0 bottom-0 right-0 z-50 items-center justify-center bg-black text-white bg-opacity-90 px-3"))&&d(t,"class",S)},i:function(Q){z||(Z(I.$$.fragment,Q),z=!0)},o:function(Q){J(I.$$.fragment,Q),z=!1},d:function(Q){Q&&E(t),Ct(I),K=!1,q()}};return $("SvelteRegisterBlock",{block:V,id:Bi.name,type:"component",source:"",ctx:e}),V}function Gp(e,t,n){let{$$slots:r={},$$scope:i}=t;Rt("About",r,[]);let{classList:o=""}=t;const s=["classList"];Object.keys(t).forEach(c=>{!~s.indexOf(c)&&c.slice(0,2)!=="$$"&&c!=="slot"&&console.warn(`<About> was created with unknown prop '${c}'`)});function a(c){Yi.call(this,e,c)}return e.$$set=c=>{"classList"in c&&n(0,o=c.classList)},e.$capture_state=()=>({LiveBlocks:Qa,classList:o}),e.$inject_state=c=>{"classList"in c&&n(0,o=c.classList)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[o,a]}class tc extends Tt{constructor(t){super(t),Ot(this,t,Gp,Bi,Nt,{classList:0}),$("SvelteRegisterComponent",{component:this,tagName:"About",options:t,id:Bi.name})}get classList(){throw new Error("<About>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set classList(t){throw new Error("<About>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}/*! js-cookie v3.0.5 | MIT */function qn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Jp={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Vi(e,t){function n(i,o,s){if(!(typeof document>"u")){s=qn({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in s)!s[c]||(a+="; "+c,s[c]!==!0&&(a+="="+s[c].split(";")[0]));return document.cookie=i+"="+e.write(o,i)+a}}function r(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var o=document.cookie?document.cookie.split("; "):[],s={},a=0;a<o.length;a++){var c=o[a].split("="),l=c.slice(1).join("=");try{var u=decodeURIComponent(c[0]);if(s[u]=e.read(l,u),i===u)break}catch{}}return i?s[i]:s}}return Object.create({set:n,get:r,remove:function(i,o){n(i,"",qn({},o,{expires:-1}))},withAttributes:function(i){return Vi(this.converter,qn({},this.attributes,i))},withConverter:function(i){return Vi(qn({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var Ur=Vi(Jp,{path:"/"});const{console:Qp}=Qe,Jn="src/routes/+page.svelte";function zi(e){let t,n;t=new ea({$$inline:!0}),t.$on("contentModal",e[8]);const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},p:mt,i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:zi.name,type:"if",source:"(91:0) {#if !hideContentModal}",ctx:e}),r}function ec(e){let t,n;t=new Qs({props:{client:e[1],$$slots:{default:[sc]},$$scope:{ctx:e}},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},p:function(o,s){const a={};s&2&&(a.client=o[1]),s&4104&&(a.$$scope={dirty:s,ctx:o}),t.$set(a)},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:ec.name,type:"else",source:"(98:0) {:else}",ctx:e}),r}function nc(e){let t;const n={c:function(){t=H("div"),this.h()},l:function(i){t=F(i,"DIV",{class:!0}),O(t).forEach(E),this.h()},h:function(){d(t,"class","inset-0 fixed bg-white animate-pulse"),T(t,Jn,96,1,3779)},m:function(i,o){rt(i,t,o)},p:mt,i:mt,o:mt,d:function(i){i&&E(t)}};return $("SvelteRegisterBlock",{block:n,id:nc.name,type:"if",source:"(96:0) {#if loading}",ctx:e}),n}function rc(e){let t,n,r,i,o,s;const a={c:function(){t=H("div"),n=H("h1"),r=et("No room selected"),i=st(),o=H("p"),s=et("Please select a room in the URL"),this.h()},l:function(l){t=F(l,"DIV",{class:!0});var u=O(t);n=F(u,"H1",{class:!0});var h=O(n);r=nt(h,"No room selected"),h.forEach(E),i=at(u),o=F(u,"P",{class:!0});var f=O(o);s=nt(f,"Please select a room in the URL"),f.forEach(E),u.forEach(E),this.h()},h:function(){d(n,"class","text-2xl font-bold"),T(n,Jn,105,4,4054),d(o,"class","text-gray-500"),T(o,Jn,106,4,4112),d(t,"class","flex flex-col items-center justify-center h-full"),T(t,Jn,104,3,3986)},m:function(l,u){rt(l,t,u),C(t,n),C(n,r),C(t,i),C(t,o),C(o,s)},p:mt,i:mt,o:mt,d:function(l){l&&E(t)}};return $("SvelteRegisterBlock",{block:a,id:rc.name,type:"else",source:"(104:2) {:else}",ctx:e}),a}function ic(e){let t,n;t=new ta({props:{id:e[3],initialPresence:e[6],$$slots:{default:[oc]},$$scope:{ctx:e}},$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},p:function(o,s){const a={};s&8&&(a.id=o[3]),s&4096&&(a.$$scope={dirty:s,ctx:o}),t.$set(a)},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:ic.name,type:"if",source:"(100:2) {#if roomId}",ctx:e}),r}function oc(e){let t,n;t=new Ja({$$inline:!0});const r={c:function(){wt(t.$$.fragment)},l:function(o){bt(t.$$.fragment,o)},m:function(o,s){kt(t,o,s),n=!0},i:function(o){n||(Z(t.$$.fragment,o),n=!0)},o:function(o){J(t.$$.fragment,o),n=!1},d:function(o){Ct(t,o)}};return $("SvelteRegisterBlock",{block:r,id:oc.name,type:"slot",source:"(101:3) <RoomProvider id={roomId} {initialPresence}>",ctx:e}),r}function sc(e){let t,n,r,i;const o=[ic,rc],s=[];function a(l,u){return l[3]?0:1}t=a(e),n=s[t]=o[t](e);const c={c:function(){n.c(),r=ce()},l:function(u){n.l(u),r=ce()},m:function(u,h){s[t].m(u,h),rt(u,r,h),i=!0},p:function(u,h){let f=t;t=a(u),t===f?s[t].p(u,h):(zt(),J(s[f],1,1,()=>{s[f]=null}),Ht(),n=s[t],n?n.p(u,h):(n=s[t]=o[t](u),n.c()),Z(n,1),n.m(r.parentNode,r))},i:function(u){i||(Z(n),i=!0)},o:function(u){J(n),i=!1},d:function(u){s[t].d(u),u&&E(r)}};return $("SvelteRegisterBlock",{block:c,id:sc.name,type:"slot",source:"(99:1) <LiveblocksProvider {client}>",ctx:e}),c}function Hi(e){let t,n,r,i,o,s,a,c=!e[2]&&zi(e);n=new tc({props:{classList:e[4]?"flex":"hidden"},$$inline:!0}),n.$on("click",e[9]);const l=[nc,ec],u=[];function h(_,p){return _[0]?0:1}i=h(e),o=u[i]=l[i](e);const f={c:function(){c&&c.c(),t=st(),wt(n.$$.fragment),r=st(),o.c(),s=ce()},l:function(p){c&&c.l(p),t=at(p),bt(n.$$.fragment,p),r=at(p),o.l(p),s=ce()},m:function(p,g){c&&c.m(p,g),rt(p,t,g),kt(n,p,g),rt(p,r,g),u[i].m(p,g),rt(p,s,g),a=!0},p:function(p,[g]){p[2]?c&&(zt(),J(c,1,1,()=>{c=null}),Ht()):c?(c.p(p,g),g&4&&Z(c,1)):(c=zi(p),c.c(),Z(c,1),c.m(t.parentNode,t));const y={};g&16&&(y.classList=p[4]?"flex":"hidden"),n.$set(y);let k=i;i=h(p),i===k?u[i].p(p,g):(zt(),J(u[k],1,1,()=>{u[k]=null}),Ht(),o=u[i],o?o.p(p,g):(o=u[i]=l[i](p),o.c()),Z(o,1),o.m(s.parentNode,s))},i:function(p){a||(Z(c),Z(n.$$.fragment,p),Z(o),a=!0)},o:function(p){J(c),J(n.$$.fragment,p),J(o),a=!1},d:function(p){c&&c.d(p),p&&E(t),Ct(n,p),p&&E(r),u[i].d(p),p&&E(s)}};return $("SvelteRegisterBlock",{block:f,id:Hi.name,type:"component",source:"",ctx:e}),f}function tm(e,t,n){let r,i,o,s;yt(le,"canvasSize"),vt(e,le,w=>n(10,i=w)),yt(Vt,"selectedRoomID"),vt(e,Vt,w=>n(7,o=w)),yt(ke,"toggleAbout"),vt(e,ke,w=>n(4,s=w));let{$$slots:a={},$$scope:c}=t;Rt("Page",a,[]);let l=!0,u,h=!0;Yt(()=>{/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&Lt(le,i={width:512*8,height:512*8},i),n(1,u=Vo({authEndpoint:dn+"/auth"})),_();const w=new URLSearchParams(window.location.search).get("acceptedContentWarning");console.log(w);const m=Ur.get("acceptedContentWarning");n(2,h=!1),(m||w==="true")&&n(2,h=!0)});function f(){n(2,h=!0),Ur.set("acceptedContentWarning","true",{expires:10});const w=new URLSearchParams(window.location.search);w.set("acceptedContentWarning","true"),window.history.replaceState(null,"",`?${w.toString()}`),window.parent.postMessage({queryString:w.toString()},"*")}async function _(){n(0,l=!0);const w=new URLSearchParams(window.location.search).get("roomid"),b=await(await fetch(dn+"/rooms")).json(),P=b.find(A=>A.users_count<Ce)||null;let N=null;if(w)if(w.startsWith("secret-"))N=w;else{const A=b.find(L=>L.room_id===w)||null;N=A&&A.users_count<Ce?A.room_id:null}else N=P?P.room_id:null;if(N){Lt(Vt,o=N,o);const A=new URLSearchParams(window.location.search);A.set("roomid",N),window.history.replaceState(null,"",`?${A.toString()}`),window.parent.postMessage({queryString:A.toString()},"*")}return n(0,l=!1),{rooms:b}}const p={cursor:null,frame:{x:i.width/2-dt/2,y:i.height/2-dt/2},status:ht.dragging,currentPrompt:""},g=[];Object.keys(t).forEach(w=>{!~g.indexOf(w)&&w.slice(0,2)!=="$$"&&w!=="slot"&&Qp.warn(`<Page> was created with unknown prop '${w}'`)});const y=()=>f(),k=()=>Lt(ke,s=!1,s);return e.$capture_state=()=>({onMount:Yt,createClient:Vo,LiveblocksProvider:Qs,RoomProvider:ta,ContentWarningModal:ea,App:Ja,About:tc,PUBLIC_API_BASE:dn,selectedRoomID:Vt,toggleAbout:ke,canvasSize:le,MAX_CAPACITY:Ce,FRAME_SIZE:dt,Status:ht,Cookies:Ur,loading:l,client:u,hideContentModal:h,contentModal:f,updateRooms:_,initialPresence:p,roomId:r,$canvasSize:i,$selectedRoomID:o,$toggleAbout:s}),e.$inject_state=w=>{"loading"in w&&n(0,l=w.loading),"client"in w&&n(1,u=w.client),"hideContentModal"in w&&n(2,h=w.hideContentModal),"roomId"in w&&n(3,r=w.roomId)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{e.$$.dirty&128&&n(3,r=o)},[l,u,h,r,s,f,p,o,y,k]}class om extends Tt{constructor(t){super(t),Ot(this,t,tm,Hi,Nt,{}),$("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Hi.name})}}export{om as default};
